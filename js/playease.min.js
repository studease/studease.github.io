playease=function(){if(playease.api)return playease.api.getInstance.apply(this,arguments)};playease.version="0.0.05";
(function(b){function g(a){return null!==navigator.userAgent.toLowerCase().match(a)}var a=b.utils={};a.exists=function(f){switch(a.typeOf(f)){case "string":return 0<f.length;case "object":return null!==f;case "null":return!1}return!0};a.extend=function(){var f=Array.prototype.slice.call(arguments,0),c=f[0];if(1<f.length)for(var e=1;e<f.length;e++)a.foreach(f[e],function(a,f){void 0!==f&&null!==f&&(c[a]=f)});return c};a.foreach=function(f,c){for(var e in f)f.hasOwnProperty&&"function"===a.typeOf(f.hasOwnProperty)?
f.hasOwnProperty(e)&&c(e,f[e]):c(e,f[e])};a.getCookie=function(a){var c;return(c=document.cookie.match(new RegExp("(^| )"+a+"=([^;]*)(;|$)")))?unescape(c[2]):null};a.formatTime=function(f){var c=f.getHours()+1,e=f.getMinutes(),d=f.getSeconds();return f.toLocaleDateString()+" "+a.pad(c,2)+":"+a.pad(e,2)+":"+a.pad(d,2)};a.pad=function(a,c){for(var e=a+"";e.length<c;)e="0"+e;return e};a.createElement=function(a,c){var e=document.createElement(a);c&&(e.className=c);return e};a.addClass=function(f,c){var e=
"string"===a.typeOf(f.className)?f.className.split(" "):[],d="array"===a.typeOf(c)?c:c.split(" ");a.foreach(d,function(d,f){-1===a.indexOf(e,f)&&e.push(f)});f.className=a.trim(e.join(" "))};a.removeClass=function(f,c){var e="string"===a.typeOf(f.className)?f.className.split(" "):[],d="array"===a.typeOf(c)?c:c.split(" ");a.foreach(d,function(d,f){var c=a.indexOf(e,f);0<=c&&e.splice(c,1)});f.className=a.trim(e.join(" "))};a.emptyElement=function(a){for(;a.firstChild;)a.removeChild(a.firstChild)};a.typeOf=
function(a){if(null===a||void 0===a)return"null";var c=typeof a;if("object"===c)try{if("[object Array]"===toString.call(a))return"array"}catch(e){}return c};a.trim=function(a){return a.replace(/^\s+|\s+$/g,"")};a.indexOf=function(a,c){if(null==a)return-1;for(var e=0;e<a.length;e++)if(a[e]===c)return e;return-1};a.isMSIE=function(a){return a?(a=parseFloat(a).toFixed(1),g(new RegExp("msie\\s*"+a,"i"))):g(/msie/i)};var m=window.console=window.console||{log:function(){}};a.log=function(){var f=Array.prototype.slice.call(arguments,
0);"object"===a.typeOf(m.log)?m.log(f):m.log.apply(m,f)}})(playease);(function(b){b=b.utils;b.littleEndian=function(){var b=new ArrayBuffer(2);(new DataView(b)).setInt16(0,256,!0);return 256===(new Int16Array(b))[0]}();b.getUint32=function(b,a,m){void 0==a&&(a=0);return m?b[a+0]|b[a+1]>>>8|b[a+2]>>>16|b[a+3]>>>24:b[a+0]<<24|b[a+1]<<16|b[a+2]<<8|b[a+3]}})(playease);
(function(b){function g(){var a=document.createElement("style");a.type="text/css";document.getElementsByTagName("head")[0].appendChild(a);return a.sheet||a.styleSheet}var a=b.utils,m;(a.css=function(f,c){m||(m=g());var e="";a.foreach(c,function(a,c){e+=a+": "+c+"; "});try{m.insertRule?m.insertRule(f+" { "+e+"}",m.cssRules.length):m.addRule(f,e,m.rules.length)}catch(d){a.log("Failed to insert css rule: "+f)}}).style=function(f,c,e){if(void 0!==f&&null!==f)for(void 0===f.length&&(f=[f]),c=a.extend({},
c),e=0;e<f.length;e++){var d=f[e];void 0!==d&&null!==d&&a.foreach(c,function(a,e){var c;c=a.split("-");for(var f=1;f<c.length;f++)c[f]=c[f].charAt(0).toUpperCase()+c[f].slice(1);c=c.join("");d.style[c]!==e&&(d.style[c]=e)})}}})(playease);
(function(b){b.events={ERROR:"error",PLAYEASE_READY:"playeaseReady",PLAYEASE_SETUP_ERROR:"playeaseSetupError",PLAYEASE_RENDER_ERROR:"playeaseRenderError",PLAYEASE_STATE:"playeaseState",PLAYEASE_METADATA:"playeaseMetaData",PLAYEASE_BUFFER:"playeaseBuffer",PLAYEASE_PLAY:"playeasePlay",PLAYEASE_PAUSE:"playeasePause",PLAYEASE_SEEK:"playeaseSeek",PLAYEASE_STOP:"playeaseStop",PLAYEASE_VIEW_PLAY:"playeaseViewPlay",PLAYEASE_VIEW_PAUSE:"playeaseViewPause",PLAYEASE_VIEW_SEEK:"playeaseViewSeek",PLAYEASE_VIEW_STOP:"playeaseViewStop",
PLAYEASE_VIEW_VOLUME:"playeaseViewVolume",PLAYEASE_VIEW_MUTE:"playeaseViewMute",PLAYEASE_VIEW_FULLSCREEN:"playeaseViewFullscreen",PLAYEASE_CONTENT_LENGTH:"playeaseContentLength",PLAYEASE_PROGRESS:"playeaseProgress",PLAYEASE_COMPLETE:"playeaseComplete",PLAYEASE_FLV_TAG:"playeaseFlvTag",PLAYEASE_AVC_CONFIG_RECORD:"playeaseAVCConfigRecord",PLAYEASE_AVC_SAMPLE:"playeaseAVCSample",PLAYEASE_AAC_SPECIFIC_CONFIG:"playeaseAACSpecificConfig",PLAYEASE_AAC_SAMPLE:"playeaseAACSample",PLAYEASE_MP4_INIT_SEGMENT:"playeaseMp4InitSegment",
PLAYEASE_MP4_SEGMENT:"playeaseMp4Segment",PLAYEASE_END_OF_STREAM:"playeaseEndOfStream"}})(playease);
(function(b){var g=b.utils;b.events.eventdispatcher=function(a){function m(a,d,c){if(a)for(var f=0;f<a.length;f++){var b=a[f];if(b){null!==b.count&&0===--b.count&&delete a[f];try{b.listener(d)}catch(n){g.log('Error handling "'+c+'" event listener ['+f+"]: "+n.toString(),b.listener,d)}}}}var f={},c=[];this.addEventListener=function(a,d,c){try{g.exists(f[a])||(f[a]=[]),"string"===g.typeOf(d)&&(d=(new Function("return "+d))()),f[a].push({listener:d,count:c||null})}catch(b){g.log("error",b)}return!1};
this.removeEventListener=function(a,d){if(f[a]){try{if(void 0===d){f[a]=[];return}var c;for(c=0;c<f[a].length;c++)if(f[a][c].listener.toString()===d.toString()){f[a].splice(c,1);break}}catch(b){g.log("error",b)}return!1}};this.addGlobalListener=function(a,d){try{"string"===g.typeOf(a)&&(a=(new Function("return "+a))()),c.push({listener:a,count:d||null})}catch(f){g.log("error",f)}return!1};this.removeGlobalListener=function(a){if(a){try{var d;for(d=c.length-1;0<=d;d--)c[d].listener.toString()===a.toString()&&
c.splice(d,1)}catch(f){g.log("error",f)}return!1}};this.dispatchEvent=function(e,d){d||(d={});g.extend(d,{id:a,version:b.version,type:e});b.debug&&g.log(e,d);m(f[e],d,e);m(c,d,e)}}})(playease);
(function(b){var g=b.utils,a=b.events;g.loader=function(b){var f=g.extend(this,new a.eventdispatcher("utils.loader")),c={method:"GET",headers:{},mode:"cors",cache:"default"},e,d;f.load=function(c){e=c;fetch?fetch(e,f.config).then(function(c){if(d)d=!1;else{if(c.ok&&200<=c.status&&299>=c.status){var e=c.headers.get("Content-Length");e&&(e=parseInt(e),f.dispatchEvent(a.PLAYEASE_CONTENT_LENGTH,{length:e}));return f.pump(c.body.getReader())}f.dispatchEvent(a.ERROR,{message:"Loader error: Invalid http status("+
c.status+" "+c.statusText+")."})}}).catch(function(c){f.dispatchEvent(a.ERROR,{message:"Loader error: "+c.message})}):f.dispatchEvent(a.ERROR,{message:"Loader error: Fetch is not supported."})};f.pump=function(c){return c.read().then(function(e){if(e.done)f.dispatchEvent(a.PLAYEASE_COMPLETE);else{if(d)return d=!1,c.cancel();f.dispatchEvent(a.PLAYEASE_PROGRESS,{data:e.value.buffer});return f.pump(c)}}).catch(function(c){f.dispatchEvent(a.ERROR,{message:"Loader error: Failed to read response data."})})};
f.abort=function(){d=!0};(function(){f.config=g.extend({},c,b);var a=new Headers,e;for(e in f.config.headers)a.append(e,f.config.headers[e]);f.config.headers=a;d=!1})()}})(playease);
(function(b){var g=b.utils,a=b.events,m={},f={onError:a.ERROR,onReady:a.PLAYEASE_READY,onMetaData:a.PLAYEASE_METADATA,onBuffer:a.PLAYEASE_BUFFER,onPlay:a.PLAYEASE_PLAY,onPause:a.PLAYEASE_PAUSE,onSeek:a.PLAYEASE_SEEK,onStop:a.PLAYEASE_STOP,onVolume:a.PLAYEASE_VIEW_VOLUME,onMute:a.PLAYEASE_VIEW_MUTE,onFullscreen:a.PLAYEASE_VIEW_FULLSCREEN};b.api=function(c){function e(a){d.dispatchEvent(a.type,a)}var d=g.extend(this,new a.eventdispatcher("api")),p;d.container=c;d.id=c.id;d.setup=function(a){g.emptyElement(d.container);
b.debug=!!a.debug;d.config=a;d.config.id=d.id;d.embedder=new b.embed(d);d.embedder.addGlobalListener(e);d.embedder.embed();return d};d.setEntity=function(a,c){p=a;d.renderName=c;d.play=p.play;d.pause=p.pause;d.seek=p.seek;d.stop=p.stop;d.volume=p.volume;d.mute=p.mute;d.fullscreen=p.fullscreen;d.resize=p.resize};(function(){g.foreach(f,function(a,c){d[a]=function(a){d.addEventListener(c,a)}})})()};b.api.getInstance=function(a){var f;null==a?a=0:a.nodeType?f=a:"string"===g.typeOf(a)&&(f=document.getElementById(a));
if(f){var d=m[f.id];d||(m[a]=d=new b.api(f));return d}return"number"===g.typeOf(a)?m[a]:null};b.api.displayError=function(a,f){}})(playease);(function(b){b.muxer={}})(playease);
(function(b){var g=b.utils,a=b.muxer.AMF={},m=a.types={DOUBLE:0,BOOLEAN:1,STRING:2,OBJECT:3,MOVIE_CLIP:4,NULL:5,UNDEFINED:6,REFERENCE:7,MIXED_ARRAY:8,END_OF_OBJECT:9,ARRAY:10,DATE:11,LONG_STRING:12,UNSUPPORTED:13,RECORD_SET:14,XML:15,TYPED_OBJECT:16,AMF3_DATA:17};a.parse=function(f,c,e){var d={};try{var b=a.parseValue(f,c,e),m=a.parseValue(f,c+b.size,e-b.size);d.key=b.data;d.value=m.data}catch(l){g.log("AMF.parse() failed. Error: "+l)}return d};a.parseObject=function(f,c,e){if(3>e)throw"Data not enough while parsing AMF object.";
for(var d={},b=0,g,l={ended:!1};!l.ended&&b<e;)g=a.parseString(f,c+b,e-b),b+=g.size,l=a.parseValue(f,c+b,e-b),b+=l.size,g.data&&l.data&&(d[g.data]=l.data);return{data:d,size:b,ended:l.ended}};a.parseString=function(a,c,e){if(2>e)throw"Data not enough while parsing AMF string.";var d=0;e=(new DataView(a,c,e)).getUint16(d);var d=d+2,b=void 0,b=0<e?String.fromCharCode.apply(String,new Uint8Array(a,c+d,e)):"";return{data:b,size:d+e}};a.parseLongString=function(a,c,e){if(4>e)throw"Data not enough while parsing AMF long string.";
var d=0;e=(new DataView(a,c,e)).getUint32(d);var d=d+4,b=void 0,b=0<e?String.fromCharCode.apply(String,new Uint8Array(a,c+d,e)):"";return{data:b,size:d+e}};a.parseDate=function(a,c,e){if(10>e)throw"Data not enough while parsing AMF date.";e=new DataView(a,c,e);a=0;c=e.getFloat64(a);a+=8;e=e.getInt16(a);return{data:new Date(c+6E4*e),size:a+2}};a.parseValue=function(f,c,e){if(1>e)throw"Data not enough while parsing AMF value.";var d=new DataView(f,c,e),b=0,k=d.getUint8(b),b=b+1,l=void 0,n=!1;try{switch(k){case m.DOUBLE:l=
d.getFloat64(b);b+=8;break;case m.BOOLEAN:l=d.getUint8(b)?!0:!1;b+=1;break;case m.STRING:var y=a.parseString(f,c+b,e-b),l=y.data,b=b+y.size;break;case m.OBJECT:var B=a.parseObject(f,c+b,e-b),l=B.data,b=b+B.size;break;case m.MIXED_ARRAY:var A=d.getUint32(b),b=b+4,v=a.parseObject(f,c+b,e-b),l=v.data,b=b+v.size;break;case m.END_OF_OBJECT:l=void 0;n=!0;break;case m.ARRAY:A=d.getUint32(b);b+=4;l=[];for(d=0;d<A;d++){var H=a.parseValue(f,c+b,e-b);l.push(H.data);b+=H.size}break;case m.DATE:var h=a.parseDate(f,
c+b,e-b),l=h.data,b=b+h.size;break;case m.LONG_STRING:var q=a.parseString(f,c+b,e-b),l=q.data,b=b+q.size;break;default:g.log("Skipping unsupported AMF value type("+k+")."),b+=e}}catch(w){g.log("AMF.parseValue() failed. Error: "+w)}return{data:l,size:b,ended:n}}})(playease);
(function(b){var g=function(a){function b(){var a=g-d;if(0>=a)throw"Data not enough while filling current word.";var a=Math.min(4,a),c=new Uint8Array(4);c.set(e.subarray(d,d+a));k=(new DataView(c.buffer)).getUint32(0,!1);d+=a;l=8*a}function f(){var a;for(a=0;a<l;a++)if(0!==(k&2147483648>>>a))return k<<=a,l-=a,a;b();return a+f()}var c=this,e,d,g,k,l;c.readBits=function(a){if(32<a)throw"Data not enough while reading bits of ExpGolomb.";if(a<=l){var c=k>>>32-a;k<<=a;l-=a;return c}c=l?k:0;c>>>=32-l;a-=
l;b();a=Math.min(a,l);var d=k>>>32-a;k<<=a;l-=a;return c<<a|d};c.readBool=function(){return 1===c.readBits(1)};c.readByte=function(){return c.readBits(8)};c.readUEG=function(){var a=f();return c.readBits(a+1)-1};c.readSEG=function(){var a=c.readUEG();return a&1?a+1>>>1:-1*(a>>>1)};c.destroy=function(){e=null};e=a;d=0;g=a.byteLength;l=k=0};(b.muxer.SPS={}).parse=function(a){for(var b=a.byteLength,f=new Uint8Array(b),c=0,e=0;e<b;e++)2<=e&&3===a[e]&&0===a[e-1]&&0===a[e-2]||(f[c]=a[e],c++);a=new Uint8Array(f.buffer,
0,c);a=new g(a);a.readByte();var d=a.readByte();a.readByte();f=a.readByte();a.readUEG();switch(d){case 66:b="Baseline";break;case 77:b="Main";break;case 88:b="Extended";break;case 100:b="High";break;case 110:b="High10";break;case 122:b="High422";break;case 244:b="High444";break;default:b="Unknown"}var f=(f/10).toFixed(1),p=1,c=420,k=[0,420,422,444],e=8;if(100===d||110===d||122===d||244===d||44===d||83===d||86===d||118===d||128===d||138===d||144===d)if(p=a.readUEG(),3===p&&a.readBits(1),3>=p&&(c=k[p]),
e=a.readUEG()+8,a.readUEG(),a.readBits(1),a.readBool())for(d=3!==p?8:12,k=0;k<d;k++)if(a.readBool())for(var l=a,n=6>k?16:64,y=8,B=8,A=0,v=0;v<n;v++)0!==B&&(A=l.readSEG(),B=(y+A+256)%256),y=0===B?y:B;a.readUEG();d=a.readUEG();if(0===d)a.readUEG();else if(1===d)for(a.readBits(1),a.readSEG(),a.readSEG(),d=a.readUEG(),k=0;k<d;k++)a.readSEG();a.readUEG();a.readBits(1);var H=a.readUEG(),A=a.readUEG(),v=a.readBits(1);0===v&&a.readBits(1);a.readBits(1);var h=0,q=0,w=0,D=0;a.readBool()&&(h=a.readUEG(),q=a.readUEG(),
w=a.readUEG(),D=a.readUEG());k=d=1;y=0;l=!0;B=n=0;if(a.readBool()){if(a.readBool()){var E=a.readByte(),r=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],x=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];0<E&&16>E?(d=r[E-1],k=x[E-1]):255===E&&(d=a.readByte()<<8|a.readByte(),k=a.readByte()<<8|a.readByte())}a.readBool()&&a.readBool();a.readBool()&&(a.readBits(4),a.readBool()&&a.readBits(24));a.readBool()&&(a.readUEG(),a.readUEG());a.readBool()&&(y=a.readBits(32),n=a.readBits(32),l=a.readBool(),B=2*y,y=
n/B)}E=1;if(1!==d||1!==k)E=d/k;r=x=0;0===p?(x=1,r=2-v):(x=3===p?1:2,r=(1===p?2:1)*(2-v));p=16*(H+1)-(h+q)*x;A=16*(2-v)*(A+1)-(w+D)*r;v=Math.ceil(p*E);a.destroy();switch(c){case 420:a="4:2:0";break;case 422:a="4:2:2";break;case 444:a="4:4:4";break;default:a="Unknown"}return{profile_string:b,level_string:f,bit_depth:e,chroma_format:c,chroma_format_string:a,frame_rate:{fixed:l,fps:y,fps_den:B,fps_num:n},sar_ratio:{width:d,height:k},codec_size:{width:p,height:A},present_size:{width:v,height:A}}}})(playease);
(function(b){var g=b.utils,a=b.events;b=b.muxer;var m=b.SPS,f={AUDIO:8,VIDEO:9,SCRIPT:18},c={KEYFRAME:1,INTER_FRAME:2,DISPOSABLE_INTER_FRAME:3,GENERATED_KEYFRAME:4,INFO_OR_COMMAND_FRAME:5},e={types:{SEQUENCE_HEADER:0,NALU:1,END_OF_SEQUENCE:2}},d={types:{SPECIFIC_CONFIG:0,RAW_FRAME_DATA:1},audioObjectTypes:{NULL:0,AAC_MAIN:1,AAC_LC:2,AAC_SSR:3,AAC_LTP:4,AAC_HE_OR_SBR:5,AAC_SCALABLE:6},samplingRates:[96E3,88200,64E3,48E3,44100,32E3,24E3,22050,16E3,12E3,11025,8E3,7350]},p=[5500,11025,22050,44100],k=
function(){var a=this;a.isComplete=function(){var b=!1===a.hasAudio||!0===a.hasAudio&&null!=a.audioCodec&&null!=a.audioSampleRate&&null!=a.audioChannelCount,c=!1===a.hasVideo||!0===a.hasVideo&&null!=a.videoCodec&&null!=a.width&&null!=a.height&&null!=a.fps&&null!=a.profile&&null!=a.level&&null!=a.chromaFormat&&null!=a.sarNum&&null!=a.sarDen;return null!=a.mimeType&&null!=a.duration&&null!=a.metadata&&null!=a.hasKeyframesIndex&&b&&c};a.isSeekable=function(){return!0===a.hasKeyframesIndex};a.getNearestKeyframe=
function(b){if(null==a.keyframesIndex)return null;var c=a.keyframesIndex,d=c.times,f=0,e=d.length-1,g=0,h=0,m=e;b<d[0]&&(f=0,h=m+1);for(;h<=m;)if(g=h+Math.floor((m-h)/2),g===e||b>=d[g]&&b<d[g+1]){f=g;break}else d[g]<b?h=g+1:m=g-1;b=f;return{index:b,milliseconds:c.times[b],fileposition:c.filepositions[b]}}};b.flv=function(b){var n=g.extend(this,new a.eventdispatcher("muxer.flv")),y,B,A,v,H,h,q,w,D,E,r,x,G,K,u,F,z,O;n.parse=function(b){var c=new Uint8Array(b),d=0;if(1==A){if(13>b.byteLength)return 0;
d=n.probe(b);A=4;var e=g.getUint32(c,d);e&&g.log("First tag size "+e);d+=4;A=2}for(;d<b.byteLength;)switch(A){case 2:w[h.position++]=c[d++];11==h.position&&(E=w[1]<<16|w[2]<<8|w[3],A=3);break;case 3:var F=w[0],z=w[1]<<16|w[2]<<8|w[3],C=w[4]<<16|w[5]<<8|w[6]|w[7]<<24,e=w[8]<<16|w[9]<<8|w[10];0!=e&&g.log("Unknown stream ID "+e);e={tag:F,data:b,offset:d,size:z};switch(F){case f.AUDIO:e.timestamp=C;E==z&&(e.format=c[d]>>>4,e.rate=p[(c[d]&12)>>>2],e.samplesize=(c[d]&2)>>>1,e.sampletype=c[d]&1);break;case f.VIDEO:e.timestamp=
C;E==z&&(e.frametype=c[d]>>>4,e.codec=c[d]&15);break;case f.SCRIPT:e.hasAudio=v,e.hasVideo=H}F=Math.min(b.byteLength-d,E);E-=F;d+=F;if(E){r.push(e);break}if(r.length){e=r[0];z=new Uint8Array(z);for(z.position=0;r.length;)C=r.shift(),F=new Uint8Array(C.data.slice(C.offset)),z.set(F,z.position),z.position+=C.data.byteLength-C.offset;F=new Uint8Array(b.slice(0,d));z.set(F,z.position);e.data=z.buffer;e.offset=0}A=4;q.position=0;n.dispatchEvent(a.PLAYEASE_FLV_TAG,e);break;case 4:D[q.position++]=c[d++];
4==q.position&&(z=w[1]<<16|w[2]<<8|w[3],e=g.getUint32(D),e!=11+z&&g.log("prevTagSize("+e+") is not equals to "+(11+z)+"."),A=2,h.position=0);break;default:g.log("Unknown parsing state "+A);return}};n.parseAVCVideoPacket=function(b,d,f,F,h){if(5>f)n.dispatchEvent(a.ERROR,{message:"Data not enough while parsing AVC video packet."});else{var l=new DataView(b,d,f),C=1,r=l.getUint8(C++),l=l.getUint8(C++)<<16|l.getUint8(C++)<<8|l.getUint8(C++);switch(r){case e.types.SEQUENCE_HEADER:l=d+C;d=f-C;if(7>d)n.dispatchEvent(a.ERROR,
{message:"Data not enough while parsing AVC decoder configuration record."});else if(f=u,f={type:f.type,id:f.id,timescale:1E3,duration:1E3*G.duration||0},C=new DataView(b,l,d),r=0,h=C.getUint8(r++),F=C.getUint8(r++),C.getUint8(r++),C.getUint8(r++),1!=h||0==F)n.dispatchEvent(a.ERROR,{message:"Invalid AVCDecoderConfigurationRecord."});else if(z=1+(C.getUint8(r++)&3),3!=z&&4!=z)n.dispatchEvent(a.ERROR,{message:"Invalid lengthSizeMinusOne "+z+"."});else{F=C.getUint8(r++)&31;for(h=0;h<F;h++){var t=C.getUint16(r),
r=r+2;if(0!=t){var p=new Uint8Array(b,l+r,t),r=r+t,t=m.parse(p),k=f,q=t;k.codecWidth=q.codec_size.width;k.codecHeight=q.codec_size.height;k.presentWidth=q.present_size.width;k.presentHeight=q.present_size.height;k.profile=q.profile_string;k.level=q.level_string;k.bitDepth=q.bit_depth;k.chromaFormat=q.chroma_format;k.sarRatio=q.sar_ratio;k.frameRate=q.frame_rate;if(!1===q.frame_rate.fixed||0===q.frame_rate.fps_num||0===q.frame_rate.fps_den)k.frameRate=K;k.refSampleDuration=Math.floor(k.frameRate.fps_den/
k.frameRate.fps_num*k.timescale);for(var p=p.subarray(1,4),q="avc1.",D=0;3>D;D++){var J=p[D].toString(16);2>J.length&&(J="0"+J);q+=J}k.codec=q;k=f;x.hasAudio=v;x.hasVideo=H;x.duration=1E3*G.duration;x.metadata=G;x.width=k.codecWidth;x.height=k.codecHeight;x.fps=k.frameRate.fps;x.profile=k.profile;x.level=k.level;x.chromaFormat=t.chroma_format_string;x.sarNum=k.sarRatio.width;x.sarDen=k.sarRatio.height;x.videoCodec=k.codec;x.mimeType='video/mp4; codecs="'+x.videoCodec+(x.hasAudio&&x.audioCodec?","+
x.audioCodec:"")+'"';n.dispatchEvent(a.PLAYEASE_MEDIA_INFO,{info:x})}}F=C.getUint8(r++);for(h=0;h<F;h++)t=C.getUint16(r),r+=2,0!=t&&(new Uint8Array(b,l+r,t),r+=t);f.avcc=new Uint8Array(d);f.avcc.set(new Uint8Array(b,l,d),0);n.dispatchEvent(a.PLAYEASE_AVC_CONFIG_RECORD,{data:f})}break;case e.types.NALU:a:{d+=C;f-=C;C=new DataView(b,d,f);r=[];F=O+F;h=h==c.KEYFRAME;for(k=t=0;t<f;){if(t+4>=f){n.dispatchEvent(a.ERROR,{message:"Data not enough for next NALU."});break a}p=C.getUint32(t);3==p&&(p>>>=8);if(p>
f-z){g.log("Malformed Nalus near timestamp "+F+".");break a}q=C.getUint8(t+z)&31;q==c.INFO_OR_COMMAND_FRAME&&(h=!0);D=new Uint8Array(b,d+t,z+p);k+=D.byteLength;r.push({type:q,data:D});t+=z+p}0!=r.length&&(u.samples.push({units:r,length:k,isKeyframe:h,cts:l,dts:F,pts:l+F}),u.length+=k,n.dispatchEvent(a.PLAYEASE_AVC_SAMPLE,{data:u}))}break;case e.types.END_OF_SEQUENCE:n.dispatchEvent(a.PLAYEASE_END_OF_STREAM);break;default:n.dispatchEvent(a.ERROR,{message:"Unknown AVC video packet type "+r+"."})}}};
n.parseAACAudioPacket=function(b,c,f,e,h,z,g){if(2>f)n.dispatchEvent(a.ERROR,{message:"Data not enough while parsing AAC audio packet."});else{z=1;var r=(new DataView(b,c,f)).getUint8(z++);switch(r){case d.types.SPECIFIC_CONFIG:e=c+z;c=f-z;3>c?n.dispatchEvent(a.ERROR,{message:"Data not enough while parsing AAC audio specific config."}):(f=F,f={type:f.type,id:f.id,timescale:1E3,duration:1E3*G.duration||0},f.audioSampleRate=h,f.channelCount=0===g?1:2,f.refSampleDuration=Math.floor(1024/f.audioSampleRate*
f.timescale),f.codec="mp4a.40.5",e=new DataView(b,e,c),c=0,g=e.getUint8(c)>>>3,b=(e.getUint8(c++)&7)<<1|e.getUint8(c)>>>7,0>b||b>=d.samplingRates.length?n.dispatchEvent(a.ERROR,{message:"Invalid AAC sampling frequency index.",index:b}):(h=(e.getUint8(c)&120)>>>3,0>h||8<=h?n.dispatchEvent(a.ERROR,{message:"Invalid AAC channel configuration.",config:h}):(g===d.audioObjectTypes.AAC_HE_OR_SBR&&(e.getUint8(c++),e.getUint8(c),e.getUint8(c)),g=self.navigator.userAgent.toLowerCase(),-1!==g.indexOf("firefox")?
b>=d.audioObjectTypes.AAC_SCALABLE?(g=d.audioObjectTypes.AAC_HE_OR_SBR,e=b-3,c=Array(4)):(g=d.audioObjectTypes.AAC_LC,e=b,c=Array(2)):-1!==g.indexOf("android")?(g=d.audioObjectTypes.AAC_LC,e=b,c=Array(2)):(g=d.audioObjectTypes.AAC_HE_OR_SBR,e=b,c=Array(4),b>=d.audioObjectTypes.AAC_SCALABLE?e=b-3:1===h&&(g=2,e=b,c=Array(2))),c[0]=g<<3,c[0]|=(b&15)>>>1,c[1]=(b&15)<<7,c[1]|=(h&15)<<3,g===d.audioObjectTypes.AAC_HE_OR_SBR&&(c[1]|=(e&15)>>>1,c[2]=(e&1)<<7,c[2]|=8,c[3]=0),f.codec="mp4a.40."+g,f.config=c,
x.audioCodec=f.codec,x.audioSampleRate=f.audioSampleRate,x.audioChannelCount=f.channelCount,x.mimeType='video/mp4; codecs="'+x.videoCodec+(x.hasAudio&&x.audioCodec?","+x.audioCodec:"")+'"',n.dispatchEvent(a.PLAYEASE_MEDIA_INFO,{info:x}),n.dispatchEvent(a.PLAYEASE_AAC_SPECIFIC_CONFIG,{data:f}))));break;case d.types.RAW_FRAME_DATA:f=new Uint8Array(b,c+z,f-z);b=O+e;F.samples.push({unit:f,dts:b,pts:b});F.length+=f.length;n.dispatchEvent(a.PLAYEASE_AAC_SAMPLE,{data:F});break;default:n.dispatchEvent(a.ERROR,
{message:"Unknown AAC audio packet type "+r+"."})}}};n.probe=function(a){a=new Uint8Array(a);if(70!==a[0]||76!==a[1]||86!==a[2]||1!==a[3])return 0;v=0!==(a[4]&4)>>>2;H=0!==(a[4]&1);if(!v&&!H)return 0;a=g.getUint32(a,5);return 9>a?0:a};n.setMetaData=function(a){G=a;if("number"===typeof G.framerate&&(a=Math.floor(1E3*G.framerate),0<a)){var b=a/1E3;K.fixed=!0;K.fps=b;K.fps_num=a;K.fps_den=1E3;x.fps=b}x.hasKeyframesIndex="object"===typeof G.keyframes?!0:!1};n.getMetaData=function(){return G};n.offset=
function(){return y};n.length=function(){return B};n.destroy=function(){};n.config=g.extend({},{},b);B=y=0;A=1;h=new ArrayBuffer(11);h.position=0;w=new Uint8Array(h);q=new ArrayBuffer(4);q.position=0;D=new Uint8Array(q);E=0;r=[];x=new k;K={fixed:!0,fps:23.976,fps_num:23976,fps_den:1E3};u={type:"video",id:1,sequenceNumber:0,samples:[],length:0};F={type:"audio",id:2,sequenceNumber:0,samples:[],length:0};O=z=0};b.flv.TAG=f;b.flv.FORMATS={LINEAR_PCM_PLATFORM_ENDIAN:0,ADPCM:1,MP3:2,LINEAR_PCM_LITTLE_ENDIAN:3,
NELLYMOSER_16_kHz_MONO:4,NELLYMOSER_8_kHz_MONO:5,NELLYMOSER:6,G_711_A_LAW_LOGARITHMIC_PCM:7,G_711_MU_LAW_LOGARITHMIC_PCM:8,RESERVED:9,AAC:10,SPEEX:11,MP3_8_kHz:14,DEVICE_SPECIFIC_SOUND:15};b.flv.FRAMES=c;b.flv.CODECS={JPEG:1,H263:2,SCREEN_VIDEO:3,VP6:4,VP6_ALPHA:5,SCREEN_VIDEO_2:6,AVC:7};b.flv.AVC=e;b.flv.AAC=d})(playease);
(function(b){var g=b.utils,a=b.events;b=b.muxer;var m=b.flv.AAC,f,c,e,d,p,k,l,n,y;f=new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]);c=new Uint8Array([0,0,0,0,0,0,0,1]);e=new Uint8Array([0,0,0,0,0,0,0,0]);d=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]);p=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]);k=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,
108,101,114,0]);l=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]);n=new Uint8Array([0,0,0,0,0,0,0,0]);y=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]);m.getSilentFrame=function(a){return 1===a?new Uint8Array([0,200,0,128,35,128]):2===a?new Uint8Array([33,0,73,144,2,25,0,35,128]):3===a?new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]):4===a?new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]):5===a?new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,
0,33,144,2,56]):6===a?new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]):null};var B=function(a,b,c,d,f){this.dts=a;this.pts=b;this.duration=c;this.originalDts=d;this.isSyncPoint=f;this.fileposition=null},A=function(){var a=[];this.appendSyncPoint=function(b){b.isSyncPoint=!0;a.push(b)}},v=function(a){var b=this,c=[],d=-1;b.searchNearestSegmentBefore=function(a){if(0===c.length)return-2;var b=c.length-1,d=0,f=0,e=b,h=0;if(a<c[0].originalBeginDts)return-1;
for(;f<=e;){d=f+Math.floor((e-f)/2);if(d===b||a>c[d].lastSample.originalDts&&a<c[d+1].originalBeginDts){h=d;break}c[d].originalBeginDts<a?f=d+1:e=d-1}return h};b.searchNearestSegmentAfter=function(a){return b.searchNearestSegmentBefore(a)+1};b.append=function(a){var f=d,e=0;-1!==f&&f<c.length&&a.originalBeginDts>=c[f].lastSample.originalDts&&(f===c.length-1||f<c.length-1&&a.originalBeginDts<c[f+1].originalBeginDts)?e=f+1:0<c.length&&(e=b.searchNearestSegmentBefore(a.originalBeginDts)+1);d=e;c.splice(e,
0,a)};b.getLastSegmentBefore=function(a){a=b.searchNearestSegmentBefore(a);return 0>a?null:c[a]};b.getLastSampleBefore=function(a){a=b.getLastSegmentBefore(a);return null==a?null:a.lastSample};b.getLastSyncPointBefore=function(a){a=b.searchNearestSegmentBefore(a);for(var d=c[a].syncPoints;0===d.length&&a--;)d=c[a].syncPoints;return 0>=d.length?null:d[d.length-1]};b.isEmpty=function(){return 0===c.length};b.clear=function(){c=[];d=-1}};b.mp4=function(b){var h=g.extend(this,new a.eventdispatcher("muxer.mp4")),
q={islive:!1},w,D,E,r,x,G,K,u={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};h.getInitSegment=function(b){var c=h.box(u.ftyp,f),d=h.moov(b),e=new Uint8Array(c.byteLength+d.byteLength);e.set(c,0);e.set(d,c.byteLength);h.dispatchEvent(a.PLAYEASE_MP4_INIT_SEGMENT,{tp:b.type,data:e})};
h.getVideoSegment=function(b){var c=b.samples,d=void 0,f=-1,e=-1,g=-1,r=-1;if(c&&0!==c.length){var e=0,k=8+b.length,l=new Uint8Array(k);l[e++]=k>>>24&255;l[e++]=k>>>16&255;l[e++]=k>>>8&255;l[e++]=k&255;l.set(u.mdat,e);for(var e=e+4,k=[],m=new A;c.length;){var r=c.shift(),n=r.isKeyframe,p=r.dts- -1;if(void 0==d)if(void 0==w)if(x.isEmpty())d=0;else if(d=x.getLastSampleBefore(p),null!=d){var q=p-(d.originalDts+d.duration);3>=q&&(q=0);d=p-(d.dts+d.duration+q)}else d=0;else d=p-w;var q=p-d,G=r.cts,y=q+
G;-1===f&&(f=q,g=y);for(var v=0;r.units.length;){var J=r.units.shift().data;l.set(J,e);e+=J.byteLength;v+=J.byteLength}J=0;J=1<=c.length?c[0].dts- -1-d-q:1<=k.length?k[k.length-1].duration:E.refSampleDuration;if(n){var D=new B(q,y,J,r.dts,!0);D.fileposition=r.fileposition;m.appendSyncPoint(D)}k.push({dts:q,pts:y,cts:G,size:v,isKeyframe:n,duration:J,originalDts:p,flags:{isLeading:0,dependsOn:n?2:1,isDependedOn:n?1:0,hasRedundancy:0,isNonSync:n?0:1}})}c=k[k.length-1];e=c.dts+c.duration;r=c.pts+c.duration;
w=e;m.beginDts=f;m.endDts=e;m.beginPts=g;m.endPts=r;m.originalBeginDts=k[0].originalDts;m.originalEndDts=c.originalDts+c.duration;m.firstSample=new B(k[0].dts,k[0].pts,k[0].duration,k[0].originalDts,k[0].isKeyframe);m.lastSample=new B(c.dts,c.pts,c.duration,c.originalDts,c.isKeyframe);h.config.islive||x.append(m);b.samples=k;b.sequenceNumber++;f=h.moof(b,f);b.samples=[];b.length=0;h.dispatchEvent(a.PLAYEASE_MP4_SEGMENT,{tp:"video",data:_mergeBoxes(f,l),sampleCount:k.length,info:m})}};h.getAudioSegment=
function(c){var b=c.samples,d=void 0,f=-1,e=-1,e=!1,k=-1;if(b&&0!==b.length){var l=0,p=8+c.length,n=new Uint8Array(p);n[l++]=p>>>24&255;n[l++]=p>>>16&255;n[l++]=p>>>8&255;n[l++]=p&255;n.set(u.mdat,l);for(var l=l+4,q=[];b.length;){var w=b.shift(),t=w.unit,y=w.dts- -1;if(void 0==d)if(void 0==D)if(G.isEmpty())d=0,K&&!x.isEmpty()&&(e=!0);else if(d=G.getLastSampleBefore(y),null!=d){var v=y-(d.originalDts+d.duration);3>=v&&(v=0);d=y-(d.dts+d.duration+v)}else d=0;else d=y-D;v=y-d;if(e){var E=x.getLastSegmentBefore(y);
null!=E&&E.beginDts<v?(k=v-E.beginDts,v=E.beginDts):e=!1}-1===f&&(f=v);e?(e=!1,b.unshift(w),t=v,y=k,w=m.getSilentFrame(r.channelCount),null==w?(g.log("Cannot generate silent aac frame, channelCount: "+r.channelCount+"."),t=null):t={unit:w,mp4Sample:{dts:t,pts:t,cts:0,size:w.byteLength,duration:y,originalDts:t,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}},null!=t&&(y=t.unit,q.push(t.mp4Sample),l=0,p+=y.byteLength,n=new Uint8Array(p),n[l++]=p>>>24&255,n[l++]=p>>>16&255,n[l++]=p>>>
8&255,n[l++]=p&255,n.set(u.mdat,l),l+=4,n.set(y,l),l+=y.byteLength)):(w=0,w=1<=b.length?b[0].dts- -1-d-v:1<=q.length?q[q.length-1].duration:r.refSampleDuration,q.push({dts:v,pts:v,cts:0,size:t.byteLength,duration:w,originalDts:y,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}),n.set(t,l),l+=t.byteLength)}k=q[q.length-1];D=e=k.dts+k.duration;b=new A;b.beginDts=f;b.endDts=e;b.beginPts=f;b.endPts=e;b.originalBeginDts=q[0].originalDts;b.originalEndDts=k.originalDts+k.duration;b.firstSample=
new B(q[0].dts,q[0].pts,q[0].duration,q[0].originalDts,!1);b.lastSample=new B(k.dts,k.pts,k.duration,k.originalDts,!1);h.config.islive||G.append(b);c.samples=q;c.sequenceNumber++;f=h.moof(c,f);c.samples=[];c.length=0;h.dispatchEvent(a.PLAYEASE_MP4_SEGMENT,{tp:"audio",data:_mergeBoxes(f,n),sampleCount:q.length,info:b})}};_mergeBoxes=function(a,b){var c=new Uint8Array(a.byteLength+b.byteLength);c.set(a,0);c.set(b,a.byteLength);return c};h.setVideoMeta=function(a){E=a};h.setAudioMeta=function(a){r=a};
h.box=function(a){for(var b=8,c=Array.prototype.slice.call(arguments,1),d=0;d<c.length;d++)b+=c[d].byteLength;var f=new Uint8Array(b),e=0;f[e++]=b>>>24&255;f[e++]=b>>>16&255;f[e++]=b>>>8&255;f[e++]=b&255;f.set(a,e);e+=4;for(d=0;d<c.length;d++)f.set(c[d],e),e+=c[d].byteLength;return f};h.moov=function(a){var b=h.mvhd(a.timescale,a.duration),c=h.trak(a);a=h.mvex(a);return h.box(u.moov,b,c,a)};h.mvhd=function(a,b){return h.box(u.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,a>>>24&255,a>>>16&255,a>>>
8&255,a&255,b>>>24&255,b>>>16&255,b>>>8&255,b&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))};h.trak=function(a){return h.box(u.trak,h.tkhd(a),h.mdia(a))};h.tkhd=function(a){var b=a.id,c=a.duration,d=a.presentWidth;a=a.presentHeight;return h.box(u.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,b>>>24&255,b>>>16&255,b>>>8&255,b&255,0,0,0,0,c>>>24&255,c>>>16&255,c>>>8&255,c&
255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,d>>>8&255,d&255,0,0,a>>>8&255,a&255,0,0]))};h.mdia=function(a){return h.box(u.mdia,h.mdhd(a),h.hdlr(a),h.minf(a))};h.mdhd=function(a){var b=a.timescale;a=a.duration;return h.box(u.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,b>>>24&255,b>>>16&255,b>>>8&255,b&255,a>>>24&255,a>>>16&255,a>>>8&255,a&255,85,196,0,0]))};h.hdlr=function(a){var b=null,b="audio"===a.type?k:p;return h.box(u.hdlr,b)};
h.minf=function(a){var b=null,b="audio"===a.type?h.box(u.smhd,n):h.box(u.vmhd,y);return h.box(u.minf,b,h.dinf(),h.stbl(a))};h.dinf=function(){return h.box(u.dinf,h.box(u.dref,l))};h.stbl=function(a){return h.box(u.stbl,h.stsd(a),h.box(u.stts,e),h.box(u.stsc,e),h.box(u.stsz,d),h.box(u.stco,e))};h.stsd=function(a){return"audio"===a.type?h.box(u.stsd,c,h.mp4a(a)):h.box(u.stsd,c,h.avc1(a))};h.mp4a=function(a){var b=a.audioSampleRate,b=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,a.channelCount,0,
16,0,0,0,0,b>>>8&255,b&255,0,0]);return h.box(u.mp4a,b,h.esds(a))};h.esds=function(a){a=a.config;var b=a.length;a=new Uint8Array([0,0,0,0,3,23+b,0,1,0,4,15+b,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([b]).concat(a).concat([6,1,2]));return h.box(u.esds,a)};h.avc1=function(a){var b=a.avcc,c=a.codecWidth;a=a.codecHeight;c=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,c>>>8&255,c&255,a>>>8&255,a&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return h.box(u.avc1,c,h.box(u.avcC,b))};h.mvex=function(a){return h.box(u.mvex,h.trex(a))};h.trex=function(a){a=a.id;a=new Uint8Array([0,0,0,0,a>>>24&255,a>>>16&255,a>>>8&255,a&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return h.box(u.trex,a)};h.moof=function(a,b){return h.box(u.moof,h.mfhd(a.sequenceNumber),h.traf(a,b))};h.mfhd=function(a){a=new Uint8Array([0,0,0,0,a>>>24&255,a>>>16&255,a>>>8&255,a&255]);return h.box(u.mfhd,a)};h.traf=function(a,b){var c=a.id,c=
h.box(u.tfhd,new Uint8Array([0,0,0,0,c>>>24&255,c>>>16&255,c>>>8&255,c&255])),d=h.box(u.tfdt,new Uint8Array([0,0,0,0,b>>>24&255,b>>>16&255,b>>>8&255,b&255])),e=h.sdtp(a),f=h.trun(a,e.byteLength+16+16+8+16+8+8);return h.box(u.traf,c,d,f,e)};h.sdtp=function(a){a=a.samples||[];for(var b=a.length,c=new Uint8Array(4+b),d=0;d<b;d++){var e=a[d].flags;c[d+4]=e.isLeading<<6|e.dependsOn<<4|e.isDependedOn<<2|e.hasRedundancy}return h.box(u.sdtp,c)};h.trun=function(a,b){var c=a.samples||[],d=c.length,e=12+16*
d,f=new Uint8Array(e);b+=8+e;f.set([0,0,15,1,d>>>24&255,d>>>16&255,d>>>8&255,d&255,b>>>24&255,b>>>16&255,b>>>8&255,b&255],0);for(e=0;e<d;e++){var g=c[e].duration,k=c[e].size,l=c[e].flags,r=c[e].cts;f.set([g>>>24&255,g>>>16&255,g>>>8&255,g&255,k>>>24&255,k>>>16&255,k>>>8&255,k&255,l.isLeading<<2|l.dependsOn,l.isDependedOn<<6|l.hasRedundancy<<4|l.isNonSync,0,0,r>>>24&255,r>>>16&255,r>>>8&255,r&255],12+16*e)}return h.box(u.trun,f)};h.mdat=function(a){return h.box(u.mdat,a)};h.destroy=function(){};(function(){h.config=
g.extend({},q,b);for(var a in u)u[a]=[a.charCodeAt(0),a.charCodeAt(1),a.charCodeAt(2),a.charCodeAt(3)];x=new v("video");G=new v("audio");K=!1})()}})(playease);(function(b){b.core={}})(playease);(function(b){b.core.states={BUFFERING:"buffering",PLAYING:"playing",SEEKING:"seeking",PAUSED:"paused",STOPPED:"stopped",ERROR:"error"}})(playease);(function(b){b.core.renders={}})(playease);(function(b){b.core.renders.modes={DEFAULT:"def"}})(playease);(function(b){b.core.renders.skins={}})(playease);
(function(b){b.core.renders.skins.modes={DEFAULT:"def"}})(playease);
(function(b){var g=b.utils,a=b.events,m=g.css;b.core.renders.skins.def=function(b){var c=g.extend(this,new a.eventdispatcher("skins.def"));c.name="def";m(".playerwrap",{width:b.width+"px",height:b.height+"px","box-shadow":"0 1px 1px rgba(0, 0, 0, 0.05)"});m(".playerwrap *",{margin:"0",padding:"0","font-family":"\u5fae\u8f6f\u96c5\u9ed1,arial,sans-serif","font-size":"14px","font-weight":"normal","box-sizing":"content-box"});m(".render",{width:b.width-2+"px",height:b.height-2+"px",border:"1px solid #1184ce",
"border-radius":"4px",position:"relative"});c.resize=function(a,d){g.log("Resizing to "+a+", "+d);b.width=parseInt(a);b.height=parseInt(d);var p=document.getElementById(b.id),k=document.getElementById(c.name+"render");m.style(p,{width:b.width+"px",height:b.height+"px"});m.style(k,{width:b.width-2+"px",height:b.height-2+"px"})}}})(playease);
(function(b){var g=b.utils,a=b.events;b=b.core.renders;var m=b.skins,f=m.modes;b.def=function(b,e){var d=g.extend(this,new a.eventdispatcher("renders.def")),p={minWidth:320,minHeight:180,skin:{name:f.DEFAULT}},k,l;d.display=function(a,b){};d.element=function(){return l};d.resize=function(a,b){a=a||l.offsetWidth||e.width;b=b||l.offsetHeight||e.height;k&&k.resize(Math.max(a,d.config.minWidth),Math.max(b,d.config.minHeight))};d.destroy=function(){};d.config=g.extend({},p,e);d.config.width=Math.max(d.config.width,
d.config.minWidth);d.config.height=Math.max(d.config.height,d.config.minHeight);l=g.createElement("div","render");try{k=new m[d.config.skin.name](d.config)}catch(n){g.log("Failed to init skin["+d.config.skin.name+"].")}k||d.dispatchEvent(a.PLAYEASE_RENDER_ERROR,{message:"Skin not found!",name:d.config.skin.name})}})(playease);
(function(b){var g=b.utils,a=b.events,m=b.core;m.entity=function(b){var c=g.extend(this,new a.eventdispatcher("core.entity")),e,d,p;c.setup=function(){d.setup()};c.destroy=function(){p&&p.stop();d&&d.destroy();e&&e.destroy()};c.id=b.id;c.model=e=new m.model(b);c.view=d=new m.view(c,e);c.controller=p=new m.controller(e,d);p.addGlobalListener(function(a){c.dispatchEvent(a.type,a)});c.play=p.play;c.pause=p.pause;c.seek=p.seek;c.stop=p.stop;c.volume=p.volume;c.mute=p.mute;c.fullscreen=p.fullscreen;c.resize=
d.resize}})(playease);(function(b){var g=b.utils,a=b.events;b=b.core;var m=b.states;b.model=function(b){var c=g.extend(this,new a.eventdispatcher("core.model"));c.setState=function(b){b!==c.state&&(c.state=b,c.dispatchEvent(a.PLAYEASE_STATE,{state:b}))};c.getState=function(){return c.state};c.getConfig=function(a){return c.config[a]||{}};c.destroy=function(){};c.config=g.extend({},{},b);g.extend(c,{id:b.id,state:m.STOPPED},c.config)}})(playease);
(function(b){var g=b.utils,a=b.events;b=b.core;var m=b.states;b.view=function(b,c){function e(c){g.log("source open");B.dispatchEvent(a.PLAYEASE_READY,{id:b.id})}function d(a){g.log("update end");var b=a.target.type;if(E){if(!q||"open"!==q.readyState)return;if(!D.audio.length&&!D.video.length){q.endOfStream();return}}if(0!=D[b].length&&(a=w[b],!a.updating)){b=D[b].shift();try{a.appendBuffer(b)}catch(c){g.log(c)}}}function p(a){g.log("source buffer error")}function k(a){g.log("source ended")}function l(a){g.log("source close")}
function n(a){g.log("media source error")}function y(a){if(a.ctrlKey||a.metaKey)return!0;switch(a.keyCode){case 13:v.send()}if(/13/.test(a.keyCode))return a.preventDefault?a.preventDefault():a.returnValue=!1,!1}var B=g.extend(this,new a.eventdispatcher("core.view")),A,v,H,h,q,w,D,E=!1;B.setup=function(){H=g.createElement("video");H.controls="controls";H.autoplay="autoplay";A.appendChild(H);q=new MediaSource;q.addEventListener("sourceopen",e);q.addEventListener("sourceended",k);q.addEventListener("sourceclose",
l);q.addEventListener("error",n);q.addEventListener("webkitsourceopen",e);q.addEventListener("webkitsourceended",k);q.addEventListener("webkitsourceclose",l);q.addEventListener("webkiterror",n);H.src=window.URL.createObjectURL(q)};B.appendInitSegment=function(a,b){var e=a+'/mp4; codecs="'+h[a+"Codec"]+'"';MediaSource.isTypeSupported(e)?(g.log("Mime type: "+e+"."),"closed"==q.readyState?c.state=m.ERROR:(e=w[a]=q.addSourceBuffer(e),e.type=a,e.addEventListener("updateend",d),e.addEventListener("error",
p),e.appendBuffer(b))):(g.log("Mime type is not surpported: "+e+"."),c.state=m.ERROR)};B.appendSegment=function(a,b){D[a].push(b);var c=w[a];c.updating||(b=D[a].shift(),c.appendBuffer(b))};B.setMediaInfo=function(a){h=a};B.endOfStream=function(){E=!0};B.display=function(a,b){v&&v.display(a,b)};B.resize=function(a,b){v&&v.resize(a,b)};B.destroy=function(){if(A)try{A.removeEventListener("keydown",y)}catch(a){A.detachEvent("onkeydown",y)}v&&v.destroy()};(function(){A=g.createElement("div","playerwrap");
A.id=b.id;A.tabIndex=0;var a=document.getElementById(b.id);a.parentNode.replaceChild(A,a);window.onresize=function(){"function"==g.typeOf(c.onresize)?c.onresize.call(null):B.resize()};window.MediaSource=window.MediaSource||window.WebKitMediaSource;w={audio:null,video:null};D={audio:[],video:[]}})()}})(playease);
(function(b){var g=b.utils,a=b.events,m=b.core,f=b.muxer,c=m.states,e=f.AMF,d=f.flv.TAG,p=f.flv.FORMATS,k=f.flv.CODECS;m.controller=function(b,n){function m(a){g.log("onContenLength "+a.length)}function B(a){g.log("onLoaderProgress "+a.data.byteLength);I.parse(a.data)}function A(a){g.log("onLoaderComplete")}function v(a){g.log(a.message)}function H(a){g.log("onFlvTag { tag: "+a.tag+", offset: "+a.offset+", size: "+a.size+" }");switch(a.tag){case d.AUDIO:if(a.format&&a.format!=p.AAC){g.log("Unsupported audio format("+
a.format+").");break}I.parseAACAudioPacket(a.data,a.offset,a.size,a.timestamp,a.rate,a.samplesize,a.sampletype);break;case d.VIDEO:if(a.codec&&a.codec!=k.AVC){g.log("Unsupported video codec("+a.codec+").");break}I.parseAVCVideoPacket(a.data,a.offset,a.size,a.timestamp,a.frametype);break;case d.SCRIPT:a=e.parse(a.data,a.offset,a.size);g.log(a.key+": "+JSON.stringify(a.value));"onMetaData"==a.key&&I.setMetaData(a.value);break;default:g.log("Skipping unknown tag type "+a.tag)}}function h(a){n.setMediaInfo(a.info)}
function q(a){L.setVideoMeta(a.data);L.getInitSegment(a.data)}function w(a){L.getVideoSegment(a.data)}function D(a){L.setAudioMeta(a.data);L.getInitSegment(a.data)}function E(a){L.getAudioSegment(a.data)}function r(a){n.endOfStream()}function x(a){g.log(a.message)}function G(a){n.appendInitSegment(a.tp,a.data)}function K(a){n.appendSegment(a.tp,a.data)}function u(a){g.log(a.message)}function F(b){switch(b.state){case c.BUFFERING:t.dispatchEvent(a.PLAYEASE_BUFFER);break;case c.PLAYING:t.dispatchEvent(a.PLAYEASE_PLAY);
break;case c.PAUSED:t.dispatchEvent(a.PLAYEASE_PAUSE);break;case c.SEEKING:t.dispatchEvent(a.PLAYEASE_SEEK);break;case c.STOPPED:t.dispatchEvent(a.PLAYEASE_STOP);break;case c.ERROR:break;default:t.dispatchEvent(a.ERROR,{message:"Unknown model state!",state:b.state})}}function z(a){P||(P=!0,M(a),t.play(),window.onbeforeunload=function(a){})}function O(a){var d=b.getState();if(d==c.PAUSED||d==c.STOPPED||d==c.ERROR)t.play(),M(a)}function Q(a){var d=b.getState();if(d==c.BUFFERING||d==c.PLAYING||d==c.ERROR)t.pause(),
M(a)}function R(a){b.getState()!=c.SEEKING&&(t.seek(a.time),M(a))}function S(a){t.stop();M(a)}function T(a){t.volume(a.vol);M(a)}function U(a){t.fullscreen(a.esc);M(a)}function V(a){b.setState(c.ERROR);M(a)}function C(a){b.setState(c.ERROR);M(a)}function M(a){t.dispatchEvent(a.type,a)}var t=g.extend(this,new a.eventdispatcher("core.controller")),P=!1,N,I,L;t.play=function(){N.load(b.url)};t.pause=function(){};t.seek=function(a){};t.stop=function(){};t.volume=function(a){};t.mute=function(a){};t.fullscreen=
function(a){};(function(){b.addEventListener(a.PLAYEASE_STATE,F);n.addEventListener(a.PLAYEASE_READY,z);n.addEventListener(a.PLAYEASE_VIEW_PLAY,O);n.addEventListener(a.PLAYEASE_VIEW_PAUSE,Q);n.addEventListener(a.PLAYEASE_VIEW_SEEK,R);n.addEventListener(a.PLAYEASE_VIEW_STOP,S);n.addEventListener(a.PLAYEASE_VIEW_VOLUNE,T);n.addEventListener(a.PLAYEASE_VIEW_FULLSCREEN,U);n.addEventListener(a.PLAYEASE_SETUP_ERROR,V);n.addEventListener(a.PLAYEASE_RENDER_ERROR,C);var c={};b.config.cors&&(c.mode=b.config.cors);
N=new g.loader(c);N.addEventListener(a.PLAYEASE_CONTENT_LENGTH,m);N.addEventListener(a.PLAYEASE_PROGRESS,B);N.addEventListener(a.PLAYEASE_COMPLETE,A);N.addEventListener(a.ERROR,v);I=new f.flv;I.addEventListener(a.PLAYEASE_FLV_TAG,H);I.addEventListener(a.PLAYEASE_MEDIA_INFO,h);I.addEventListener(a.PLAYEASE_AVC_CONFIG_RECORD,q);I.addEventListener(a.PLAYEASE_AVC_SAMPLE,w);I.addEventListener(a.PLAYEASE_AAC_SPECIFIC_CONFIG,D);I.addEventListener(a.PLAYEASE_AAC_SAMPLE,E);I.addEventListener(a.PLAYEASE_END_OF_STREAM,
r);I.addEventListener(a.ERROR,x);L=new f.mp4;L.addEventListener(a.PLAYEASE_MP4_INIT_SEGMENT,G);L.addEventListener(a.PLAYEASE_MP4_SEGMENT,K);L.addEventListener(a.ERROR,u)})()}})(playease);
(function(b){var g=b.utils,a=b.events,m=b.embed=function(f){function c(b){switch(b.type){case a.ERROR:case a.PLAYEASE_SETUP_ERROR:case a.PLAYEASE_RENDER_ERROR:case a.PLAYEASE_ERROR:e.errorScreen(b.message);e.dispatchEvent(a.ERROR,b);break;default:e.dispatchEvent(b.type,b)}}var e=g.extend(this,new a.eventdispatcher("embed")),d={},p=!1,k=null;e.embed=function(){try{d=new m.config(f.config),k=new m.embedder(f,d)}catch(b){g.log("Failed to init embedder!");e.dispatchEvent(a.PLAYEASE_SETUP_ERROR,{message:"Failed to init embedder!",
render:d.render.name});return}k.addGlobalListener(c);k.embed()};e.errorScreen=function(a){p||(p=!0,b.api.displayError(a,d))};(function(){g.foreach(f.config.events,function(a,b){var c=f[a];"function"===g.typeOf(c)&&c.call(f,b)})})()}})(playease);
(function(b){var g=b.utils,a=b.embed,m=b.core.renders.modes,f=b.core.renders.skins.modes;a.config=function(a){return g.extend({},{url:"http://"+window.location.host+"/vod/sample.flv",width:960,height:540,bufferTime:.1,render:{name:m.DEFAULT,skin:{name:f.DEFAULT}}},a)};a.config.addConfig=function(a,b){return g.extend(a,b)}})(playease);
(function(b){var g=b.utils,a=b.events,m=b.core;b.embed.embedder=function(b,c){function e(a){d.dispatchEvent(a.type,a)}var d=g.extend(this,new a.eventdispatcher("embed.embedder"));d.embed=function(){var a=new m.entity(c);a.addGlobalListener(e);a.setup();b.setEntity(a,c.render.name)}}})(playease);