playease=function(){if(playease.api)return playease.api.getInstance.apply(this,arguments)};playease.version="1.0.09";
(function(c){var f=c.utils={};f.exists=function(a){switch(f.typeOf(a)){case "string":return 0<a.length;case "object":return null!==a;case "null":return!1}return!0};f.extend=function(){var a=Array.prototype.slice.call(arguments,0),h=a[0];if(1<a.length)for(var d=1;d<a.length;d++)f.foreach(a[d],function(a,b){void 0!==b&&null!==b&&(h[a]=b)});return h};f.foreach=function(a,h){for(var d in a)a.hasOwnProperty&&"function"===f.typeOf(a.hasOwnProperty)?a.hasOwnProperty(d)&&h(d,a[d]):h(d,a[d])};f.getCookie=
function(a){var h;return(h=document.cookie.match(new RegExp("(^| )"+a+"=([^;]*)(;|$)")))?unescape(h[2]):null};f.formatTime=function(a){var h=a.getHours()+1,d=a.getMinutes(),g=a.getSeconds();return a.toLocaleDateString()+" "+f.pad(h,2)+":"+f.pad(d,2)+":"+f.pad(g,2)};f.pad=function(a,h){for(a+="";a.length<h;)a="0"+a;return a};f.createElement=function(a,h){a=document.createElement(a);h&&(a.className=h);return a};f.addClass=function(a,h){var d="string"===f.typeOf(a.className)?a.className.split(" "):[];
h="array"===f.typeOf(h)?h:h.split(" ");f.foreach(h,function(a,b){-1===f.indexOf(d,b)&&d.push(b)});a.className=f.trim(d.join(" "))};f.removeClass=function(a,h){var d="string"===f.typeOf(a.className)?a.className.split(" "):[];h="array"===f.typeOf(h)?h:h.split(" ");f.foreach(h,function(a,b){a=f.indexOf(d,b);0<=a&&d.splice(a,1)});a.className=f.trim(d.join(" "))};f.emptyElement=function(a){for(;a.firstChild;)a.removeChild(a.firstChild)};f.typeOf=function(a){if(null===a||void 0===a)return"null";var h=typeof a;
if("object"===h)try{if("[object Array]"===toString.call(a))return"array"}catch(d){}return h};f.trim=function(a){return a.replace(/^\s+|\s+$/g,"")};f.indexOf=function(a,h){if(null==a)return-1;for(var d=0;d<a.length;d++)if(a[d]===h)return d;return-1};f.isMSIE=function(a){return a?(a=parseFloat(a).toFixed(1),a=new RegExp("msie\\s*"+a,"i"),null!==navigator.userAgent.toLowerCase().match(a)):null!==navigator.userAgent.toLowerCase().match(/msie/i)};var a=window.console=window.console||{log:function(){}};
f.log=function(){var c=Array.prototype.slice.call(arguments,0);"object"===f.typeOf(a.log)?a.log(c):a.log.apply(a,c)}})(playease);(function(c){c=c.utils;c.littleEndian=function(){var f=new ArrayBuffer(2);(new DataView(f)).setInt16(0,256,!0);return 256===(new Int16Array(f))[0]}();c.getUint32=function(f,a,c){void 0==a&&(a=0);return c?f[a+0]|f[a+1]>>>8|f[a+2]>>>16|f[a+3]>>>24:f[a+0]<<24|f[a+1]<<16|f[a+2]<<8|f[a+3]}})(playease);
(function(c){function f(){var a=document.createElement("style");a.type="text/css";document.getElementsByTagName("head")[0].appendChild(a);return a.sheet||a.styleSheet}var a=c.utils,q;(a.css=function(h,d){q||(q=f());var g="";a.foreach(d,function(a,e){g+=a+": "+e+"; "});try{q.insertRule?q.insertRule(h+" { "+g+"}",q.cssRules.length):q.addRule(h,g,q.rules.length)}catch(b){a.log("Failed to insert css rule: "+h)}}).style=function(h,d,g){if(void 0!==h&&null!==h)for(void 0===h.length&&(h=[h]),d=a.extend({},
d),g=0;g<h.length;g++){var b=h[g];void 0!==b&&null!==b&&a.foreach(d,function(a,d){a=a.split("-");for(var g=1;g<a.length;g++)a[g]=a[g].charAt(0).toUpperCase()+a[g].slice(1);a=a.join("");b.style[a]!==d&&(b.style[a]=d)})}}})(playease);
(function(c){c.events={ERROR:"error",PLAYEASE_READY:"playeaseReady",PLAYEASE_SETUP_ERROR:"playeaseSetupError",PLAYEASE_RENDER_ERROR:"playeaseRenderError",PLAYEASE_STATE:"playeaseState",CHATEASE_PROPERTY:"chateaseProperty",PLAYEASE_METADATA:"playeaseMetaData",PLAYEASE_BUFFER:"playeaseBuffer",PLAYEASE_PLAY:"playeasePlay",PLAYEASE_PAUSE:"playeasePause",PLAYEASE_SEEK:"playeaseSeek",PLAYEASE_STOP:"playeaseStop",PLAYEASE_VIEW_PLAY:"playeaseViewPlay",PLAYEASE_VIEW_PAUSE:"playeaseViewPause",PLAYEASE_VIEW_SEEK:"playeaseViewSeek",
PLAYEASE_VIEW_STOP:"playeaseViewStop",PLAYEASE_VIEW_VOLUME:"playeaseViewVolume",PLAYEASE_VIEW_MUTE:"playeaseViewMute",PLAYEASE_VIEW_FULLSCREEN:"playeaseViewFullscreen",PLAYEASE_CONTENT_LENGTH:"playeaseContentLength",PLAYEASE_PROGRESS:"playeaseProgress",PLAYEASE_COMPLETE:"playeaseComplete",PLAYEASE_FLV_TAG:"playeaseFlvTag",PLAYEASE_AVC_CONFIG_RECORD:"playeaseAVCConfigRecord",PLAYEASE_AVC_SAMPLE:"playeaseAVCSample",PLAYEASE_AAC_SPECIFIC_CONFIG:"playeaseAACSpecificConfig",PLAYEASE_AAC_SAMPLE:"playeaseAACSample",
PLAYEASE_MP4_INIT_SEGMENT:"playeaseMp4InitSegment",PLAYEASE_MP4_SEGMENT:"playeaseMp4Segment",PLAYEASE_END_OF_STREAM:"playeaseEndOfStream"}})(playease);
(function(c){var f=c.utils;c.events.eventdispatcher=function(a){function q(a,b,d){if(a)for(var g=0;g<a.length;g++){var e=a[g];if(e){null!==e.count&&0===--e.count&&delete a[g];try{e.listener(b)}catch(B){f.log('Error handling "'+d+'" event listener ['+g+"]: "+B.toString(),e.listener,b)}}}}var h={},d=[];this.addEventListener=function(a,b,d){try{f.exists(h[a])||(h[a]=[]),"string"===f.typeOf(b)&&(b=(new Function("return "+b))()),h[a].push({listener:b,count:d||null})}catch(m){f.log("error",m)}return!1};
this.removeEventListener=function(a,b){if(h[a]){try{if(void 0===b){h[a]=[];return}var d;for(d=0;d<h[a].length;d++)if(h[a][d].listener.toString()===b.toString()){h[a].splice(d,1);break}}catch(m){f.log("error",m)}return!1}};this.addGlobalListener=function(a,b){try{"string"===f.typeOf(a)&&(a=(new Function("return "+a))()),d.push({listener:a,count:b||null})}catch(e){f.log("error",e)}return!1};this.removeGlobalListener=function(a){if(a){try{var b;for(b=d.length-1;0<=b;b--)d[b].listener.toString()===a.toString()&&
d.splice(b,1)}catch(e){f.log("error",e)}return!1}};this.dispatchEvent=function(g,b){b||(b={});f.extend(b,{id:a,version:c.version,type:g});c.debug&&f.log(g,b);q(h[g],b,g);q(d,b,g)}}})(playease);
(function(c){var f=c.utils,a=c.events;f.loader=function(c){var h=f.extend(this,new a.eventdispatcher("utils.loader")),d={method:"GET",headers:{},mode:"cors",cache:"default"},g,b;h.load=function(d){g=d;b=!1;fetch?fetch(g,h.config).then(function(d){if(b)b=!1;else{if(d.ok&&200<=d.status&&299>=d.status){var e=d.headers.get("Content-Length");e&&(e=parseInt(e),h.dispatchEvent(a.PLAYEASE_CONTENT_LENGTH,{length:e}));return h.pump(d.body.getReader())}h.dispatchEvent(a.ERROR,{message:"Loader error: Invalid http status("+
d.status+" "+d.statusText+")."})}}).catch(function(b){h.dispatchEvent(a.ERROR,{message:"Loader error: "+b.message})}):h.dispatchEvent(a.ERROR,{message:"Loader error: Fetch is not supported."})};h.pump=function(d){return d.read().then(function(e){if(e.done)h.dispatchEvent(a.PLAYEASE_COMPLETE);else{if(b)return b=!1,d.cancel();h.dispatchEvent(a.PLAYEASE_PROGRESS,{data:e.value.buffer});return h.pump(d)}}).catch(function(b){h.dispatchEvent(a.ERROR,{message:"Loader error: Failed to read response data."})})};
h.abort=function(){b=!0};(function(){h.config=f.extend({},d,c);var a=new Headers,g;for(g in h.config.headers)a.append(g,h.config.headers[g]);h.config.headers=a;b=!1})()}})(playease);
(function(c){var f=c.utils,a=c.events,q={},h={onError:a.ERROR,onReady:a.PLAYEASE_READY,onMetaData:a.PLAYEASE_METADATA,onBuffer:a.PLAYEASE_BUFFER,onPlay:a.PLAYEASE_PLAY,onPause:a.PLAYEASE_PAUSE,onSeek:a.PLAYEASE_SEEK,onStop:a.PLAYEASE_STOP,onVolume:a.PLAYEASE_VIEW_VOLUME,onMute:a.PLAYEASE_VIEW_MUTE,onFullscreen:a.PLAYEASE_VIEW_FULLSCREEN};c.api=function(d){function g(a){b.dispatchEvent(a.type,a)}var b=f.extend(this,new a.eventdispatcher("api")),e;b.container=d;b.id=d.id;b.setup=function(a){f.emptyElement(b.container);
c.debug=!!a.debug;b.config=a;b.config.id=b.id;b.embedder=new c.embed(b);b.embedder.addGlobalListener(g);b.embedder.embed();return b};b.setEntity=function(a,d){e=a;b.renderName=d;b.play=e.play;b.pause=e.pause;b.seek=e.seek;b.stop=e.stop;b.volume=e.volume;b.mute=e.mute;b.fullscreen=e.fullscreen;b.resize=e.resize};(function(){f.foreach(h,function(a,d){b[a]=function(a){b.addEventListener(d,a)}})})()};c.api.getInstance=function(a){var d;null==a?a=0:a.nodeType?d=a:"string"===f.typeOf(a)&&(d=document.getElementById(a));
if(d){var b=q[d.id];b||(q[a]=b=new c.api(d));return b}return"number"===f.typeOf(a)?q[a]:null};c.api.displayError=function(a,g){}})(playease);(function(c){c.muxer={}})(playease);
(function(c){var f=c.utils,a=c.muxer.AMF={},q=a.types={DOUBLE:0,BOOLEAN:1,STRING:2,OBJECT:3,MOVIE_CLIP:4,NULL:5,UNDEFINED:6,REFERENCE:7,MIXED_ARRAY:8,END_OF_OBJECT:9,ARRAY:10,DATE:11,LONG_STRING:12,UNSUPPORTED:13,RECORD_SET:14,XML:15,TYPED_OBJECT:16,AMF3_DATA:17};a.parse=function(h,d,g){var b={};try{var e=a.parseValue(h,d,g),c=a.parseValue(h,d+e.size,g-e.size);b.key=e.data;b.value=c.data}catch(l){f.log("AMF.parse() failed. Error: "+l)}return b};a.parseObject=function(h,d,g){if(3>g)throw"Data not enough while parsing AMF object.";
for(var b={},e=0,f,c={ended:!1};!c.ended&&e<g;)f=a.parseString(h,d+e,g-e),e+=f.size,c=a.parseValue(h,d+e,g-e),e+=c.size,f.data&&c.data&&(b[f.data]=c.data);return{data:b,size:e,ended:c.ended}};a.parseString=function(a,d,g){if(2>g)throw"Data not enough while parsing AMF string.";var b=0;g=(new DataView(a,d,g)).getUint16(b);b+=2;return{data:0<g?String.fromCharCode.apply(String,new Uint8Array(a,d+b,g)):"",size:b+g}};a.parseLongString=function(a,d,g){if(4>g)throw"Data not enough while parsing AMF long string.";
var b=0;g=(new DataView(a,d,g)).getUint32(b);b+=4;return{data:0<g?String.fromCharCode.apply(String,new Uint8Array(a,d+b,g)):"",size:b+g}};a.parseDate=function(a,d,g){if(10>g)throw"Data not enough while parsing AMF date.";g=new DataView(a,d,g);a=0;d=g.getFloat64(a);a+=8;g=g.getInt16(a);return{data:new Date(d+6E4*g),size:a+2}};a.parseValue=function(c,d,g){if(1>g)throw"Data not enough while parsing AMF value.";var b=new DataView(c,d,g),e=0,h=b.getUint8(e),e=e+1,l=void 0,B=!1;try{switch(h){case q.DOUBLE:l=
b.getFloat64(e);e+=8;break;case q.BOOLEAN:l=b.getUint8(e)?!0:!1;e+=1;break;case q.STRING:var v=a.parseString(c,d+e,g-e),l=v.data,e=e+v.size;break;case q.OBJECT:var x=a.parseObject(c,d+e,g-e),l=x.data,e=e+x.size;break;case q.MIXED_ARRAY:var E;b.getUint32(e);var e=e+4,G=a.parseObject(c,d+e,g-e),l=G.data,e=e+G.size;break;case q.END_OF_OBJECT:l=void 0;B=!0;break;case q.ARRAY:E=b.getUint32(e);e+=4;l=[];for(b=0;b<E;b++){var F=a.parseValue(c,d+e,g-e);l.push(F.data);e+=F.size}break;case q.DATE:var k=a.parseDate(c,
d+e,g-e),l=k.data,e=e+k.size;break;case q.LONG_STRING:var n=a.parseString(c,d+e,g-e),l=n.data,e=e+n.size;break;default:f.log("Skipping unsupported AMF value type("+h+")."),e+=g}}catch(t){f.log("AMF.parseValue() failed. Error: "+t)}return{data:l,size:e,ended:B}}})(playease);
(function(c){var f=function(a){function c(){var a=e-b;if(0>=a)throw"Data not enough while filling current word.";var a=Math.min(4,a),d=new Uint8Array(4);d.set(g.subarray(b,b+a));m=(new DataView(d.buffer)).getUint32(0,!1);b+=a;l=8*a}function f(){var a;for(a=0;a<l;a++)if(0!==(m&2147483648>>>a))return m<<=a,l-=a,a;c();return a+f()}var d=this,g,b,e,m,l;d.readBits=function(a){if(32<a)throw"Data not enough while reading bits of ExpGolomb.";if(a<=l){var b=m>>>32-a;m<<=a;l-=a;return b}b=l?m:0;b>>>=32-l;a-=
l;c();a=Math.min(a,l);var d=m>>>32-a;m<<=a;l-=a;return b<<a|d};d.readBool=function(){return 1===d.readBits(1)};d.readByte=function(){return d.readBits(8)};d.readUEG=function(){var a=f();return d.readBits(a+1)-1};d.readSEG=function(){var a=d.readUEG();return a&1?a+1>>>1:-1*(a>>>1)};d.destroy=function(){g=null};g=a;b=0;e=a.byteLength;l=m=0};(c.muxer.SPS={}).parse=function(a){for(var c=a.byteLength,h=new Uint8Array(c),d=0,g=0;g<c;g++)2<=g&&3===a[g]&&0===a[g-1]&&0===a[g-2]||(h[d]=a[g],d++);a=new Uint8Array(h.buffer,
0,d);a=new f(a);a.readByte();var b=a.readByte();a.readByte();h=a.readByte();a.readUEG();switch(b){case 66:c="Baseline";break;case 77:c="Main";break;case 88:c="Extended";break;case 100:c="High";break;case 110:c="High10";break;case 122:c="High422";break;case 244:c="High444";break;default:c="Unknown"}var h=(h/10).toFixed(1),e=1,d=420,m=[0,420,422,444],g=8;if(100===b||110===b||122===b||244===b||44===b||83===b||86===b||118===b||128===b||138===b||144===b)if(e=a.readUEG(),3===e&&a.readBits(1),3>=e&&(d=m[e]),
g=a.readUEG()+8,a.readUEG(),a.readBits(1),a.readBool())for(b=3!==e?8:12,m=0;m<b;m++)if(a.readBool())for(var l=a,B=6>m?16:64,v=8,x=8,E=0;E<B;E++)0!==x&&(x=l.readSEG(),x=(v+x+256)%256),v=0===x?v:x;a.readUEG();b=a.readUEG();if(0===b)a.readUEG();else if(1===b)for(a.readBits(1),a.readSEG(),a.readSEG(),b=a.readUEG(),m=0;m<b;m++)a.readSEG();a.readUEG();a.readBits(1);var G=a.readUEG(),x=a.readUEG(),F=a.readBits(1);0===F&&a.readBits(1);a.readBits(1);var k=0,n=0,t=0,A=0;a.readBool()&&(k=a.readUEG(),n=a.readUEG(),
t=a.readUEG(),A=a.readUEG());m=b=1;v=0;l=!0;E=B=0;if(a.readBool()){if(a.readBool()){var r=a.readByte(),y=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],w=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];0<r&&16>r?(b=y[r-1],m=w[r-1]):255===r&&(b=a.readByte()<<8|a.readByte(),m=a.readByte()<<8|a.readByte())}a.readBool()&&a.readBool();a.readBool()&&(a.readBits(4),a.readBool()&&a.readBits(24));a.readBool()&&(a.readUEG(),a.readUEG());a.readBool()&&(v=a.readBits(32),B=a.readBits(32),l=a.readBool(),E=2*v,v=
B/E)}r=1;if(1!==b||1!==m)r=b/m;0===e?(y=1,e=2-F):(y=3===e?1:2,e=(1===e?2:1)*(2-F));G=16*(G+1)-(k+n)*y;e=16*(2-F)*(x+1)-(t+A)*e;x=Math.ceil(G*r);a.destroy();switch(d){case 420:a="4:2:0";break;case 422:a="4:2:2";break;case 444:a="4:4:4";break;default:a="Unknown"}return{profile_string:c,level_string:h,bit_depth:g,chroma_format:d,chroma_format_string:a,frame_rate:{fixed:l,fps:v,fps_den:E,fps_num:B},sar_ratio:{width:b,height:m},codec_size:{width:G,height:e},present_size:{width:x,height:e}}}})(playease);
(function(c){var f=c.utils,a=c.events;c=c.muxer;var q=c.SPS,h={AUDIO:8,VIDEO:9,SCRIPT:18},d={KEYFRAME:1,INTER_FRAME:2,DISPOSABLE_INTER_FRAME:3,GENERATED_KEYFRAME:4,INFO_OR_COMMAND_FRAME:5},g={types:{SEQUENCE_HEADER:0,NALU:1,END_OF_SEQUENCE:2}},b={types:{SPECIFIC_CONFIG:0,RAW_FRAME_DATA:1},audioObjectTypes:{NULL:0,AAC_MAIN:1,AAC_LC:2,AAC_SSR:3,AAC_LTP:4,AAC_HE_OR_SBR:5,AAC_SCALABLE:6},samplingRates:[96E3,88200,64E3,48E3,44100,32E3,24E3,22050,16E3,12E3,11025,8E3,7350]},e=[5500,11025,22050,44100,48E3],
m=function(){var a=this;a.isComplete=function(){var b=!1===a.hasAudio||!0===a.hasAudio&&null!=a.audioCodec&&null!=a.audioSampleRate&&null!=a.audioChannelCount,d=!1===a.hasVideo||!0===a.hasVideo&&null!=a.videoCodec&&null!=a.width&&null!=a.height&&null!=a.fps&&null!=a.profile&&null!=a.level&&null!=a.chromaFormat&&null!=a.sarNum&&null!=a.sarDen;return null!=a.mimeType&&null!=a.duration&&null!=a.metadata&&null!=a.hasKeyframesIndex&&b&&d};a.isSeekable=function(){return!0===a.hasKeyframesIndex};a.getNearestKeyframe=
function(b){if(null==a.keyframesIndex)return null;var d=a.keyframesIndex,c=d.times,e=0,g=c.length-1,f,h=0,m=g;b<c[0]&&(e=0,h=m+1);for(;h<=m;)if(f=h+Math.floor((m-h)/2),f===g||b>=c[f]&&b<c[f+1]){e=f;break}else c[f]<b?h=f+1:m=f-1;b=e;return{index:b,milliseconds:d.times[b],fileposition:d.filepositions[b]}}};c.flv=function(c){var l=f.extend(this,new a.eventdispatcher("muxer.flv")),v,x,E,G,F,k,n,t,A,r,y,w,z,J,D,u,p,I;l.reset=function(){x=v=0;E=1;k.position=0;y=[];w=new m;D={type:"video",id:1,sequenceNumber:0,
samples:[],length:0};u={type:"audio",id:2,sequenceNumber:0,samples:[],length:0};I=p=0};l.parse=function(b){var p=new Uint8Array(b),d=0;if(1==E){if(13>b.byteLength)return 0;d=l.probe(b);E=4;var c=f.getUint32(p,d);c&&f.log("First tag size "+c);d+=4;E=2}for(;d<b.byteLength;)switch(E){case 2:t[k.position++]=p[d++];11==k.position&&(r=t[1]<<16|t[2]<<8|t[3],E=3);break;case 3:var g=t[0],C=t[1]<<16|t[2]<<8|t[3],I=t[4]<<16|t[5]<<8|t[6]|t[7]<<24,c=t[8]<<16|t[9]<<8|t[10];0!=c&&f.log("Unknown stream ID "+c);c=
{tag:g,data:b,offset:d,size:C};switch(g){case h.AUDIO:c.timestamp=I;r==C&&(c.format=p[d]>>>4,c.rate=e[(p[d]&12)>>>2],c.samplesize=(p[d]&2)>>>1,c.sampletype=p[d]&1);break;case h.VIDEO:c.timestamp=I;r==C&&(c.frametype=p[d]>>>4,c.codec=p[d]&15);break;case h.SCRIPT:c.hasAudio=G,c.hasVideo=F}g=Math.min(b.byteLength-d,r);r-=g;d+=g;if(r){y.push(c);break}if(y.length){c=y[0];C=new Uint8Array(C);for(C.position=0;y.length;)I=y.shift(),g=new Uint8Array(I.data.slice(I.offset)),C.set(g,C.position),C.position+=
I.data.byteLength-I.offset;g=new Uint8Array(b.slice(0,d));C.set(g,C.position);c.data=C.buffer;c.offset=0}E=4;n.position=0;l.dispatchEvent(a.PLAYEASE_FLV_TAG,c);break;case 4:A[n.position++]=p[d++];4==n.position&&(C=t[1]<<16|t[2]<<8|t[3],c=f.getUint32(A),c!=11+C&&f.log("prevTagSize("+c+") is not equals to "+(11+C)+"."),E=2,k.position=0);break;default:f.log("Unknown parsing state "+E);return}};l.parseAVCVideoPacket=function(b,c,e,h,k){if(5>e)l.dispatchEvent(a.ERROR,{message:"Data not enough while parsing AVC video packet."});
else{var C=new DataView(b,c,e),t=1,m=C.getUint8(t++),C=C.getUint8(t++)<<16|C.getUint8(t++)<<8|C.getUint8(t++);switch(m){case g.types.SEQUENCE_HEADER:C=c+t;c=e-t;if(7>c)l.dispatchEvent(a.ERROR,{message:"Data not enough while parsing AVC decoder configuration record."});else if(e=D,e={type:e.type,id:e.id,timescale:1E3,duration:1E3*z.duration||0},t=new DataView(b,C,c),m=0,k=t.getUint8(m++),h=t.getUint8(m++),t.getUint8(m++),t.getUint8(m++),1!=k||0==h)l.dispatchEvent(a.ERROR,{message:"Invalid AVCDecoderConfigurationRecord."});
else if(p=1+(t.getUint8(m++)&3),3!=p&&4!=p)l.dispatchEvent(a.ERROR,{message:"Invalid lengthSizeMinusOne "+p+"."});else{h=t.getUint8(m++)&31;for(k=0;k<h;k++){var n=t.getUint16(m),m=m+2;if(0!=n){var K=new Uint8Array(b,C+m,n),m=m+n,n=q.parse(K),r=e,H=n;r.codecWidth=H.codec_size.width;r.codecHeight=H.codec_size.height;r.presentWidth=H.present_size.width;r.presentHeight=H.present_size.height;r.profile=H.profile_string;r.level=H.level_string;r.bitDepth=H.bit_depth;r.chromaFormat=H.chroma_format;r.sarRatio=
H.sar_ratio;r.frameRate=H.frame_rate;if(!1===H.frame_rate.fixed||0===H.frame_rate.fps_num||0===H.frame_rate.fps_den)r.frameRate=J;r.refSampleDuration=Math.floor(r.frameRate.fps_den/r.frameRate.fps_num*r.timescale);for(var K=K.subarray(1,4),H="avc1.",L=0;3>L;L++){var M=K[L].toString(16);2>M.length&&(M="0"+M);H+=M}r.codec=H;r=e;w.hasAudio=G;w.hasVideo=F;w.duration=1E3*z.duration;w.metadata=z;w.width=r.codecWidth;w.height=r.codecHeight;w.fps=r.frameRate.fps;w.profile=r.profile;w.level=r.level;w.chromaFormat=
n.chroma_format_string;w.sarNum=r.sarRatio.width;w.sarDen=r.sarRatio.height;w.videoCodec=r.codec;w.mimeType='video/mp4; codecs="'+w.videoCodec+(w.hasAudio&&w.audioCodec?","+w.audioCodec:"")+'"';l.dispatchEvent(a.PLAYEASE_MEDIA_INFO,{info:w})}}h=t.getUint8(m++);for(k=0;k<h;k++)n=t.getUint16(m),m+=2,0!=n&&(new Uint8Array(b,C+m,n),m+=n);e.avcc=new Uint8Array(c);e.avcc.set(new Uint8Array(b,C,c),0);l.dispatchEvent(a.PLAYEASE_AVC_CONFIG_RECORD,{data:e})}break;case g.types.NALU:a:{c+=t;e-=t;t=new DataView(b,
c,e);m=[];h=I+h;k=k==d.KEYFRAME;for(r=n=0;n<e;){if(n+4>=e){l.dispatchEvent(a.ERROR,{message:"Data not enough for next NALU."});break a}K=t.getUint32(n);3==K&&(K>>>=8);if(K>e-p){f.log("Malformed Nalus near timestamp "+h+".");break a}H=t.getUint8(n+p)&31;H==d.INFO_OR_COMMAND_FRAME&&(k=!0);L=new Uint8Array(b,c+n,p+K);r+=L.byteLength;m.push({type:H,data:L});n+=p+K}0!=m.length&&(D.samples.push({units:m,length:r,isKeyframe:k,cts:C,dts:h,pts:C+h}),D.length+=r,l.dispatchEvent(a.PLAYEASE_AVC_SAMPLE,{data:D}))}break;
case g.types.END_OF_SEQUENCE:l.dispatchEvent(a.PLAYEASE_END_OF_STREAM);break;default:l.dispatchEvent(a.ERROR,{message:"Unknown AVC video packet type "+m+"."})}}};l.parseAACAudioPacket=function(p,d,c,e,g,f,h){if(2>c)l.dispatchEvent(a.ERROR,{message:"Data not enough while parsing AAC audio packet."});else switch(g=1,f=(new DataView(p,d,c)).getUint8(g++),f){case b.types.SPECIFIC_CONFIG:e=d+g;c-=g;3>c?l.dispatchEvent(a.ERROR,{message:"Data not enough while parsing AAC audio specific config."}):(g=new DataView(p,
e,c),f=0,c=g.getUint8(f)>>>3,p=(g.getUint8(f++)&7)<<1|g.getUint8(f)>>>7,0>p||p>=b.samplingRates.length?l.dispatchEvent(a.ERROR,{message:"Invalid AAC sampling frequency index.",index:p}):(e=u,e={type:e.type,id:e.id,timescale:1E3,duration:1E3*z.duration||0},e.audioSampleRate=b.samplingRates[p],e.refSampleDuration=Math.floor(1024/e.audioSampleRate*e.timescale),d=(g.getUint8(f)&120)>>>3,0>d||8<=d?l.dispatchEvent(a.ERROR,{message:"Invalid AAC channel configuration.",config:d}):(c===b.audioObjectTypes.AAC_HE_OR_SBR&&
(g.getUint8(f++),g.getUint8(f),g.getUint8(f)),c=self.navigator.userAgent.toLowerCase(),-1!==c.indexOf("firefox")?p>=b.audioObjectTypes.AAC_SCALABLE?(c=b.audioObjectTypes.AAC_HE_OR_SBR,g=p-3,f=Array(4)):(c=b.audioObjectTypes.AAC_LC,g=p,f=Array(2)):-1!==c.indexOf("android")?(c=b.audioObjectTypes.AAC_LC,g=p,f=Array(2)):(c=b.audioObjectTypes.AAC_HE_OR_SBR,g=p,f=Array(4),p>=b.audioObjectTypes.AAC_SCALABLE?g=p-3:1===d&&(c=b.audioObjectTypes.AAC_LC,g=p,f=Array(2))),f[0]=c<<3,f[0]|=(p&15)>>>1,f[1]=(p&15)<<
7,f[1]|=(d&15)<<3,c===b.audioObjectTypes.AAC_HE_OR_SBR&&(f[1]|=(g&15)>>>1,f[2]=(g&1)<<7,f[2]|=8,f[3]=0),e.channelCount=d,e.codec="mp4a.40."+c,e.config=f,w.audioCodec=e.codec,w.audioSampleRate=e.audioSampleRate,w.audioChannelCount=e.channelCount,w.mimeType='video/mp4; codecs="'+w.videoCodec+(w.hasAudio&&w.audioCodec?","+w.audioCodec:"")+'"',l.dispatchEvent(a.PLAYEASE_MEDIA_INFO,{info:w}),l.dispatchEvent(a.PLAYEASE_AAC_SPECIFIC_CONFIG,{data:e}))));break;case b.types.RAW_FRAME_DATA:p=new Uint8Array(p,
d+g,c-g);c=I+e;u.samples.push({unit:p,dts:c,pts:c});u.length+=p.length;l.dispatchEvent(a.PLAYEASE_AAC_SAMPLE,{data:u});break;default:l.dispatchEvent(a.ERROR,{message:"Unknown AAC audio packet type "+f+"."})}};l.probe=function(a){a=new Uint8Array(a);if(70!==a[0]||76!==a[1]||86!==a[2]||1!==a[3])return 0;G=0!==(a[4]&4)>>>2;F=0!==(a[4]&1);if(!G&&!F)return 0;a=f.getUint32(a,5);return 9>a?0:a};l.setMetaData=function(a){z=a;"number"===typeof z.audiodatarate&&(w.audioDataRate=z.audiodatarate);"number"===
typeof z.videodatarate&&(w.videoDataRate=z.videodatarate);if("number"===typeof z.framerate&&(a=Math.floor(1E3*z.framerate),0<a)){var p=a/1E3;J.fixed=!0;J.fps=p;J.fps_num=a;J.fps_den=1E3;w.fps=p}w.hasKeyframesIndex="object"===typeof z.keyframes?!0:!1};l.getMetaData=function(){return z};l.offset=function(){return v};l.length=function(){return x};l.destroy=function(){};l.config=f.extend({},{},c);x=v=0;E=1;k=new ArrayBuffer(11);k.position=0;t=new Uint8Array(k);n=new ArrayBuffer(4);n.position=0;A=new Uint8Array(n);
r=0;y=[];w=new m;J={fixed:!0,fps:23.976,fps_num:23976,fps_den:1E3};D={type:"video",id:1,sequenceNumber:0,samples:[],length:0};u={type:"audio",id:2,sequenceNumber:0,samples:[],length:0};I=p=0};c.flv.TAG=h;c.flv.FORMATS={LINEAR_PCM_PLATFORM_ENDIAN:0,ADPCM:1,MP3:2,LINEAR_PCM_LITTLE_ENDIAN:3,NELLYMOSER_16_kHz_MONO:4,NELLYMOSER_8_kHz_MONO:5,NELLYMOSER:6,G_711_A_LAW_LOGARITHMIC_PCM:7,G_711_MU_LAW_LOGARITHMIC_PCM:8,RESERVED:9,AAC:10,SPEEX:11,MP3_8_kHz:14,DEVICE_SPECIFIC_SOUND:15};c.flv.FRAMES=d;c.flv.CODECS=
{JPEG:1,H263:2,SCREEN_VIDEO:3,VP6:4,VP6_ALPHA:5,SCREEN_VIDEO_2:6,AVC:7};c.flv.AVC=g;c.flv.AAC=b})(playease);
(function(c){var f=c.utils,a=c.events;c=c.muxer;var q=c.flv.AAC,h,d,g,b,e,m,l,B,v;h=new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]);d=new Uint8Array([0,0,0,0,0,0,0,1]);g=new Uint8Array([0,0,0,0,0,0,0,0]);b=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]);e=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]);m=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,
108,101,114,0]);l=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]);B=new Uint8Array([0,0,0,0,0,0,0,0]);v=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]);q.getSilentFrame=function(a){return 1===a?new Uint8Array([0,200,0,128,35,128]):2===a?new Uint8Array([33,0,73,144,2,25,0,35,128]):3===a?new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]):4===a?new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]):5===a?new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,
0,33,144,2,56]):6===a?new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]):null};var x=function(a,b,d,c,e){this.dts=a;this.pts=b;this.duration=d;this.originalDts=c;this.isSyncPoint=e;this.fileposition=null},E=function(){var a=[];this.appendSyncPoint=function(b){b.isSyncPoint=!0;a.push(b)}},G=function(a){function b(){c=[];e=-1}var d=this,c,e;d.reset=b;d.searchNearestSegmentBefore=function(a){if(0===c.length)return-2;var b=c.length-1,d,e=0,g=b,f=0;if(a<c[0].originalBeginDts)return-1;
for(;e<=g;){d=e+Math.floor((g-e)/2);if(d===b||a>c[d].lastSample.originalDts&&a<c[d+1].originalBeginDts){f=d;break}c[d].originalBeginDts<a?e=d+1:g=d-1}return f};d.searchNearestSegmentAfter=function(a){return d.searchNearestSegmentBefore(a)+1};d.append=function(a){var b=e,g=0;-1!==b&&b<c.length&&a.originalBeginDts>=c[b].lastSample.originalDts&&(b===c.length-1||b<c.length-1&&a.originalBeginDts<c[b+1].originalBeginDts)?g=b+1:0<c.length&&(g=d.searchNearestSegmentBefore(a.originalBeginDts)+1);e=g;c.splice(g,
0,a)};d.getLastSegmentBefore=function(a){a=d.searchNearestSegmentBefore(a);return 0>a?null:c[a]};d.getLastSampleBefore=function(a){a=d.getLastSegmentBefore(a);return null==a?null:a.lastSample};d.getLastSyncPointBefore=function(a){a=d.searchNearestSegmentBefore(a);for(var b=c[a].syncPoints;0===b.length&&a--;)b=c[a].syncPoints;return 0>=b.length?null:b[b.length-1]};d.isEmpty=function(){return 0===c.length};d.clear=function(){c=[];e=-1};b()};c.mp4=function(c){var k=f.extend(this,new a.eventdispatcher("muxer.mp4")),
n={islive:!1},t,A,r,y,w,z,F,D,u={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};k.reset=function(){t=0;r=A=void 0;z.reset();F.reset();D=!1};k.getInitSegment=function(b){var p=k.box(u.ftyp,h),d=k.moov(b),c=new Uint8Array(p.byteLength+d.byteLength);c.set(p,0);c.set(d,p.byteLength);
k.dispatchEvent(a.PLAYEASE_MP4_INIT_SEGMENT,{tp:b.type,data:c})};k.getVideoSegment=function(b){var d=b.samples,p=void 0,c=-1,e=-1,g;if(d&&0!==d.length){g=0;var f=8+b.length,h=new Uint8Array(f);h[g++]=f>>>24&255;h[g++]=f>>>16&255;h[g++]=f>>>8&255;h[g++]=f&255;h.set(u.mdat,g);g+=4;for(var f=[],m=new E;d.length;){var l=d.shift(),n=l.isKeyframe,q=l.dts-t;if(void 0==p)if(void 0==A)if(z.isEmpty())p=0;else if(p=z.getLastSampleBefore(q),null!=p){var r=q-(p.originalDts+p.duration);3>=r&&(r=0);p=q-(p.dts+p.duration+
r)}else p=0;else p=q-A;var r=q-p,w=l.cts,v=r+w;-1===c&&(c=r,e=v);for(var F=0;l.units.length;){var D=l.units.shift().data;h.set(D,g);g+=D.byteLength;F+=D.byteLength}D=1<=d.length?d[0].dts-t-p-r:1<=f.length?f[f.length-1].duration:y.refSampleDuration+p;if(n){var B=new x(r,v,D,l.dts,!0);B.fileposition=l.fileposition;m.appendSyncPoint(B)}f.push({dts:r,pts:v,cts:w,size:F,isKeyframe:n,duration:D,originalDts:q,flags:{isLeading:0,dependsOn:n?2:1,isDependedOn:n?1:0,hasRedundancy:0,isNonSync:n?0:1}})}l=f[f.length-
1];d=l.dts+l.duration;g=l.pts+l.duration;A=d;m.beginDts=c;m.endDts=d;m.beginPts=e;m.endPts=g;m.originalBeginDts=f[0].originalDts;m.originalEndDts=l.originalDts+l.duration;m.firstSample=new x(f[0].dts,f[0].pts,f[0].duration,f[0].originalDts,f[0].isKeyframe);m.lastSample=new x(l.dts,l.pts,l.duration,l.originalDts,l.isKeyframe);k.config.islive||z.append(m);b.samples=f;b.sequenceNumber++;c=k.moof(b,c);b.samples=[];b.length=0;k.dispatchEvent(a.PLAYEASE_MP4_SEGMENT,{tp:"video",data:_mergeBoxes(c,h),sampleCount:f.length,
info:m})}};k.getAudioSegment=function(b){var d=b.samples,p=void 0,c=-1,e;e=!1;var g=-1;if(d&&0!==d.length){var h=0,m=8+b.length,l=new Uint8Array(m);l[h++]=m>>>24&255;l[h++]=m>>>16&255;l[h++]=m>>>8&255;l[h++]=m&255;l.set(u.mdat,h);for(var h=h+4,n=[];d.length;){var v=d.shift(),y=v.unit,B=v.dts-t;if(void 0==p)if(void 0==r)if(F.isEmpty())p=0,D&&!z.isEmpty()&&(e=!0);else if(p=F.getLastSampleBefore(B),null!=p){var A=B-(p.originalDts+p.duration);3>=A&&(A=0);p=B-(p.dts+p.duration+A)}else p=0;else p=B-r;A=
B-p;if(e){var G=z.getLastSegmentBefore(B);null!=G&&G.beginDts<A?(g=A-G.beginDts,A=G.beginDts):e=!1}-1===c&&(c=A);e?(e=!1,d.unshift(v),v=A,y=g,B=q.getSilentFrame(w.channelCount),null==B?(f.log("Cannot generate silent aac frame, channelCount: "+w.channelCount+"."),v=null):v={unit:B,mp4Sample:{dts:v,pts:v,cts:0,size:B.byteLength,duration:y,originalDts:v,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}},null!=v&&(y=v.unit,n.push(v.mp4Sample),h=0,m+=y.byteLength,l=new Uint8Array(m),l[h++]=
m>>>24&255,l[h++]=m>>>16&255,l[h++]=m>>>8&255,l[h++]=m&255,l.set(u.mdat,h),h+=4,l.set(y,h),h+=y.byteLength)):(n.push({dts:A,pts:A,cts:0,size:y.byteLength,duration:1<=d.length?d[0].dts-t-p-A:1<=n.length?n[n.length-1].duration:w.refSampleDuration+p,originalDts:B,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}),l.set(y,h),h+=y.byteLength)}g=n[n.length-1];r=e=g.dts+g.duration;d=new E;d.beginDts=c;d.endDts=e;d.beginPts=c;d.endPts=e;d.originalBeginDts=n[0].originalDts;d.originalEndDts=g.originalDts+
g.duration;d.firstSample=new x(n[0].dts,n[0].pts,n[0].duration,n[0].originalDts,!1);d.lastSample=new x(g.dts,g.pts,g.duration,g.originalDts,!1);k.config.islive||F.append(d);b.samples=n;b.sequenceNumber++;c=k.moof(b,c);b.samples=[];b.length=0;k.dispatchEvent(a.PLAYEASE_MP4_SEGMENT,{tp:"audio",data:_mergeBoxes(c,l),sampleCount:n.length,info:d})}};_mergeBoxes=function(a,b){var d=new Uint8Array(a.byteLength+b.byteLength);d.set(a,0);d.set(b,a.byteLength);return d};k.setVideoMeta=function(a){y=a};k.setAudioMeta=
function(a){w=a};k.box=function(a){for(var b=8,d=Array.prototype.slice.call(arguments,1),p=0;p<d.length;p++)b+=d[p].byteLength;var c=new Uint8Array(b),e=0;c[e++]=b>>>24&255;c[e++]=b>>>16&255;c[e++]=b>>>8&255;c[e++]=b&255;c.set(a,e);e+=4;for(p=0;p<d.length;p++)c.set(d[p],e),e+=d[p].byteLength;return c};k.moov=function(a){var b=k.mvhd(a.timescale,a.duration),d=k.trak(a);a=k.mvex(a);return k.box(u.moov,b,d,a)};k.mvhd=function(a,b){return k.box(u.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,a>>>24&255,
a>>>16&255,a>>>8&255,a&255,b>>>24&255,b>>>16&255,b>>>8&255,b&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))};k.trak=function(a){return k.box(u.trak,k.tkhd(a),k.mdia(a))};k.tkhd=function(a){var b=a.id,d=a.duration,c=a.presentWidth;a=a.presentHeight;return k.box(u.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,b>>>24&255,b>>>16&255,b>>>8&255,b&255,0,0,0,0,d>>>24&255,d>>>16&
255,d>>>8&255,d&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,c>>>8&255,c&255,0,0,a>>>8&255,a&255,0,0]))};k.mdia=function(a){return k.box(u.mdia,k.mdhd(a),k.hdlr(a),k.minf(a))};k.mdhd=function(a){var b=a.timescale;a=a.duration;return k.box(u.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,b>>>24&255,b>>>16&255,b>>>8&255,b&255,a>>>24&255,a>>>16&255,a>>>8&255,a&255,85,196,0,0]))};k.hdlr=function(a){return k.box(u.hdlr,"audio"===a.type?m:e)};
k.minf=function(a){var b;b="audio"===a.type?k.box(u.smhd,B):k.box(u.vmhd,v);return k.box(u.minf,b,k.dinf(),k.stbl(a))};k.dinf=function(){return k.box(u.dinf,k.box(u.dref,l))};k.stbl=function(a){return k.box(u.stbl,k.stsd(a),k.box(u.stts,g),k.box(u.stsc,g),k.box(u.stsz,b),k.box(u.stco,g))};k.stsd=function(a){return"audio"===a.type?k.box(u.stsd,d,k.mp4a(a)):k.box(u.stsd,d,k.avc1(a))};k.mp4a=function(a){var b=a.audioSampleRate,b=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,a.channelCount,0,16,0,
0,0,0,b>>>8&255,b&255,0,0]);return k.box(u.mp4a,b,k.esds(a))};k.esds=function(a){a=a.config;var b=a.length;a=new Uint8Array([0,0,0,0,3,23+b,0,1,0,4,15+b,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([b]).concat(a).concat([6,1,2]));return k.box(u.esds,a)};k.avc1=function(a){var b=a.avcc,d=a.codecWidth;a=a.codecHeight;d=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,d>>>8&255,d&255,a>>>8&255,a&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return k.box(u.avc1,d,k.box(u.avcC,b))};k.mvex=function(a){return k.box(u.mvex,k.trex(a))};k.trex=function(a){a=a.id;a=new Uint8Array([0,0,0,0,a>>>24&255,a>>>16&255,a>>>8&255,a&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return k.box(u.trex,a)};k.moof=function(a,b){return k.box(u.moof,k.mfhd(a.sequenceNumber),k.traf(a,b))};k.mfhd=function(a){a=new Uint8Array([0,0,0,0,a>>>24&255,a>>>16&255,a>>>8&255,a&255]);return k.box(u.mfhd,a)};k.traf=function(a,b){var d=a.id,d=k.box(u.tfhd,
new Uint8Array([0,0,0,0,d>>>24&255,d>>>16&255,d>>>8&255,d&255]));b=k.box(u.tfdt,new Uint8Array([0,0,0,0,b>>>24&255,b>>>16&255,b>>>8&255,b&255]));var c=k.sdtp(a);a=k.trun(a,c.byteLength+16+16+8+16+8+8);return k.box(u.traf,d,b,a,c)};k.sdtp=function(a){a=a.samples||[];for(var b=a.length,d=new Uint8Array(4+b),c=0;c<b;c++){var e=a[c].flags;d[c+4]=e.isLeading<<6|e.dependsOn<<4|e.isDependedOn<<2|e.hasRedundancy}return k.box(u.sdtp,d)};k.trun=function(a,b){a=a.samples||[];var d=a.length,c=12+16*d,e=new Uint8Array(c);
b+=8+c;e.set([0,0,15,1,d>>>24&255,d>>>16&255,d>>>8&255,d&255,b>>>24&255,b>>>16&255,b>>>8&255,b&255],0);for(b=0;b<d;b++){var c=a[b].duration,g=a[b].size,f=a[b].flags,p=a[b].cts;e.set([c>>>24&255,c>>>16&255,c>>>8&255,c&255,g>>>24&255,g>>>16&255,g>>>8&255,g&255,f.isLeading<<2|f.dependsOn,f.isDependedOn<<6|f.hasRedundancy<<4|f.isNonSync,0,0,p>>>24&255,p>>>16&255,p>>>8&255,p&255],12+16*b)}return k.box(u.trun,e)};k.mdat=function(a){return k.box(u.mdat,a)};k.destroy=function(){};(function(){k.config=f.extend({},
n,c);for(var a in u)u[a]=[a.charCodeAt(0),a.charCodeAt(1),a.charCodeAt(2),a.charCodeAt(3)];t=0;z=new G("video");F=new G("audio");D=!1})()}})(playease);(function(c){c.core={}})(playease);(function(c){c.core.states={BUFFERING:"buffering",PLAYING:"playing",SEEKING:"seeking",PAUSED:"paused",STOPPED:"stopped",ERROR:"error"}})(playease);(function(c){c.core.skins={}})(playease);(function(c){c.core.skins.modes={DEFAULT:"def"}})(playease);
(function(c){var f=c.utils,a=c.events;c=c.core.skins;var q=c.modes,h=f.css,d="pla-skin";c.def=function(c){var b=f.extend(this,new a.eventdispatcher("skins.def")),e=c.height;b.resize=function(a,b){f.log("Resizing to "+a+", "+b);parseInt(a);e=parseInt(b)};b.name=q.DEFAULT;d+="-"+b.name;h(".pla-wrapper",{width:c.width+"px",height:e+"px","box-shadow":"0 1px 1px rgba(0, 0, 0, 0.05)"});h(".pla-wrapper *",{margin:"0",padding:"0","font-family":"\u5fae\u8f6f\u96c5\u9ed1,arial,sans-serif","font-size":"14px",
"font-weight":"normal","box-sizing":"content-box"});h("."+d+" .pla-render",{width:"100%",height:"100%",position:"relative"});h("."+d+" .pla-render video",{})}})(playease);(function(c){c.core.renders={}})(playease);(function(c){c.core.renders.modes={DEFAULT:"def",FLV:"flv"}})(playease);
(function(c){var f=c.utils,a=c.events;c=c.core.renders;var q=c.modes;c.def=function(c,d){function g(d){e.removeEventListener("play",g);b.dispatchEvent(a.PLAYEASE_VIEW_PLAY)}var b=f.extend(this,new a.eventdispatcher("renders.def")),e;b.setup=function(){b.dispatchEvent(a.PLAYEASE_READY,{id:b.config.id})};b.play=function(a){a&&(d.url=a);if(a||e.src!=d.url)e.pause(),e.src=d.url,e.load();e.play()};b.pause=function(){e.pause()};b.seek=function(a){};b.stop=function(){e.pause();e.src=null};b.volume=function(a){};
b.mute=function(a){};b.fullscreen=function(a){};b.element=function(){return e};b.resize=function(a,b){};b.destroy=function(){};b.name=q.DEFAULT;b.config=f.extend({},{},d);e=f.createElement("video");e.width=b.config.width;e.height=b.config.height;e.controls=b.config.controls;e.autoplay=b.config.autoplay;e.poster=b.config.poster;b.config.autoplay||e.addEventListener("play",g)}})(playease);
(function(c){var f=c.utils,a=c.events,q=c.muxer;c=c.core.renders;var h=c.modes,d=q.AMF,g=q.flv.TAG,b=q.flv.FORMATS,e=q.flv.CODECS;c.flv=function(c,l){function m(b){t.removeEventListener("play",m);n.dispatchEvent(a.PLAYEASE_VIEW_PLAY)}function v(a){f.log("media source open");A.load(l.url)}function x(a){f.log("update end");var b=a.target.type;if(u){if(!z||"open"!==z.readyState)return;if(!D.audio.length&&!D.video.length){z.endOfStream();return}}if(0!=D[b].length&&(a=J[b],!a.updating)){b=D[b].shift();
try{a.appendBuffer(b)}catch(C){f.log(C)}}}function E(a){f.log("source buffer error")}function G(a){f.log("media source ended")}function F(a){f.log("media source close")}function k(a){f.log("media source error")}var n=f.extend(this,new a.eventdispatcher("renders.def")),t,A,r,y,w,z,J,D,u=!1;n.setup=function(){n.dispatchEvent(a.PLAYEASE_READY,{id:n.config.id})};n.play=function(a){a&&(l.url=a);if(a||t.src!=l.url)D.audio=[],D.video=[],A.abort(),r.reset(),y.reset(),t.pause(),t.src=URL.createObjectURL(z),
t.load();t.play()};n.pause=function(){t.pause()};n.seek=function(a){};n.stop=function(){D.audio=[];D.video=[];A.abort();t.pause();t.src=null};n.volume=function(a){};n.mute=function(a){};n.fullscreen=function(a){};n.appendInitSegment=function(b,d){var c=b+'/mp4; codecs="'+w[b+"Codec"]+'"';f.log("Mime type: "+c+".");MediaSource.isTypeSupported(c)?"closed"==z.readyState?n.dispatchEvent(a.PLAYEASE_RENDER_ERROR,{message:"MediaSource is closed while appending init segment."}):(c=J[b]=z.addSourceBuffer(c),
c.type=b,c.addEventListener("updateend",x),c.addEventListener("error",E),c.appendBuffer(d)):n.dispatchEvent(a.PLAYEASE_RENDER_ERROR,{message:"Mime type is not surpported: "+c+"."})};n.appendSegment=function(a,b){D[a].push(b);var d=J[a];d.updating||(b=D[a].shift(),d.appendBuffer(b))};n.element=function(){return t};n.resize=function(a,b){};n.destroy=function(){};n.name=h.FLV;n.config=f.extend({},{},l);J={audio:null,video:null};D={audio:[],video:[]};t=f.createElement("video");t.width=n.config.width;
t.height=n.config.height;t.controls=n.config.controls;t.autoplay=n.config.autoplay;t.poster=n.config.poster;n.config.autoplay||t.addEventListener("play",m);A=new f.loader(l.loader);A.addEventListener(a.PLAYEASE_CONTENT_LENGTH,function(a){f.log("onContenLength: "+a.length)});A.addEventListener(a.PLAYEASE_PROGRESS,function(a){r.parse(a.data)});A.addEventListener(a.PLAYEASE_COMPLETE,function(a){f.log("onLoaderComplete")});A.addEventListener(a.ERROR,function(a){f.log(a.message)});r=new q.flv;r.addEventListener(a.PLAYEASE_FLV_TAG,
function(a){switch(a.tag){case g.AUDIO:if(a.format&&a.format!=b.AAC){f.log("Unsupported audio format("+a.format+").");break}r.parseAACAudioPacket(a.data,a.offset,a.size,a.timestamp,a.rate,a.samplesize,a.sampletype);break;case g.VIDEO:if(a.codec&&a.codec!=e.AVC){f.log("Unsupported video codec("+a.codec+").");break}r.parseAVCVideoPacket(a.data,a.offset,a.size,a.timestamp,a.frametype);break;case g.SCRIPT:a=d.parse(a.data,a.offset,a.size);f.log(a.key+": "+JSON.stringify(a.value));"onMetaData"==a.key&&
r.setMetaData(a.value);break;default:f.log("Skipping unknown tag type "+a.tag)}});r.addEventListener(a.PLAYEASE_MEDIA_INFO,function(a){w=a.info});r.addEventListener(a.PLAYEASE_AVC_CONFIG_RECORD,function(a){y.setVideoMeta(a.data);y.getInitSegment(a.data)});r.addEventListener(a.PLAYEASE_AVC_SAMPLE,function(a){y.getVideoSegment(a.data)});r.addEventListener(a.PLAYEASE_AAC_SPECIFIC_CONFIG,function(a){y.setAudioMeta(a.data);y.getInitSegment(a.data)});r.addEventListener(a.PLAYEASE_AAC_SAMPLE,function(a){y.getAudioSegment(a.data)});
r.addEventListener(a.PLAYEASE_END_OF_STREAM,function(a){u=!0});r.addEventListener(a.ERROR,function(a){f.log(a.message)});y=new q.mp4;y.addEventListener(a.PLAYEASE_MP4_INIT_SEGMENT,function(a){n.appendInitSegment(a.tp,a.data)});y.addEventListener(a.PLAYEASE_MP4_SEGMENT,function(a){n.appendSegment(a.tp,a.data)});y.addEventListener(a.ERROR,function(a){f.log(a.message)});window.MediaSource=window.MediaSource||window.WebKitMediaSource;z=new MediaSource;z.addEventListener("sourceopen",v);z.addEventListener("sourceended",
G);z.addEventListener("sourceclose",F);z.addEventListener("error",k);z.addEventListener("webkitsourceopen",v);z.addEventListener("webkitsourceended",G);z.addEventListener("webkitsourceclose",F);z.addEventListener("webkiterror",k)}})(playease);
(function(c){var f=c.utils,a=c.events,q=c.core;q.entity=function(c){var d=f.extend(this,new a.eventdispatcher("core.entity")),g,b,e;d.setup=function(){setTimeout(function(){b.setup()},0)};d.destroy=function(){e&&e.stop();b&&b.destroy();g&&g.destroy()};d.id=c.id;d.model=g=new q.model(c);d.view=b=new q.view(d,g);d.controller=e=new q.controller(g,b);e.addGlobalListener(function(a){d.dispatchEvent(a.type,a)});d.play=e.play;d.pause=e.pause;d.seek=e.seek;d.stop=e.stop;d.volume=e.volume;d.mute=e.mute;d.fullscreen=
e.fullscreen;d.getState=g.getState;d.resize=b.resize}})(playease);
(function(c){var f=c.utils,a=c.events;c=c.core;var q=c.states;c.model=function(c){var d=f.extend(this,new a.eventdispatcher("core.model")),g=q.STOPPED,b;d.setState=function(b){b!==g&&(g=b,d.dispatchEvent(a.PLAYEASE_STATE,{state:b}))};d.getState=function(){return g};d.setProperty=function(c,g){1==b.hasOwnProperty(c)&&(b[c]=g,d.dispatchEvent(a.PLAYEASE_PROPERTY,{key:c,value:g}))};d.getProperty=function(a){return b[a]};d.getConfig=function(a){return d.config[a]||{}};d.destroy=function(){};d.config=f.extend({},
{},c);b={}}})(playease);
(function(c){var f=c.utils,a=c.events;c=c.core;var q=c.renders,h=c.skins;c.view=function(d,c){function b(){var b=f.extend({},c.getConfig("render"),{id:d.id,url:c.config.url,width:c.config.width,height:c.config.height,controls:c.config.controls,autoplay:c.config.autoplay,poster:c.config.poster,loader:{mode:c.config.cors}});try{n=v.render=new q[b.name](v,b),n.addEventListener(a.PLAYEASE_READY,B),n.addEventListener(a.PLAYEASE_VIEW_PLAY,B),n.addEventListener(a.PLAYEASE_RENDER_ERROR,l)}catch(A){f.log("Failed to init render "+
b.name+"!")}n&&E.appendChild(n.element())}function e(){var a=f.extend({},c.getConfig("skin"),{id:d.id,width:c.config.width,height:c.config.height});try{new h[a.name](a)}catch(A){f.log("Failed to init skin "+a.name+"!")}}function g(a){if(a.ctrlKey||a.metaKey)return!0;if(/13|32/.test(a.keyCode))return a.preventDefault?a.preventDefault():a.returnValue=!1,!1}function l(a){B(a)}function B(a){v.dispatchEvent(a.type,a)}var v=f.extend(this,new a.eventdispatcher("core.view")),x,E,G,F,k,n;v.setup=function(){if(n){n.setup();
try{x.addEventListener("keydown",g)}catch(t){x.attachEvent("onkeydown",g)}}else v.dispatchEvent(a.PLAYEASE_SETUP_ERROR,{message:"Render not available!",name:c.config.render.name})};v.display=function(a,b){};v.resize=function(a,b){n&&n.resize(a,b)};v.destroy=function(){if(x)try{x.removeEventListener("keydown",g)}catch(t){x.detachEvent("onkeydown",g)}n&&n.destroy()};(function(){x=f.createElement("div","pla-wrapper pla-skin-"+c.config.skin.name);x.id=d.id;x.tabIndex=0;E=f.createElement("div","pla-render");
G=f.createElement("div","pla-poster");F=f.createElement("div","pla-controls");k=f.createElement("div","pla-contextmenu");x.appendChild(E);x.appendChild(G);x.appendChild(F);x.appendChild(k);b();e();var a=document.getElementById(d.id);a.parentNode.replaceChild(x,a);window.onresize=function(){"function"==f.typeOf(c.config.onresize)&&c.config.onresize.call(null)}})()}})(playease);
(function(c){var f=c.utils,a=c.events;c=c.core;var q=c.states;c.controller=function(c,d){function g(a){b.dispatchEvent(a.type,a)}var b=f.extend(this,new a.eventdispatcher("core.controller")),e=!1;c.addEventListener(a.PLAYEASE_STATE,function(c){switch(c.state){case q.BUFFERING:b.dispatchEvent(a.PLAYEASE_BUFFER);break;case q.PLAYING:b.dispatchEvent(a.PLAYEASE_PLAY);break;case q.PAUSED:b.dispatchEvent(a.PLAYEASE_PAUSE);break;case q.SEEKING:b.dispatchEvent(a.PLAYEASE_SEEK);break;case q.STOPPED:b.dispatchEvent(a.PLAYEASE_STOP);
break;case q.ERROR:break;default:b.dispatchEvent(a.ERROR,{message:"Unknown model state!",state:c.state})}});d.addEventListener(a.PLAYEASE_READY,function(a){e||(f.log("Player ready!"),e=!0,g(a),c.config.autoplay&&b.play(),window.onbeforeunload=function(a){})});d.addEventListener(a.PLAYEASE_SETUP_ERROR,function(a){c.setState(q.ERROR);g(a)});d.addEventListener(a.PLAYEASE_VIEW_PLAY,function(a){var d=c.getState();if(d==q.PAUSED||d==q.STOPPED||d==q.ERROR)b.play(),g(a)});d.addEventListener(a.PLAYEASE_VIEW_PAUSE,
function(a){var d=c.getState();if(d==q.BUFFERING||d==q.PLAYING||d==q.ERROR)b.pause(),g(a)});d.addEventListener(a.PLAYEASE_VIEW_SEEK,function(a){c.getState()!=q.SEEKING&&(b.seek(a.time),g(a))});d.addEventListener(a.PLAYEASE_VIEW_STOP,function(a){b.stop();g(a)});d.addEventListener(a.PLAYEASE_VIEW_VOLUNE,function(a){b.volume(a.vol);g(a)});d.addEventListener(a.PLAYEASE_VIEW_FULLSCREEN,function(a){b.fullscreen(a.esc);g(a)});d.addEventListener(a.PLAYEASE_RENDER_ERROR,function(a){c.setState(q.ERROR);g(a)});
b.play=d.render.play;b.pause=d.render.pause;b.seek=d.render.seek;b.stop=d.render.stop;b.volume=d.render.volume;b.mute=d.render.mute;b.fullscreen=d.render.fullscreen}})(playease);
(function(c){var f=c.utils,a=c.events,q=c.embed=function(h){function d(b){switch(b.type){case a.ERROR:case a.PLAYEASE_SETUP_ERROR:case a.PLAYEASE_RENDER_ERROR:case a.PLAYEASE_ERROR:g.errorScreen(b.message);g.dispatchEvent(a.ERROR,b);break;default:g.dispatchEvent(b.type,b)}}var g=f.extend(this,new a.eventdispatcher("embed")),b={},e=!1,m=null;g.embed=function(){try{b=new q.config(h.config),m=new q.embedder(h,b)}catch(l){f.log("Failed to init embedder!");g.dispatchEvent(a.PLAYEASE_SETUP_ERROR,{message:"Failed to init embedder!",
render:b.render.name});return}m.addGlobalListener(d);m.embed()};g.errorScreen=function(a){e||(e=!0,c.api.displayError(a,b))};(function(){f.foreach(h.config.events,function(a,b){a=h[a];"function"===f.typeOf(a)&&a.call(h,b)})})()}})(playease);
(function(c){var f=c.utils,a=c.embed,q=c.core.renders.modes,h=c.core.skins.modes;a.config=function(a){return f.extend({},{url:"http://"+window.location.host+"/vod/sample.mp4",width:640,height:360,cors:"no-cors",bufferTime:.1,controls:!0,autoplay:!0,poster:null,render:{name:q.DEFAULT},skin:{name:h.DEFAULT}},a)};a.config.addConfig=function(a,c){return f.extend(a,c)}})(playease);
(function(c){var f=c.utils,a=c.events,q=c.core;c.embed.embedder=function(c,d){function g(a){b.dispatchEvent(a.type,a)}var b=f.extend(this,new a.eventdispatcher("embed.embedder"));b.embed=function(){var a=new q.entity(d);a.addGlobalListener(g);a.setup();c.setEntity(a,d.render.name)}}})(playease);