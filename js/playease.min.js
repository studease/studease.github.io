playease=function(){if(playease.api)return playease.api.getInstance.apply(this,arguments)};playease.version="1.0.07";
(function(c){var e=c.utils={};e.exists=function(a){switch(e.typeOf(a)){case "string":return 0<a.length;case "object":return null!==a;case "null":return!1}return!0};e.extend=function(){var a=Array.prototype.slice.call(arguments,0),g=a[0];if(1<a.length)for(var b=1;b<a.length;b++)e.foreach(a[b],function(a,d){void 0!==d&&null!==d&&(g[a]=d)});return g};e.foreach=function(a,g){for(var b in a)a.hasOwnProperty&&"function"===e.typeOf(a.hasOwnProperty)?a.hasOwnProperty(b)&&g(b,a[b]):g(b,a[b])};e.getCookie=
function(a){var g;return(g=document.cookie.match(new RegExp("(^| )"+a+"=([^;]*)(;|$)")))?unescape(g[2]):null};e.formatTime=function(a){var g=a.getHours()+1,b=a.getMinutes(),f=a.getSeconds();return a.toLocaleDateString()+" "+e.pad(g,2)+":"+e.pad(b,2)+":"+e.pad(f,2)};e.pad=function(a,g){for(a+="";a.length<g;)a="0"+a;return a};e.createElement=function(a,g){a=document.createElement(a);g&&(a.className=g);return a};e.addClass=function(a,g){var b="string"===e.typeOf(a.className)?a.className.split(" "):[];
g="array"===e.typeOf(g)?g:g.split(" ");e.foreach(g,function(a,d){-1===e.indexOf(b,d)&&b.push(d)});a.className=e.trim(b.join(" "))};e.removeClass=function(a,g){var b="string"===e.typeOf(a.className)?a.className.split(" "):[];g="array"===e.typeOf(g)?g:g.split(" ");e.foreach(g,function(a,d){a=e.indexOf(b,d);0<=a&&b.splice(a,1)});a.className=e.trim(b.join(" "))};e.emptyElement=function(a){for(;a.firstChild;)a.removeChild(a.firstChild)};e.typeOf=function(a){if(null===a||void 0===a)return"null";var g=typeof a;
if("object"===g)try{if("[object Array]"===toString.call(a))return"array"}catch(b){}return g};e.trim=function(a){return a.replace(/^\s+|\s+$/g,"")};e.indexOf=function(a,g){if(null==a)return-1;for(var b=0;b<a.length;b++)if(a[b]===g)return b;return-1};e.isMSIE=function(a){return a?(a=parseFloat(a).toFixed(1),a=new RegExp("msie\\s*"+a,"i"),null!==navigator.userAgent.toLowerCase().match(a)):null!==navigator.userAgent.toLowerCase().match(/msie/i)};var a=window.console=window.console||{log:function(){}};
e.log=function(){var c=Array.prototype.slice.call(arguments,0);"object"===e.typeOf(a.log)?a.log(c):a.log.apply(a,c)}})(playease);(function(c){c=c.utils;c.littleEndian=function(){var e=new ArrayBuffer(2);(new DataView(e)).setInt16(0,256,!0);return 256===(new Int16Array(e))[0]}();c.getUint32=function(e,a,c){void 0==a&&(a=0);return c?e[a+0]|e[a+1]>>>8|e[a+2]>>>16|e[a+3]>>>24:e[a+0]<<24|e[a+1]<<16|e[a+2]<<8|e[a+3]}})(playease);
(function(c){function e(){var a=document.createElement("style");a.type="text/css";document.getElementsByTagName("head")[0].appendChild(a);return a.sheet||a.styleSheet}var a=c.utils,m;(a.css=function(g,b){m||(m=e());var f="";a.foreach(b,function(a,b){f+=a+": "+b+"; "});try{m.insertRule?m.insertRule(g+" { "+f+"}",m.cssRules.length):m.addRule(g,f,m.rules.length)}catch(d){a.log("Failed to insert css rule: "+g)}}).style=function(g,b,f){if(void 0!==g&&null!==g)for(void 0===g.length&&(g=[g]),b=a.extend({},
b),f=0;f<g.length;f++){var d=g[f];void 0!==d&&null!==d&&a.foreach(b,function(a,b){a=a.split("-");for(var f=1;f<a.length;f++)a[f]=a[f].charAt(0).toUpperCase()+a[f].slice(1);a=a.join("");d.style[a]!==b&&(d.style[a]=b)})}}})(playease);
(function(c){c.events={ERROR:"error",PLAYEASE_READY:"playeaseReady",PLAYEASE_SETUP_ERROR:"playeaseSetupError",PLAYEASE_RENDER_ERROR:"playeaseRenderError",PLAYEASE_STATE:"playeaseState",CHATEASE_PROPERTY:"chateaseProperty",PLAYEASE_METADATA:"playeaseMetaData",PLAYEASE_BUFFER:"playeaseBuffer",PLAYEASE_PLAY:"playeasePlay",PLAYEASE_PAUSE:"playeasePause",PLAYEASE_SEEK:"playeaseSeek",PLAYEASE_STOP:"playeaseStop",PLAYEASE_VIEW_PLAY:"playeaseViewPlay",PLAYEASE_VIEW_PAUSE:"playeaseViewPause",PLAYEASE_VIEW_SEEK:"playeaseViewSeek",
PLAYEASE_VIEW_STOP:"playeaseViewStop",PLAYEASE_VIEW_VOLUME:"playeaseViewVolume",PLAYEASE_VIEW_MUTE:"playeaseViewMute",PLAYEASE_VIEW_FULLSCREEN:"playeaseViewFullscreen",PLAYEASE_CONTENT_LENGTH:"playeaseContentLength",PLAYEASE_PROGRESS:"playeaseProgress",PLAYEASE_COMPLETE:"playeaseComplete",PLAYEASE_FLV_TAG:"playeaseFlvTag",PLAYEASE_AVC_CONFIG_RECORD:"playeaseAVCConfigRecord",PLAYEASE_AVC_SAMPLE:"playeaseAVCSample",PLAYEASE_AAC_SPECIFIC_CONFIG:"playeaseAACSpecificConfig",PLAYEASE_AAC_SAMPLE:"playeaseAACSample",
PLAYEASE_MP4_INIT_SEGMENT:"playeaseMp4InitSegment",PLAYEASE_MP4_SEGMENT:"playeaseMp4Segment",PLAYEASE_END_OF_STREAM:"playeaseEndOfStream"}})(playease);
(function(c){var e=c.utils;c.events.eventdispatcher=function(a){function m(a,d,b){if(a)for(var f=0;f<a.length;f++){var g=a[f];if(g){null!==g.count&&0===--g.count&&delete a[f];try{g.listener(d)}catch(B){e.log('Error handling "'+b+'" event listener ['+f+"]: "+B.toString(),g.listener,d)}}}}var g={},b=[];this.addEventListener=function(a,d,b){try{e.exists(g[a])||(g[a]=[]),"string"===e.typeOf(d)&&(d=(new Function("return "+d))()),g[a].push({listener:d,count:b||null})}catch(n){e.log("error",n)}return!1};
this.removeEventListener=function(a,d){if(g[a]){try{if(void 0===d){g[a]=[];return}var b;for(b=0;b<g[a].length;b++)if(g[a][b].listener.toString()===d.toString()){g[a].splice(b,1);break}}catch(n){e.log("error",n)}return!1}};this.addGlobalListener=function(a,d){try{"string"===e.typeOf(a)&&(a=(new Function("return "+a))()),b.push({listener:a,count:d||null})}catch(k){e.log("error",k)}return!1};this.removeGlobalListener=function(a){if(a){try{var d;for(d=b.length-1;0<=d;d--)b[d].listener.toString()===a.toString()&&
b.splice(d,1)}catch(k){e.log("error",k)}return!1}};this.dispatchEvent=function(f,d){d||(d={});e.extend(d,{id:a,version:c.version,type:f});c.debug&&e.log(f,d);m(g[f],d,f);m(b,d,f)}}})(playease);
(function(c){var e=c.utils,a=c.events;e.loader=function(c){var g=e.extend(this,new a.eventdispatcher("utils.loader")),b={method:"GET",headers:{},mode:"cors",cache:"default"},f,d;g.load=function(b){f=b;fetch?fetch(f,g.config).then(function(b){if(d)d=!1;else{if(b.ok&&200<=b.status&&299>=b.status){var f=b.headers.get("Content-Length");f&&(f=parseInt(f),g.dispatchEvent(a.PLAYEASE_CONTENT_LENGTH,{length:f}));return g.pump(b.body.getReader())}g.dispatchEvent(a.ERROR,{message:"Loader error: Invalid http status("+
b.status+" "+b.statusText+")."})}}).catch(function(b){g.dispatchEvent(a.ERROR,{message:"Loader error: "+b.message})}):g.dispatchEvent(a.ERROR,{message:"Loader error: Fetch is not supported."})};g.pump=function(b){return b.read().then(function(f){if(f.done)g.dispatchEvent(a.PLAYEASE_COMPLETE);else{if(d)return d=!1,b.cancel();g.dispatchEvent(a.PLAYEASE_PROGRESS,{data:f.value.buffer});return g.pump(b)}}).catch(function(b){g.dispatchEvent(a.ERROR,{message:"Loader error: Failed to read response data."})})};
g.abort=function(){d=!0};(function(){g.config=e.extend({},b,c);var a=new Headers,f;for(f in g.config.headers)a.append(f,g.config.headers[f]);g.config.headers=a;d=!1})()}})(playease);
(function(c){var e=c.utils,a=c.events,m={},g={onError:a.ERROR,onReady:a.PLAYEASE_READY,onMetaData:a.PLAYEASE_METADATA,onBuffer:a.PLAYEASE_BUFFER,onPlay:a.PLAYEASE_PLAY,onPause:a.PLAYEASE_PAUSE,onSeek:a.PLAYEASE_SEEK,onStop:a.PLAYEASE_STOP,onVolume:a.PLAYEASE_VIEW_VOLUME,onMute:a.PLAYEASE_VIEW_MUTE,onFullscreen:a.PLAYEASE_VIEW_FULLSCREEN};c.api=function(b){function f(a){d.dispatchEvent(a.type,a)}var d=e.extend(this,new a.eventdispatcher("api")),k;d.container=b;d.id=b.id;d.setup=function(a){e.emptyElement(d.container);
c.debug=!!a.debug;d.config=a;d.config.id=d.id;d.embedder=new c.embed(d);d.embedder.addGlobalListener(f);d.embedder.embed();return d};d.setEntity=function(a,b){k=a;d.renderName=b;d.play=k.play;d.pause=k.pause;d.seek=k.seek;d.stop=k.stop;d.volume=k.volume;d.mute=k.mute;d.fullscreen=k.fullscreen;d.resize=k.resize};(function(){e.foreach(g,function(a,b){d[a]=function(a){d.addEventListener(b,a)}})})()};c.api.getInstance=function(a){var b;null==a?a=0:a.nodeType?b=a:"string"===e.typeOf(a)&&(b=document.getElementById(a));
if(b){var d=m[b.id];d||(m[a]=d=new c.api(b));return d}return"number"===e.typeOf(a)?m[a]:null};c.api.displayError=function(a,g){}})(playease);(function(c){c.muxer={}})(playease);
(function(c){var e=c.utils,a=c.muxer.AMF={},m=a.types={DOUBLE:0,BOOLEAN:1,STRING:2,OBJECT:3,MOVIE_CLIP:4,NULL:5,UNDEFINED:6,REFERENCE:7,MIXED_ARRAY:8,END_OF_OBJECT:9,ARRAY:10,DATE:11,LONG_STRING:12,UNSUPPORTED:13,RECORD_SET:14,XML:15,TYPED_OBJECT:16,AMF3_DATA:17};a.parse=function(g,b,f){var d={};try{var k=a.parseValue(g,b,f),c=a.parseValue(g,b+k.size,f-k.size);d.key=k.data;d.value=c.data}catch(l){e.log("AMF.parse() failed. Error: "+l)}return d};a.parseObject=function(g,b,f){if(3>f)throw"Data not enough while parsing AMF object.";
for(var d={},e=0,c,l={ended:!1};!l.ended&&e<f;)c=a.parseString(g,b+e,f-e),e+=c.size,l=a.parseValue(g,b+e,f-e),e+=l.size,c.data&&l.data&&(d[c.data]=l.data);return{data:d,size:e,ended:l.ended}};a.parseString=function(a,b,e){if(2>e)throw"Data not enough while parsing AMF string.";var d=0;e=(new DataView(a,b,e)).getUint16(d);d+=2;return{data:0<e?String.fromCharCode.apply(String,new Uint8Array(a,b+d,e)):"",size:d+e}};a.parseLongString=function(a,b,e){if(4>e)throw"Data not enough while parsing AMF long string.";
var d=0;e=(new DataView(a,b,e)).getUint32(d);d+=4;return{data:0<e?String.fromCharCode.apply(String,new Uint8Array(a,b+d,e)):"",size:d+e}};a.parseDate=function(a,b,e){if(10>e)throw"Data not enough while parsing AMF date.";e=new DataView(a,b,e);a=0;b=e.getFloat64(a);a+=8;e=e.getInt16(a);return{data:new Date(b+6E4*e),size:a+2}};a.parseValue=function(g,b,c){if(1>c)throw"Data not enough while parsing AMF value.";var d=new DataView(g,b,c),f=0,n=d.getUint8(f),f=f+1,l=void 0,B=!1;try{switch(n){case m.DOUBLE:l=
d.getFloat64(f);f+=8;break;case m.BOOLEAN:l=d.getUint8(f)?!0:!1;f+=1;break;case m.STRING:var w=a.parseString(g,b+f,c-f),l=w.data,f=f+w.size;break;case m.OBJECT:var q=a.parseObject(g,b+f,c-f),l=q.data,f=f+q.size;break;case m.MIXED_ARRAY:var A;d.getUint32(f);var f=f+4,G=a.parseObject(g,b+f,c-f),l=G.data,f=f+G.size;break;case m.END_OF_OBJECT:l=void 0;B=!0;break;case m.ARRAY:A=d.getUint32(f);f+=4;l=[];for(d=0;d<A;d++){var z=a.parseValue(g,b+f,c-f);l.push(z.data);f+=z.size}break;case m.DATE:var h=a.parseDate(g,
b+f,c-f),l=h.data,f=f+h.size;break;case m.LONG_STRING:var t=a.parseString(g,b+f,c-f),l=t.data,f=f+t.size;break;default:e.log("Skipping unsupported AMF value type("+n+")."),f+=c}}catch(r){e.log("AMF.parseValue() failed. Error: "+r)}return{data:l,size:f,ended:B}}})(playease);
(function(c){var e=function(a){function e(){var a=k-d;if(0>=a)throw"Data not enough while filling current word.";var a=Math.min(4,a),b=new Uint8Array(4);b.set(f.subarray(d,d+a));n=(new DataView(b.buffer)).getUint32(0,!1);d+=a;l=8*a}function c(){var a;for(a=0;a<l;a++)if(0!==(n&2147483648>>>a))return n<<=a,l-=a,a;e();return a+c()}var b=this,f,d,k,n,l;b.readBits=function(a){if(32<a)throw"Data not enough while reading bits of ExpGolomb.";if(a<=l){var b=n>>>32-a;n<<=a;l-=a;return b}b=l?n:0;b>>>=32-l;a-=
l;e();a=Math.min(a,l);var d=n>>>32-a;n<<=a;l-=a;return b<<a|d};b.readBool=function(){return 1===b.readBits(1)};b.readByte=function(){return b.readBits(8)};b.readUEG=function(){var a=c();return b.readBits(a+1)-1};b.readSEG=function(){var a=b.readUEG();return a&1?a+1>>>1:-1*(a>>>1)};b.destroy=function(){f=null};f=a;d=0;k=a.byteLength;l=n=0};(c.muxer.SPS={}).parse=function(a){for(var c=a.byteLength,g=new Uint8Array(c),b=0,f=0;f<c;f++)2<=f&&3===a[f]&&0===a[f-1]&&0===a[f-2]||(g[b]=a[f],b++);a=new Uint8Array(g.buffer,
0,b);a=new e(a);a.readByte();var d=a.readByte();a.readByte();g=a.readByte();a.readUEG();switch(d){case 66:c="Baseline";break;case 77:c="Main";break;case 88:c="Extended";break;case 100:c="High";break;case 110:c="High10";break;case 122:c="High422";break;case 244:c="High444";break;default:c="Unknown"}var g=(g/10).toFixed(1),k=1,b=420,n=[0,420,422,444],f=8;if(100===d||110===d||122===d||244===d||44===d||83===d||86===d||118===d||128===d||138===d||144===d)if(k=a.readUEG(),3===k&&a.readBits(1),3>=k&&(b=n[k]),
f=a.readUEG()+8,a.readUEG(),a.readBits(1),a.readBool())for(d=3!==k?8:12,n=0;n<d;n++)if(a.readBool())for(var l=a,B=6>n?16:64,w=8,q=8,A=0;A<B;A++)0!==q&&(q=l.readSEG(),q=(w+q+256)%256),w=0===q?w:q;a.readUEG();d=a.readUEG();if(0===d)a.readUEG();else if(1===d)for(a.readBits(1),a.readSEG(),a.readSEG(),d=a.readUEG(),n=0;n<d;n++)a.readSEG();a.readUEG();a.readBits(1);var G=a.readUEG(),q=a.readUEG(),z=a.readBits(1);0===z&&a.readBits(1);a.readBits(1);var h=0,t=0,r=0,u=0;a.readBool()&&(h=a.readUEG(),t=a.readUEG(),
r=a.readUEG(),u=a.readUEG());n=d=1;w=0;l=!0;A=B=0;if(a.readBool()){if(a.readBool()){var C=a.readByte(),E=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],y=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];0<C&&16>C?(d=E[C-1],n=y[C-1]):255===C&&(d=a.readByte()<<8|a.readByte(),n=a.readByte()<<8|a.readByte())}a.readBool()&&a.readBool();a.readBool()&&(a.readBits(4),a.readBool()&&a.readBits(24));a.readBool()&&(a.readUEG(),a.readUEG());a.readBool()&&(w=a.readBits(32),B=a.readBits(32),l=a.readBool(),A=2*w,w=
B/A)}C=1;if(1!==d||1!==n)C=d/n;0===k?(E=1,k=2-z):(E=3===k?1:2,k=(1===k?2:1)*(2-z));G=16*(G+1)-(h+t)*E;k=16*(2-z)*(q+1)-(r+u)*k;q=Math.ceil(G*C);a.destroy();switch(b){case 420:a="4:2:0";break;case 422:a="4:2:2";break;case 444:a="4:4:4";break;default:a="Unknown"}return{profile_string:c,level_string:g,bit_depth:f,chroma_format:b,chroma_format_string:a,frame_rate:{fixed:l,fps:w,fps_den:A,fps_num:B},sar_ratio:{width:d,height:n},codec_size:{width:G,height:k},present_size:{width:q,height:k}}}})(playease);
(function(c){var e=c.utils,a=c.events;c=c.muxer;var m=c.SPS,g={AUDIO:8,VIDEO:9,SCRIPT:18},b={KEYFRAME:1,INTER_FRAME:2,DISPOSABLE_INTER_FRAME:3,GENERATED_KEYFRAME:4,INFO_OR_COMMAND_FRAME:5},f={types:{SEQUENCE_HEADER:0,NALU:1,END_OF_SEQUENCE:2}},d={types:{SPECIFIC_CONFIG:0,RAW_FRAME_DATA:1},audioObjectTypes:{NULL:0,AAC_MAIN:1,AAC_LC:2,AAC_SSR:3,AAC_LTP:4,AAC_HE_OR_SBR:5,AAC_SCALABLE:6},samplingRates:[96E3,88200,64E3,48E3,44100,32E3,24E3,22050,16E3,12E3,11025,8E3,7350]},k=[5500,11025,22050,44100],n=
function(){var a=this;a.isComplete=function(){var b=!1===a.hasAudio||!0===a.hasAudio&&null!=a.audioCodec&&null!=a.audioSampleRate&&null!=a.audioChannelCount,d=!1===a.hasVideo||!0===a.hasVideo&&null!=a.videoCodec&&null!=a.width&&null!=a.height&&null!=a.fps&&null!=a.profile&&null!=a.level&&null!=a.chromaFormat&&null!=a.sarNum&&null!=a.sarDen;return null!=a.mimeType&&null!=a.duration&&null!=a.metadata&&null!=a.hasKeyframesIndex&&b&&d};a.isSeekable=function(){return!0===a.hasKeyframesIndex};a.getNearestKeyframe=
function(b){if(null==a.keyframesIndex)return null;var d=a.keyframesIndex,e=d.times,f=0,c=e.length-1,g,h=0,k=c;b<e[0]&&(f=0,h=k+1);for(;h<=k;)if(g=h+Math.floor((k-h)/2),g===c||b>=e[g]&&b<e[g+1]){f=g;break}else e[g]<b?h=g+1:k=g-1;b=f;return{index:b,milliseconds:d.times[b],fileposition:d.filepositions[b]}}};c.flv=function(c){var l=e.extend(this,new a.eventdispatcher("muxer.flv")),w,q,A,G,z,h,t,r,u,C,E,y,J,M,v,p,x,R;l.parse=function(b){var d=new Uint8Array(b),f=0;if(1==A){if(13>b.byteLength)return 0;
f=l.probe(b);A=4;var c=e.getUint32(d,f);c&&e.log("First tag size "+c);f+=4;A=2}for(;f<b.byteLength;)switch(A){case 2:r[h.position++]=d[f++];11==h.position&&(C=r[1]<<16|r[2]<<8|r[3],A=3);break;case 3:var p=r[0],x=r[1]<<16|r[2]<<8|r[3],F=r[4]<<16|r[5]<<8|r[6]|r[7]<<24,c=r[8]<<16|r[9]<<8|r[10];0!=c&&e.log("Unknown stream ID "+c);c={tag:p,data:b,offset:f,size:x};switch(p){case g.AUDIO:c.timestamp=F;C==x&&(c.format=d[f]>>>4,c.rate=k[(d[f]&12)>>>2],c.samplesize=(d[f]&2)>>>1,c.sampletype=d[f]&1);break;case g.VIDEO:c.timestamp=
F;C==x&&(c.frametype=d[f]>>>4,c.codec=d[f]&15);break;case g.SCRIPT:c.hasAudio=G,c.hasVideo=z}p=Math.min(b.byteLength-f,C);C-=p;f+=p;if(C){E.push(c);break}if(E.length){c=E[0];x=new Uint8Array(x);for(x.position=0;E.length;)F=E.shift(),p=new Uint8Array(F.data.slice(F.offset)),x.set(p,x.position),x.position+=F.data.byteLength-F.offset;p=new Uint8Array(b.slice(0,f));x.set(p,x.position);c.data=x.buffer;c.offset=0}A=4;t.position=0;l.dispatchEvent(a.PLAYEASE_FLV_TAG,c);break;case 4:u[t.position++]=d[f++];
4==t.position&&(x=r[1]<<16|r[2]<<8|r[3],c=e.getUint32(u),c!=11+x&&e.log("prevTagSize("+c+") is not equals to "+(11+x)+"."),A=2,h.position=0);break;default:e.log("Unknown parsing state "+A);return}};l.parseAVCVideoPacket=function(d,c,p,g,h){if(5>p)l.dispatchEvent(a.ERROR,{message:"Data not enough while parsing AVC video packet."});else{var F=new DataView(d,c,p),k=1,u=F.getUint8(k++),F=F.getUint8(k++)<<16|F.getUint8(k++)<<8|F.getUint8(k++);switch(u){case f.types.SEQUENCE_HEADER:F=c+k;c=p-k;if(7>c)l.dispatchEvent(a.ERROR,
{message:"Data not enough while parsing AVC decoder configuration record."});else if(p=v,p={type:p.type,id:p.id,timescale:1E3,duration:1E3*J.duration||0},k=new DataView(d,F,c),u=0,h=k.getUint8(u++),g=k.getUint8(u++),k.getUint8(u++),k.getUint8(u++),1!=h||0==g)l.dispatchEvent(a.ERROR,{message:"Invalid AVCDecoderConfigurationRecord."});else if(x=1+(k.getUint8(u++)&3),3!=x&&4!=x)l.dispatchEvent(a.ERROR,{message:"Invalid lengthSizeMinusOne "+x+"."});else{g=k.getUint8(u++)&31;for(h=0;h<g;h++){var r=k.getUint16(u),
u=u+2;if(0!=r){var L=new Uint8Array(d,F+u,r),u=u+r,r=m.parse(L),D=p,H=r;D.codecWidth=H.codec_size.width;D.codecHeight=H.codec_size.height;D.presentWidth=H.present_size.width;D.presentHeight=H.present_size.height;D.profile=H.profile_string;D.level=H.level_string;D.bitDepth=H.bit_depth;D.chromaFormat=H.chroma_format;D.sarRatio=H.sar_ratio;D.frameRate=H.frame_rate;if(!1===H.frame_rate.fixed||0===H.frame_rate.fps_num||0===H.frame_rate.fps_den)D.frameRate=M;D.refSampleDuration=Math.floor(D.frameRate.fps_den/
D.frameRate.fps_num*D.timescale);for(var L=L.subarray(1,4),H="avc1.",q=0;3>q;q++){var N=L[q].toString(16);2>N.length&&(N="0"+N);H+=N}D.codec=H;D=p;y.hasAudio=G;y.hasVideo=z;y.duration=1E3*J.duration;y.metadata=J;y.width=D.codecWidth;y.height=D.codecHeight;y.fps=D.frameRate.fps;y.profile=D.profile;y.level=D.level;y.chromaFormat=r.chroma_format_string;y.sarNum=D.sarRatio.width;y.sarDen=D.sarRatio.height;y.videoCodec=D.codec;y.mimeType='video/mp4; codecs="'+y.videoCodec+(y.hasAudio&&y.audioCodec?","+
y.audioCodec:"")+'"';l.dispatchEvent(a.PLAYEASE_MEDIA_INFO,{info:y})}}g=k.getUint8(u++);for(h=0;h<g;h++)r=k.getUint16(u),u+=2,0!=r&&(new Uint8Array(d,F+u,r),u+=r);p.avcc=new Uint8Array(c);p.avcc.set(new Uint8Array(d,F,c),0);l.dispatchEvent(a.PLAYEASE_AVC_CONFIG_RECORD,{data:p})}break;case f.types.NALU:a:{c+=k;p-=k;k=new DataView(d,c,p);u=[];g=R+g;h=h==b.KEYFRAME;for(D=r=0;r<p;){if(r+4>=p){l.dispatchEvent(a.ERROR,{message:"Data not enough for next NALU."});break a}L=k.getUint32(r);3==L&&(L>>>=8);if(L>
p-x){e.log("Malformed Nalus near timestamp "+g+".");break a}H=k.getUint8(r+x)&31;H==b.INFO_OR_COMMAND_FRAME&&(h=!0);q=new Uint8Array(d,c+r,x+L);D+=q.byteLength;u.push({type:H,data:q});r+=x+L}0!=u.length&&(v.samples.push({units:u,length:D,isKeyframe:h,cts:F,dts:g,pts:F+g}),v.length+=D,l.dispatchEvent(a.PLAYEASE_AVC_SAMPLE,{data:v}))}break;case f.types.END_OF_SEQUENCE:l.dispatchEvent(a.PLAYEASE_END_OF_STREAM);break;default:l.dispatchEvent(a.ERROR,{message:"Unknown AVC video packet type "+u+"."})}}};
l.parseAACAudioPacket=function(b,c,e,f,g,h,x){if(2>e)l.dispatchEvent(a.ERROR,{message:"Data not enough while parsing AAC audio packet."});else{h=1;var k=(new DataView(b,c,e)).getUint8(h++);switch(k){case d.types.SPECIFIC_CONFIG:f=c+h;c=e-h;3>c?l.dispatchEvent(a.ERROR,{message:"Data not enough while parsing AAC audio specific config."}):(e=p,e={type:e.type,id:e.id,timescale:1E3,duration:1E3*J.duration||0},e.audioSampleRate=g,e.channelCount=0===x?1:2,e.refSampleDuration=Math.floor(1024/e.audioSampleRate*
e.timescale),e.codec="mp4a.40.5",f=new DataView(b,f,c),c=0,x=f.getUint8(c)>>>3,b=(f.getUint8(c++)&7)<<1|f.getUint8(c)>>>7,0>b||b>=d.samplingRates.length?l.dispatchEvent(a.ERROR,{message:"Invalid AAC sampling frequency index.",index:b}):(g=(f.getUint8(c)&120)>>>3,0>g||8<=g?l.dispatchEvent(a.ERROR,{message:"Invalid AAC channel configuration.",config:g}):(x===d.audioObjectTypes.AAC_HE_OR_SBR&&(f.getUint8(c++),f.getUint8(c),f.getUint8(c)),x=self.navigator.userAgent.toLowerCase(),-1!==x.indexOf("firefox")?
b>=d.audioObjectTypes.AAC_SCALABLE?(x=d.audioObjectTypes.AAC_HE_OR_SBR,f=b-3,c=Array(4)):(x=d.audioObjectTypes.AAC_LC,f=b,c=Array(2)):-1!==x.indexOf("android")?(x=d.audioObjectTypes.AAC_LC,f=b,c=Array(2)):(x=d.audioObjectTypes.AAC_HE_OR_SBR,f=b,c=Array(4),b>=d.audioObjectTypes.AAC_SCALABLE?f=b-3:1===g&&(x=2,f=b,c=Array(2))),c[0]=x<<3,c[0]|=(b&15)>>>1,c[1]=(b&15)<<7,c[1]|=(g&15)<<3,x===d.audioObjectTypes.AAC_HE_OR_SBR&&(c[1]|=(f&15)>>>1,c[2]=(f&1)<<7,c[2]|=8,c[3]=0),e.codec="mp4a.40."+x,e.config=c,
y.audioCodec=e.codec,y.audioSampleRate=e.audioSampleRate,y.audioChannelCount=e.channelCount,y.mimeType='video/mp4; codecs="'+y.videoCodec+(y.hasAudio&&y.audioCodec?","+y.audioCodec:"")+'"',l.dispatchEvent(a.PLAYEASE_MEDIA_INFO,{info:y}),l.dispatchEvent(a.PLAYEASE_AAC_SPECIFIC_CONFIG,{data:e}))));break;case d.types.RAW_FRAME_DATA:e=new Uint8Array(b,c+h,e-h);b=R+f;p.samples.push({unit:e,dts:b,pts:b});p.length+=e.length;l.dispatchEvent(a.PLAYEASE_AAC_SAMPLE,{data:p});break;default:l.dispatchEvent(a.ERROR,
{message:"Unknown AAC audio packet type "+k+"."})}}};l.probe=function(a){a=new Uint8Array(a);if(70!==a[0]||76!==a[1]||86!==a[2]||1!==a[3])return 0;G=0!==(a[4]&4)>>>2;z=0!==(a[4]&1);if(!G&&!z)return 0;a=e.getUint32(a,5);return 9>a?0:a};l.setMetaData=function(a){J=a;if("number"===typeof J.framerate&&(a=Math.floor(1E3*J.framerate),0<a)){var b=a/1E3;M.fixed=!0;M.fps=b;M.fps_num=a;M.fps_den=1E3;y.fps=b}y.hasKeyframesIndex="object"===typeof J.keyframes?!0:!1};l.getMetaData=function(){return J};l.offset=
function(){return w};l.length=function(){return q};l.destroy=function(){};l.config=e.extend({},{},c);q=w=0;A=1;h=new ArrayBuffer(11);h.position=0;r=new Uint8Array(h);t=new ArrayBuffer(4);t.position=0;u=new Uint8Array(t);C=0;E=[];y=new n;M={fixed:!0,fps:23.976,fps_num:23976,fps_den:1E3};v={type:"video",id:1,sequenceNumber:0,samples:[],length:0};p={type:"audio",id:2,sequenceNumber:0,samples:[],length:0};R=x=0};c.flv.TAG=g;c.flv.FORMATS={LINEAR_PCM_PLATFORM_ENDIAN:0,ADPCM:1,MP3:2,LINEAR_PCM_LITTLE_ENDIAN:3,
NELLYMOSER_16_kHz_MONO:4,NELLYMOSER_8_kHz_MONO:5,NELLYMOSER:6,G_711_A_LAW_LOGARITHMIC_PCM:7,G_711_MU_LAW_LOGARITHMIC_PCM:8,RESERVED:9,AAC:10,SPEEX:11,MP3_8_kHz:14,DEVICE_SPECIFIC_SOUND:15};c.flv.FRAMES=b;c.flv.CODECS={JPEG:1,H263:2,SCREEN_VIDEO:3,VP6:4,VP6_ALPHA:5,SCREEN_VIDEO_2:6,AVC:7};c.flv.AVC=f;c.flv.AAC=d})(playease);
(function(c){var e=c.utils,a=c.events;c=c.muxer;var m=c.flv.AAC,g,b,f,d,k,n,l,B,w;g=new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]);b=new Uint8Array([0,0,0,0,0,0,0,1]);f=new Uint8Array([0,0,0,0,0,0,0,0]);d=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]);k=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]);n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,
108,101,114,0]);l=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]);B=new Uint8Array([0,0,0,0,0,0,0,0]);w=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]);m.getSilentFrame=function(a){return 1===a?new Uint8Array([0,200,0,128,35,128]):2===a?new Uint8Array([33,0,73,144,2,25,0,35,128]):3===a?new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]):4===a?new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]):5===a?new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,
0,33,144,2,56]):6===a?new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]):null};var q=function(a,b,c,d,e){this.dts=a;this.pts=b;this.duration=c;this.originalDts=d;this.isSyncPoint=e;this.fileposition=null},A=function(){var a=[];this.appendSyncPoint=function(b){b.isSyncPoint=!0;a.push(b)}},G=function(a){var b=this,c=[],d=-1;b.searchNearestSegmentBefore=function(a){if(0===c.length)return-2;var b=c.length-1,d,e=0,f=b,g=0;if(a<c[0].originalBeginDts)return-1;for(;e<=
f;){d=e+Math.floor((f-e)/2);if(d===b||a>c[d].lastSample.originalDts&&a<c[d+1].originalBeginDts){g=d;break}c[d].originalBeginDts<a?e=d+1:f=d-1}return g};b.searchNearestSegmentAfter=function(a){return b.searchNearestSegmentBefore(a)+1};b.append=function(a){var e=d,f=0;-1!==e&&e<c.length&&a.originalBeginDts>=c[e].lastSample.originalDts&&(e===c.length-1||e<c.length-1&&a.originalBeginDts<c[e+1].originalBeginDts)?f=e+1:0<c.length&&(f=b.searchNearestSegmentBefore(a.originalBeginDts)+1);d=f;c.splice(f,0,
a)};b.getLastSegmentBefore=function(a){a=b.searchNearestSegmentBefore(a);return 0>a?null:c[a]};b.getLastSampleBefore=function(a){a=b.getLastSegmentBefore(a);return null==a?null:a.lastSample};b.getLastSyncPointBefore=function(a){a=b.searchNearestSegmentBefore(a);for(var d=c[a].syncPoints;0===d.length&&a--;)d=c[a].syncPoints;return 0>=d.length?null:d[d.length-1]};b.isEmpty=function(){return 0===c.length};b.clear=function(){c=[];d=-1}};c.mp4=function(c){var h=e.extend(this,new a.eventdispatcher("muxer.mp4")),
t={islive:!1},r,u,C,z,y,J,M,v={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};h.getInitSegment=function(b){var c=h.box(v.ftyp,g),d=h.moov(b),e=new Uint8Array(c.byteLength+d.byteLength);e.set(c,0);e.set(d,c.byteLength);h.dispatchEvent(a.PLAYEASE_MP4_INIT_SEGMENT,{tp:b.type,data:e})};
h.getVideoSegment=function(b){var c=b.samples,d=void 0,e=-1,f=-1,g;if(c&&0!==c.length){g=0;var p=8+b.length,k=new Uint8Array(p);k[g++]=p>>>24&255;k[g++]=p>>>16&255;k[g++]=p>>>8&255;k[g++]=p&255;k.set(v.mdat,g);g+=4;for(var p=[],l=new A;c.length;){var u=c.shift(),n=u.isKeyframe,m=u.dts- -1;if(void 0==d)if(void 0==r)if(y.isEmpty())d=0;else if(d=y.getLastSampleBefore(m),null!=d){var t=m-(d.originalDts+d.duration);3>=t&&(t=0);d=m-(d.dts+d.duration+t)}else d=0;else d=m-r;var t=m-d,z=u.cts,B=t+z;-1===e&&
(e=t,f=B);for(var w=0;u.units.length;){var N=u.units.shift().data;k.set(N,g);g+=N.byteLength;w+=N.byteLength}N=1<=c.length?c[0].dts- -1-d-t:1<=p.length?p[p.length-1].duration:C.refSampleDuration;if(n){var E=new q(t,B,N,u.dts,!0);E.fileposition=u.fileposition;l.appendSyncPoint(E)}p.push({dts:t,pts:B,cts:z,size:w,isKeyframe:n,duration:N,originalDts:m,flags:{isLeading:0,dependsOn:n?2:1,isDependedOn:n?1:0,hasRedundancy:0,isNonSync:n?0:1}})}u=p[p.length-1];c=u.dts+u.duration;g=u.pts+u.duration;r=c;l.beginDts=
e;l.endDts=c;l.beginPts=f;l.endPts=g;l.originalBeginDts=p[0].originalDts;l.originalEndDts=u.originalDts+u.duration;l.firstSample=new q(p[0].dts,p[0].pts,p[0].duration,p[0].originalDts,p[0].isKeyframe);l.lastSample=new q(u.dts,u.pts,u.duration,u.originalDts,u.isKeyframe);h.config.islive||y.append(l);b.samples=p;b.sequenceNumber++;e=h.moof(b,e);b.samples=[];b.length=0;h.dispatchEvent(a.PLAYEASE_MP4_SEGMENT,{tp:"video",data:_mergeBoxes(e,k),sampleCount:p.length,info:l})}};h.getAudioSegment=function(b){var c=
b.samples,d=void 0,f=-1,g;g=!1;var p=-1;if(c&&0!==c.length){var k=0,l=8+b.length,r=new Uint8Array(l);r[k++]=l>>>24&255;r[k++]=l>>>16&255;r[k++]=l>>>8&255;r[k++]=l&255;r.set(v.mdat,k);for(var k=k+4,n=[];c.length;){var t=c.shift(),B=t.unit,C=t.dts- -1;if(void 0==d)if(void 0==u)if(J.isEmpty())d=0,M&&!y.isEmpty()&&(g=!0);else if(d=J.getLastSampleBefore(C),null!=d){var w=C-(d.originalDts+d.duration);3>=w&&(w=0);d=C-(d.dts+d.duration+w)}else d=0;else d=C-u;w=C-d;if(g){var E=y.getLastSegmentBefore(C);null!=
E&&E.beginDts<w?(p=w-E.beginDts,w=E.beginDts):g=!1}-1===f&&(f=w);g?(g=!1,c.unshift(t),t=w,B=p,C=m.getSilentFrame(z.channelCount),null==C?(e.log("Cannot generate silent aac frame, channelCount: "+z.channelCount+"."),t=null):t={unit:C,mp4Sample:{dts:t,pts:t,cts:0,size:C.byteLength,duration:B,originalDts:t,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}},null!=t&&(B=t.unit,n.push(t.mp4Sample),k=0,l+=B.byteLength,r=new Uint8Array(l),r[k++]=l>>>24&255,r[k++]=l>>>16&255,r[k++]=l>>>8&255,
r[k++]=l&255,r.set(v.mdat,k),k+=4,r.set(B,k),k+=B.byteLength)):(n.push({dts:w,pts:w,cts:0,size:B.byteLength,duration:1<=c.length?c[0].dts- -1-d-w:1<=n.length?n[n.length-1].duration:z.refSampleDuration,originalDts:C,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}),r.set(B,k),k+=B.byteLength)}p=n[n.length-1];u=g=p.dts+p.duration;c=new A;c.beginDts=f;c.endDts=g;c.beginPts=f;c.endPts=g;c.originalBeginDts=n[0].originalDts;c.originalEndDts=p.originalDts+p.duration;c.firstSample=new q(n[0].dts,
n[0].pts,n[0].duration,n[0].originalDts,!1);c.lastSample=new q(p.dts,p.pts,p.duration,p.originalDts,!1);h.config.islive||J.append(c);b.samples=n;b.sequenceNumber++;f=h.moof(b,f);b.samples=[];b.length=0;h.dispatchEvent(a.PLAYEASE_MP4_SEGMENT,{tp:"audio",data:_mergeBoxes(f,r),sampleCount:n.length,info:c})}};_mergeBoxes=function(a,b){var c=new Uint8Array(a.byteLength+b.byteLength);c.set(a,0);c.set(b,a.byteLength);return c};h.setVideoMeta=function(a){C=a};h.setAudioMeta=function(a){z=a};h.box=function(a){for(var b=
8,c=Array.prototype.slice.call(arguments,1),d=0;d<c.length;d++)b+=c[d].byteLength;var e=new Uint8Array(b),f=0;e[f++]=b>>>24&255;e[f++]=b>>>16&255;e[f++]=b>>>8&255;e[f++]=b&255;e.set(a,f);f+=4;for(d=0;d<c.length;d++)e.set(c[d],f),f+=c[d].byteLength;return e};h.moov=function(a){var b=h.mvhd(a.timescale,a.duration),c=h.trak(a);a=h.mvex(a);return h.box(v.moov,b,c,a)};h.mvhd=function(a,b){return h.box(v.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,a>>>24&255,a>>>16&255,a>>>8&255,a&255,b>>>24&255,b>>>16&
255,b>>>8&255,b&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))};h.trak=function(a){return h.box(v.trak,h.tkhd(a),h.mdia(a))};h.tkhd=function(a){var b=a.id,c=a.duration,d=a.presentWidth;a=a.presentHeight;return h.box(v.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,b>>>24&255,b>>>16&255,b>>>8&255,b&255,0,0,0,0,c>>>24&255,c>>>16&255,c>>>8&255,c&255,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,d>>>8&255,d&255,0,0,a>>>8&255,a&255,0,0]))};h.mdia=function(a){return h.box(v.mdia,h.mdhd(a),h.hdlr(a),h.minf(a))};h.mdhd=function(a){var b=a.timescale;a=a.duration;return h.box(v.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,b>>>24&255,b>>>16&255,b>>>8&255,b&255,a>>>24&255,a>>>16&255,a>>>8&255,a&255,85,196,0,0]))};h.hdlr=function(a){return h.box(v.hdlr,"audio"===a.type?n:k)};h.minf=function(a){var b;b="audio"===a.type?
h.box(v.smhd,B):h.box(v.vmhd,w);return h.box(v.minf,b,h.dinf(),h.stbl(a))};h.dinf=function(){return h.box(v.dinf,h.box(v.dref,l))};h.stbl=function(a){return h.box(v.stbl,h.stsd(a),h.box(v.stts,f),h.box(v.stsc,f),h.box(v.stsz,d),h.box(v.stco,f))};h.stsd=function(a){return"audio"===a.type?h.box(v.stsd,b,h.mp4a(a)):h.box(v.stsd,b,h.avc1(a))};h.mp4a=function(a){var b=a.audioSampleRate,b=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,a.channelCount,0,16,0,0,0,0,b>>>8&255,b&255,0,0]);return h.box(v.mp4a,
b,h.esds(a))};h.esds=function(a){a=a.config;var b=a.length;a=new Uint8Array([0,0,0,0,3,23+b,0,1,0,4,15+b,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([b]).concat(a).concat([6,1,2]));return h.box(v.esds,a)};h.avc1=function(a){var b=a.avcc,c=a.codecWidth;a=a.codecHeight;c=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,c>>>8&255,c&255,a>>>8&255,a&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return h.box(v.avc1,
c,h.box(v.avcC,b))};h.mvex=function(a){return h.box(v.mvex,h.trex(a))};h.trex=function(a){a=a.id;a=new Uint8Array([0,0,0,0,a>>>24&255,a>>>16&255,a>>>8&255,a&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return h.box(v.trex,a)};h.moof=function(a,b){return h.box(v.moof,h.mfhd(a.sequenceNumber),h.traf(a,b))};h.mfhd=function(a){a=new Uint8Array([0,0,0,0,a>>>24&255,a>>>16&255,a>>>8&255,a&255]);return h.box(v.mfhd,a)};h.traf=function(a,b){var c=a.id,c=h.box(v.tfhd,new Uint8Array([0,0,0,0,c>>>24&255,c>>>16&255,
c>>>8&255,c&255]));b=h.box(v.tfdt,new Uint8Array([0,0,0,0,b>>>24&255,b>>>16&255,b>>>8&255,b&255]));var d=h.sdtp(a);a=h.trun(a,d.byteLength+16+16+8+16+8+8);return h.box(v.traf,c,b,a,d)};h.sdtp=function(a){a=a.samples||[];for(var b=a.length,c=new Uint8Array(4+b),d=0;d<b;d++){var e=a[d].flags;c[d+4]=e.isLeading<<6|e.dependsOn<<4|e.isDependedOn<<2|e.hasRedundancy}return h.box(v.sdtp,c)};h.trun=function(a,b){a=a.samples||[];var c=a.length,d=12+16*c,e=new Uint8Array(d);b+=8+d;e.set([0,0,15,1,c>>>24&255,
c>>>16&255,c>>>8&255,c&255,b>>>24&255,b>>>16&255,b>>>8&255,b&255],0);for(b=0;b<c;b++){var d=a[b].duration,f=a[b].size,g=a[b].flags,k=a[b].cts;e.set([d>>>24&255,d>>>16&255,d>>>8&255,d&255,f>>>24&255,f>>>16&255,f>>>8&255,f&255,g.isLeading<<2|g.dependsOn,g.isDependedOn<<6|g.hasRedundancy<<4|g.isNonSync,0,0,k>>>24&255,k>>>16&255,k>>>8&255,k&255],12+16*b)}return h.box(v.trun,e)};h.mdat=function(a){return h.box(v.mdat,a)};h.destroy=function(){};(function(){h.config=e.extend({},t,c);for(var a in v)v[a]=
[a.charCodeAt(0),a.charCodeAt(1),a.charCodeAt(2),a.charCodeAt(3)];y=new G("video");J=new G("audio");M=!1})()}})(playease);(function(c){c.core={}})(playease);(function(c){c.core.states={BUFFERING:"buffering",PLAYING:"playing",SEEKING:"seeking",PAUSED:"paused",STOPPED:"stopped",ERROR:"error"}})(playease);(function(c){c.core.skins={}})(playease);(function(c){c.core.skins.modes={DEFAULT:"def"}})(playease);
(function(c){var e=c.utils,a=c.events;c=c.core.skins;var m=c.modes,g=e.css,b="pla-skin";c.def=function(c){var d=e.extend(this,new a.eventdispatcher("skins.def")),f=c.height;d.resize=function(a,b){e.log("Resizing to "+a+", "+b);parseInt(a);f=parseInt(b)};d.name=m.DEFAULT;b+="-"+d.name;g(".pla-wrapper",{width:c.width+"px",height:f+"px","box-shadow":"0 1px 1px rgba(0, 0, 0, 0.05)"});g(".pla-wrapper *",{margin:"0",padding:"0","font-family":"\u5fae\u8f6f\u96c5\u9ed1,arial,sans-serif","font-size":"14px",
"font-weight":"normal","box-sizing":"content-box"});g("."+b+" .pla-render",{width:"100%",height:"100%",position:"relative"});g("."+b+" .pla-render video",{})}})(playease);(function(c){c.core.renders={}})(playease);(function(c){c.core.renders.modes={DEFAULT:"def"}})(playease);
(function(c){var e=c.utils,a=c.events;c=c.core.renders;var m=c.modes;c.def=function(c,b){function f(b){A.removeEventListener("play",f);q.dispatchEvent(a.PLAYEASE_VIEW_PLAY)}function d(b){e.log("source open");q.dispatchEvent(a.PLAYEASE_READY,{id:q.config.id})}function g(a){e.log("update end");var b=a.target.type;if(r){if(!z||"open"!==z.readyState)return;if(!t.audio.length&&!t.video.length){z.endOfStream();return}}if(0!=t[b].length&&(a=h[b],!a.updating)){b=t[b].shift();try{a.appendBuffer(b)}catch(E){e.log(E)}}}
function n(a){e.log("source buffer error")}function l(a){e.log("source ended")}function B(a){e.log("source close")}function w(a){e.log("media source error")}var q=e.extend(this,new a.eventdispatcher("renders.def")),A,G,z,h,t,r=!1;q.setup=function(){A.src=window.URL.createObjectURL(z)};q.appendInitSegment=function(b,c){var d=b+'/mp4; codecs="'+G[b+"Codec"]+'"';MediaSource.isTypeSupported(d)?(e.log("Mime type: "+d+"."),"closed"==z.readyState?q.dispatchEvent(a.PLAYEASE_RENDER_ERROR,{message:"MediaSource is closed while appending init segment."}):
(d=h[b]=z.addSourceBuffer(d),d.type=b,d.addEventListener("updateend",g),d.addEventListener("error",n),d.appendBuffer(c))):q.dispatchEvent(a.PLAYEASE_RENDER_ERROR,{message:"Mime type is not surpported: "+d+"."})};q.appendSegment=function(a,b){t[a].push(b);var c=h[a];c.updating||(b=t[a].shift(),c.appendBuffer(b))};q.setMediaInfo=function(a){G=a};q.endOfStream=function(){r=!0};q.display=function(a,b){};q.element=function(){return A};q.resize=function(a,b){};q.destroy=function(){};q.name=m.DEFAULT;q.config=
e.extend({},{},b);h={audio:null,video:null};t={audio:[],video:[]};A=e.createElement("video");A.width=q.config.width;A.height=q.config.height;A.controls=q.config.controls;A.autoplay=q.config.autoplay;A.poster=q.config.poster;q.config.autoplay||A.addEventListener("play",f);window.MediaSource=window.MediaSource||window.WebKitMediaSource;z=new MediaSource;z.addEventListener("sourceopen",d);z.addEventListener("sourceended",l);z.addEventListener("sourceclose",B);z.addEventListener("error",w);z.addEventListener("webkitsourceopen",
d);z.addEventListener("webkitsourceended",l);z.addEventListener("webkitsourceclose",B);z.addEventListener("webkiterror",w)}})(playease);
(function(c){var e=c.utils,a=c.events,m=c.core;m.entity=function(c){var b=e.extend(this,new a.eventdispatcher("core.entity")),f,d,g;b.setup=function(){setTimeout(function(){d.setup()},0)};b.destroy=function(){g&&g.stop();d&&d.destroy();f&&f.destroy()};b.id=c.id;b.model=f=new m.model(c);b.view=d=new m.view(b,f);b.controller=g=new m.controller(f,d);g.addGlobalListener(function(a){b.dispatchEvent(a.type,a)});b.play=g.play;b.pause=g.pause;b.seek=g.seek;b.stop=g.stop;b.volume=g.volume;b.mute=g.mute;b.fullscreen=
g.fullscreen;b.getState=f.getState;b.resize=d.resize}})(playease);
(function(c){var e=c.utils,a=c.events;c=c.core;var m=c.states;c.model=function(c){var b=e.extend(this,new a.eventdispatcher("core.model")),f=m.STOPPED,d;b.setState=function(c){c!==f&&(f=c,b.dispatchEvent(a.PLAYEASE_STATE,{state:c}))};b.getState=function(){return f};b.setProperty=function(c,e){1==d.hasOwnProperty(c)&&(d[c]=e,b.dispatchEvent(a.PLAYEASE_PROPERTY,{key:c,value:e}))};b.getProperty=function(a){return d[a]};b.getConfig=function(a){return b.config[a]||{}};b.destroy=function(){};b.config=e.extend({},
{},c);d={}}})(playease);
(function(c){var e=c.utils,a=c.events;c=c.core;var m=c.renders,g=c.skins;c.view=function(b,c){function d(){var d=e.extend({},c.getConfig("render"),{id:b.id,width:c.config.width,height:c.config.height,controls:c.config.controls,autoplay:c.config.autoplay,poster:c.config.poster});try{t=w.render=new m[d.name](w,d),t.addEventListener(a.PLAYEASE_READY,B),t.addEventListener(a.PLAYEASE_VIEW_PLAY,B),t.addEventListener(a.PLAYEASE_RENDER_ERROR,l)}catch(u){e.log("Failed to init render "+d.name+"!")}t&&A.appendChild(t.element())}
function f(){var a=e.extend({},c.getConfig("skin"),{id:b.id,width:c.config.width,height:c.config.height});try{new g[a.name](a)}catch(u){e.log("Failed to init skin "+a.name+"!")}}function n(a){if(a.ctrlKey||a.metaKey)return!0;if(/13|32/.test(a.keyCode))return a.preventDefault?a.preventDefault():a.returnValue=!1,!1}function l(a){B(a)}function B(a){w.dispatchEvent(a.type,a)}var w=e.extend(this,new a.eventdispatcher("core.view")),q,A,G,z,h,t;w.setup=function(){if(t){t.setup();try{q.addEventListener("keydown",
n)}catch(r){q.attachEvent("onkeydown",n)}}else w.dispatchEvent(a.PLAYEASE_SETUP_ERROR,{message:"Render not available!",name:c.config.render.name})};w.display=function(a,b){t&&t.display(a,b)};w.resize=function(a,b){t&&t.resize(a,b)};w.destroy=function(){if(q)try{q.removeEventListener("keydown",n)}catch(r){q.detachEvent("onkeydown",n)}t&&t.destroy()};(function(){q=e.createElement("div","pla-wrapper pla-skin-"+c.config.skin.name);q.id=b.id;q.tabIndex=0;A=e.createElement("div","pla-render");G=e.createElement("div",
"pla-poster");z=e.createElement("div","pla-controls");h=e.createElement("div","pla-contextmenu");q.appendChild(A);q.appendChild(G);q.appendChild(z);q.appendChild(h);d();f();var a=document.getElementById(b.id);a.parentNode.replaceChild(q,a);window.onresize=function(){"function"==e.typeOf(c.config.onresize)&&c.config.onresize.call(null)}})()}})(playease);
(function(c){var e=c.utils,a=c.events,m=c.core,g=c.muxer,b=m.states,f=g.AMF,d=g.flv.TAG,k=g.flv.FORMATS,n=g.flv.CODECS;m.controller=function(c,m){function l(a){e.log("onContenLength "+a.length)}function q(a){e.log("onLoaderProgress "+a.data.byteLength);K.parse(a.data)}function A(a){e.log("onLoaderComplete")}function B(a){e.log(a.message)}function z(a){e.log("onFlvTag { tag: "+a.tag+", offset: "+a.offset+", size: "+a.size+" }");switch(a.tag){case d.AUDIO:if(a.format&&a.format!=k.AAC){e.log("Unsupported audio format("+
a.format+").");break}K.parseAACAudioPacket(a.data,a.offset,a.size,a.timestamp,a.rate,a.samplesize,a.sampletype);break;case d.VIDEO:if(a.codec&&a.codec!=n.AVC){e.log("Unsupported video codec("+a.codec+").");break}K.parseAVCVideoPacket(a.data,a.offset,a.size,a.timestamp,a.frametype);break;case d.SCRIPT:a=f.parse(a.data,a.offset,a.size);e.log(a.key+": "+JSON.stringify(a.value));"onMetaData"==a.key&&K.setMetaData(a.value);break;default:e.log("Skipping unknown tag type "+a.tag)}}function h(a){m.render.setMediaInfo(a.info)}
function t(a){O.setVideoMeta(a.data);O.getInitSegment(a.data)}function r(a){O.getVideoSegment(a.data)}function u(a){O.setAudioMeta(a.data);O.getInitSegment(a.data)}function C(a){O.getAudioSegment(a.data)}function E(a){m.render.endOfStream()}function y(a){e.log(a.message)}function J(a){m.render.appendInitSegment(a.tp,a.data)}function M(a){m.render.appendSegment(a.tp,a.data)}function v(a){e.log(a.message)}function p(c){switch(c.state){case b.BUFFERING:I.dispatchEvent(a.PLAYEASE_BUFFER);break;case b.PLAYING:I.dispatchEvent(a.PLAYEASE_PLAY);
break;case b.PAUSED:I.dispatchEvent(a.PLAYEASE_PAUSE);break;case b.SEEKING:I.dispatchEvent(a.PLAYEASE_SEEK);break;case b.STOPPED:I.dispatchEvent(a.PLAYEASE_STOP);break;case b.ERROR:break;default:I.dispatchEvent(a.ERROR,{message:"Unknown model state!",state:c.state})}}function x(a){S||(S=!0,P(a),c.config.autoplay&&I.play(),window.onbeforeunload=function(a){})}function R(a){var d=c.getState();if(d==b.PAUSED||d==b.STOPPED||d==b.ERROR)I.play(),P(a)}function F(a){var d=c.getState();if(d==b.BUFFERING||
d==b.PLAYING||d==b.ERROR)I.pause(),P(a)}function L(a){c.getState()!=b.SEEKING&&(I.seek(a.time),P(a))}function H(a){I.stop();P(a)}function D(a){I.volume(a.vol);P(a)}function T(a){I.fullscreen(a.esc);P(a)}function U(a){c.setState(b.ERROR);P(a)}function V(a){c.setState(b.ERROR);P(a)}function P(a){I.dispatchEvent(a.type,a)}var I=e.extend(this,new a.eventdispatcher("core.controller")),S=!1,Q,K,O;I.play=function(){Q.load(c.config.url)};I.pause=function(){};I.seek=function(a){};I.stop=function(){};I.volume=
function(a){};I.mute=function(a){};I.fullscreen=function(a){};(function(){c.addEventListener(a.PLAYEASE_STATE,p);m.addEventListener(a.PLAYEASE_READY,x);m.addEventListener(a.PLAYEASE_SETUP_ERROR,U);m.addEventListener(a.PLAYEASE_VIEW_PLAY,R);m.addEventListener(a.PLAYEASE_VIEW_PAUSE,F);m.addEventListener(a.PLAYEASE_VIEW_SEEK,L);m.addEventListener(a.PLAYEASE_VIEW_STOP,H);m.addEventListener(a.PLAYEASE_VIEW_VOLUNE,D);m.addEventListener(a.PLAYEASE_VIEW_FULLSCREEN,T);m.addEventListener(a.PLAYEASE_RENDER_ERROR,
V);var b={};c.config.cors&&(b.mode=c.config.cors);Q=new e.loader(b);Q.addEventListener(a.PLAYEASE_CONTENT_LENGTH,l);Q.addEventListener(a.PLAYEASE_PROGRESS,q);Q.addEventListener(a.PLAYEASE_COMPLETE,A);Q.addEventListener(a.ERROR,B);K=new g.flv;K.addEventListener(a.PLAYEASE_FLV_TAG,z);K.addEventListener(a.PLAYEASE_MEDIA_INFO,h);K.addEventListener(a.PLAYEASE_AVC_CONFIG_RECORD,t);K.addEventListener(a.PLAYEASE_AVC_SAMPLE,r);K.addEventListener(a.PLAYEASE_AAC_SPECIFIC_CONFIG,u);K.addEventListener(a.PLAYEASE_AAC_SAMPLE,
C);K.addEventListener(a.PLAYEASE_END_OF_STREAM,E);K.addEventListener(a.ERROR,y);O=new g.mp4;O.addEventListener(a.PLAYEASE_MP4_INIT_SEGMENT,J);O.addEventListener(a.PLAYEASE_MP4_SEGMENT,M);O.addEventListener(a.ERROR,v)})()}})(playease);
(function(c){var e=c.utils,a=c.events,m=c.embed=function(g){function b(b){switch(b.type){case a.ERROR:case a.PLAYEASE_SETUP_ERROR:case a.PLAYEASE_RENDER_ERROR:case a.PLAYEASE_ERROR:f.errorScreen(b.message);f.dispatchEvent(a.ERROR,b);break;default:f.dispatchEvent(b.type,b)}}var f=e.extend(this,new a.eventdispatcher("embed")),d={},k=!1,n=null;f.embed=function(){try{d=new m.config(g.config),n=new m.embedder(g,d)}catch(l){e.log("Failed to init embedder!");f.dispatchEvent(a.PLAYEASE_SETUP_ERROR,{message:"Failed to init embedder!",
render:d.render.name});return}n.addGlobalListener(b);n.embed()};f.errorScreen=function(a){k||(k=!0,c.api.displayError(a,d))};(function(){e.foreach(g.config.events,function(a,b){a=g[a];"function"===e.typeOf(a)&&a.call(g,b)})})()}})(playease);
(function(c){var e=c.utils,a=c.embed,m=c.core.renders.modes,g=c.core.skins.modes;a.config=function(a){return e.extend({},{url:"http://"+window.location.host+"/vod/sample.flv",width:640,height:360,cors:"no-cors",bufferTime:.1,controls:!0,autoplay:!0,poster:null,render:{name:m.DEFAULT},skin:{name:g.DEFAULT}},a)};a.config.addConfig=function(a,c){return e.extend(a,c)}})(playease);
(function(c){var e=c.utils,a=c.events,m=c.core;c.embed.embedder=function(c,b){function f(a){d.dispatchEvent(a.type,a)}var d=e.extend(this,new a.eventdispatcher("embed.embedder"));d.embed=function(){var a=new m.entity(b);a.addGlobalListener(f);a.setup();c.setEntity(a,b.render.name)}}})(playease);