playease=function(){if(playease.api)return playease.api.getInstance.apply(this,arguments)};playease.version="1.0.08";
(function(c){var f=c.utils={};f.exists=function(a){switch(f.typeOf(a)){case "string":return 0<a.length;case "object":return null!==a;case "null":return!1}return!0};f.extend=function(){var a=Array.prototype.slice.call(arguments,0),h=a[0];if(1<a.length)for(var d=1;d<a.length;d++)f.foreach(a[d],function(a,b){void 0!==b&&null!==b&&(h[a]=b)});return h};f.foreach=function(a,h){for(var d in a)a.hasOwnProperty&&"function"===f.typeOf(a.hasOwnProperty)?a.hasOwnProperty(d)&&h(d,a[d]):h(d,a[d])};f.getCookie=
function(a){var h;return(h=document.cookie.match(new RegExp("(^| )"+a+"=([^;]*)(;|$)")))?unescape(h[2]):null};f.formatTime=function(a){var h=a.getHours()+1,d=a.getMinutes(),e=a.getSeconds();return a.toLocaleDateString()+" "+f.pad(h,2)+":"+f.pad(d,2)+":"+f.pad(e,2)};f.pad=function(a,h){for(a+="";a.length<h;)a="0"+a;return a};f.createElement=function(a,h){a=document.createElement(a);h&&(a.className=h);return a};f.addClass=function(a,h){var d="string"===f.typeOf(a.className)?a.className.split(" "):[];
h="array"===f.typeOf(h)?h:h.split(" ");f.foreach(h,function(a,b){-1===f.indexOf(d,b)&&d.push(b)});a.className=f.trim(d.join(" "))};f.removeClass=function(a,h){var d="string"===f.typeOf(a.className)?a.className.split(" "):[];h="array"===f.typeOf(h)?h:h.split(" ");f.foreach(h,function(a,b){a=f.indexOf(d,b);0<=a&&d.splice(a,1)});a.className=f.trim(d.join(" "))};f.emptyElement=function(a){for(;a.firstChild;)a.removeChild(a.firstChild)};f.typeOf=function(a){if(null===a||void 0===a)return"null";var h=typeof a;
if("object"===h)try{if("[object Array]"===toString.call(a))return"array"}catch(d){}return h};f.trim=function(a){return a.replace(/^\s+|\s+$/g,"")};f.indexOf=function(a,h){if(null==a)return-1;for(var d=0;d<a.length;d++)if(a[d]===h)return d;return-1};f.isMSIE=function(a){return a?(a=parseFloat(a).toFixed(1),a=new RegExp("msie\\s*"+a,"i"),null!==navigator.userAgent.toLowerCase().match(a)):null!==navigator.userAgent.toLowerCase().match(/msie/i)};var a=window.console=window.console||{log:function(){}};
f.log=function(){var c=Array.prototype.slice.call(arguments,0);"object"===f.typeOf(a.log)?a.log(c):a.log.apply(a,c)}})(playease);(function(c){c=c.utils;c.littleEndian=function(){var f=new ArrayBuffer(2);(new DataView(f)).setInt16(0,256,!0);return 256===(new Int16Array(f))[0]}();c.getUint32=function(f,a,c){void 0==a&&(a=0);return c?f[a+0]|f[a+1]>>>8|f[a+2]>>>16|f[a+3]>>>24:f[a+0]<<24|f[a+1]<<16|f[a+2]<<8|f[a+3]}})(playease);
(function(c){function f(){var a=document.createElement("style");a.type="text/css";document.getElementsByTagName("head")[0].appendChild(a);return a.sheet||a.styleSheet}var a=c.utils,p;(a.css=function(h,d){p||(p=f());var e="";a.foreach(d,function(a,g){e+=a+": "+g+"; "});try{p.insertRule?p.insertRule(h+" { "+e+"}",p.cssRules.length):p.addRule(h,e,p.rules.length)}catch(b){a.log("Failed to insert css rule: "+h)}}).style=function(h,d,e){if(void 0!==h&&null!==h)for(void 0===h.length&&(h=[h]),d=a.extend({},
d),e=0;e<h.length;e++){var b=h[e];void 0!==b&&null!==b&&a.foreach(d,function(a,e){a=a.split("-");for(var d=1;d<a.length;d++)a[d]=a[d].charAt(0).toUpperCase()+a[d].slice(1);a=a.join("");b.style[a]!==e&&(b.style[a]=e)})}}})(playease);
(function(c){c.events={ERROR:"error",PLAYEASE_READY:"playeaseReady",PLAYEASE_SETUP_ERROR:"playeaseSetupError",PLAYEASE_RENDER_ERROR:"playeaseRenderError",PLAYEASE_STATE:"playeaseState",CHATEASE_PROPERTY:"chateaseProperty",PLAYEASE_METADATA:"playeaseMetaData",PLAYEASE_BUFFER:"playeaseBuffer",PLAYEASE_PLAY:"playeasePlay",PLAYEASE_PAUSE:"playeasePause",PLAYEASE_SEEK:"playeaseSeek",PLAYEASE_STOP:"playeaseStop",PLAYEASE_VIEW_PLAY:"playeaseViewPlay",PLAYEASE_VIEW_PAUSE:"playeaseViewPause",PLAYEASE_VIEW_SEEK:"playeaseViewSeek",
PLAYEASE_VIEW_STOP:"playeaseViewStop",PLAYEASE_VIEW_VOLUME:"playeaseViewVolume",PLAYEASE_VIEW_MUTE:"playeaseViewMute",PLAYEASE_VIEW_FULLSCREEN:"playeaseViewFullscreen",PLAYEASE_CONTENT_LENGTH:"playeaseContentLength",PLAYEASE_PROGRESS:"playeaseProgress",PLAYEASE_COMPLETE:"playeaseComplete",PLAYEASE_FLV_TAG:"playeaseFlvTag",PLAYEASE_AVC_CONFIG_RECORD:"playeaseAVCConfigRecord",PLAYEASE_AVC_SAMPLE:"playeaseAVCSample",PLAYEASE_AAC_SPECIFIC_CONFIG:"playeaseAACSpecificConfig",PLAYEASE_AAC_SAMPLE:"playeaseAACSample",
PLAYEASE_MP4_INIT_SEGMENT:"playeaseMp4InitSegment",PLAYEASE_MP4_SEGMENT:"playeaseMp4Segment",PLAYEASE_END_OF_STREAM:"playeaseEndOfStream"}})(playease);
(function(c){var f=c.utils;c.events.eventdispatcher=function(a){function p(a,b,d){if(a)for(var e=0;e<a.length;e++){var g=a[e];if(g){null!==g.count&&0===--g.count&&delete a[e];try{g.listener(b)}catch(A){f.log('Error handling "'+d+'" event listener ['+e+"]: "+A.toString(),g.listener,b)}}}}var h={},d=[];this.addEventListener=function(a,b,d){try{f.exists(h[a])||(h[a]=[]),"string"===f.typeOf(b)&&(b=(new Function("return "+b))()),h[a].push({listener:b,count:d||null})}catch(n){f.log("error",n)}return!1};
this.removeEventListener=function(a,b){if(h[a]){try{if(void 0===b){h[a]=[];return}var d;for(d=0;d<h[a].length;d++)if(h[a][d].listener.toString()===b.toString()){h[a].splice(d,1);break}}catch(n){f.log("error",n)}return!1}};this.addGlobalListener=function(a,b){try{"string"===f.typeOf(a)&&(a=(new Function("return "+a))()),d.push({listener:a,count:b||null})}catch(g){f.log("error",g)}return!1};this.removeGlobalListener=function(a){if(a){try{var b;for(b=d.length-1;0<=b;b--)d[b].listener.toString()===a.toString()&&
d.splice(b,1)}catch(g){f.log("error",g)}return!1}};this.dispatchEvent=function(e,b){b||(b={});f.extend(b,{id:a,version:c.version,type:e});c.debug&&f.log(e,b);p(h[e],b,e);p(d,b,e)}}})(playease);
(function(c){var f=c.utils,a=c.events;f.loader=function(c){var h=f.extend(this,new a.eventdispatcher("utils.loader")),d={method:"GET",headers:{},mode:"cors",cache:"default"},e,b;h.load=function(d){e=d;fetch?fetch(e,h.config).then(function(d){if(b)b=!1;else{if(d.ok&&200<=d.status&&299>=d.status){var e=d.headers.get("Content-Length");e&&(e=parseInt(e),h.dispatchEvent(a.PLAYEASE_CONTENT_LENGTH,{length:e}));return h.pump(d.body.getReader())}h.dispatchEvent(a.ERROR,{message:"Loader error: Invalid http status("+
d.status+" "+d.statusText+")."})}}).catch(function(b){h.dispatchEvent(a.ERROR,{message:"Loader error: "+b.message})}):h.dispatchEvent(a.ERROR,{message:"Loader error: Fetch is not supported."})};h.pump=function(d){return d.read().then(function(e){if(e.done)h.dispatchEvent(a.PLAYEASE_COMPLETE);else{if(b)return b=!1,d.cancel();h.dispatchEvent(a.PLAYEASE_PROGRESS,{data:e.value.buffer});return h.pump(d)}}).catch(function(b){h.dispatchEvent(a.ERROR,{message:"Loader error: Failed to read response data."})})};
h.abort=function(){b=!0};(function(){h.config=f.extend({},d,c);var a=new Headers,e;for(e in h.config.headers)a.append(e,h.config.headers[e]);h.config.headers=a;b=!1})()}})(playease);
(function(c){var f=c.utils,a=c.events,p={},h={onError:a.ERROR,onReady:a.PLAYEASE_READY,onMetaData:a.PLAYEASE_METADATA,onBuffer:a.PLAYEASE_BUFFER,onPlay:a.PLAYEASE_PLAY,onPause:a.PLAYEASE_PAUSE,onSeek:a.PLAYEASE_SEEK,onStop:a.PLAYEASE_STOP,onVolume:a.PLAYEASE_VIEW_VOLUME,onMute:a.PLAYEASE_VIEW_MUTE,onFullscreen:a.PLAYEASE_VIEW_FULLSCREEN};c.api=function(d){function e(a){b.dispatchEvent(a.type,a)}var b=f.extend(this,new a.eventdispatcher("api")),g;b.container=d;b.id=d.id;b.setup=function(a){f.emptyElement(b.container);
c.debug=!!a.debug;b.config=a;b.config.id=b.id;b.embedder=new c.embed(b);b.embedder.addGlobalListener(e);b.embedder.embed();return b};b.setEntity=function(a,d){g=a;b.renderName=d;b.play=g.play;b.pause=g.pause;b.seek=g.seek;b.stop=g.stop;b.volume=g.volume;b.mute=g.mute;b.fullscreen=g.fullscreen;b.resize=g.resize};(function(){f.foreach(h,function(a,d){b[a]=function(a){b.addEventListener(d,a)}})})()};c.api.getInstance=function(a){var d;null==a?a=0:a.nodeType?d=a:"string"===f.typeOf(a)&&(d=document.getElementById(a));
if(d){var b=p[d.id];b||(p[a]=b=new c.api(d));return b}return"number"===f.typeOf(a)?p[a]:null};c.api.displayError=function(a,e){}})(playease);(function(c){c.muxer={}})(playease);
(function(c){var f=c.utils,a=c.muxer.AMF={},p=a.types={DOUBLE:0,BOOLEAN:1,STRING:2,OBJECT:3,MOVIE_CLIP:4,NULL:5,UNDEFINED:6,REFERENCE:7,MIXED_ARRAY:8,END_OF_OBJECT:9,ARRAY:10,DATE:11,LONG_STRING:12,UNSUPPORTED:13,RECORD_SET:14,XML:15,TYPED_OBJECT:16,AMF3_DATA:17};a.parse=function(h,d,e){var b={};try{var g=a.parseValue(h,d,e),c=a.parseValue(h,d+g.size,e-g.size);b.key=g.data;b.value=c.data}catch(l){f.log("AMF.parse() failed. Error: "+l)}return b};a.parseObject=function(h,d,e){if(3>e)throw"Data not enough while parsing AMF object.";
for(var b={},g=0,f,c={ended:!1};!c.ended&&g<e;)f=a.parseString(h,d+g,e-g),g+=f.size,c=a.parseValue(h,d+g,e-g),g+=c.size,f.data&&c.data&&(b[f.data]=c.data);return{data:b,size:g,ended:c.ended}};a.parseString=function(a,d,e){if(2>e)throw"Data not enough while parsing AMF string.";var b=0;e=(new DataView(a,d,e)).getUint16(b);b+=2;return{data:0<e?String.fromCharCode.apply(String,new Uint8Array(a,d+b,e)):"",size:b+e}};a.parseLongString=function(a,d,e){if(4>e)throw"Data not enough while parsing AMF long string.";
var b=0;e=(new DataView(a,d,e)).getUint32(b);b+=4;return{data:0<e?String.fromCharCode.apply(String,new Uint8Array(a,d+b,e)):"",size:b+e}};a.parseDate=function(a,d,e){if(10>e)throw"Data not enough while parsing AMF date.";e=new DataView(a,d,e);a=0;d=e.getFloat64(a);a+=8;e=e.getInt16(a);return{data:new Date(d+6E4*e),size:a+2}};a.parseValue=function(c,d,e){if(1>e)throw"Data not enough while parsing AMF value.";var b=new DataView(c,d,e),g=0,h=b.getUint8(g),g=g+1,l=void 0,A=!1;try{switch(h){case p.DOUBLE:l=
b.getFloat64(g);g+=8;break;case p.BOOLEAN:l=b.getUint8(g)?!0:!1;g+=1;break;case p.STRING:var v=a.parseString(c,d+g,e-g),l=v.data,g=g+v.size;break;case p.OBJECT:var z=a.parseObject(c,d+g,e-g),l=z.data,g=g+z.size;break;case p.MIXED_ARRAY:var F;b.getUint32(g);var g=g+4,D=a.parseObject(c,d+g,e-g),l=D.data,g=g+D.size;break;case p.END_OF_OBJECT:l=void 0;A=!0;break;case p.ARRAY:F=b.getUint32(g);g+=4;l=[];for(b=0;b<F;b++){var H=a.parseValue(c,d+g,e-g);l.push(H.data);g+=H.size}break;case p.DATE:var k=a.parseDate(c,
d+g,e-g),l=k.data,g=g+k.size;break;case p.LONG_STRING:var m=a.parseString(c,d+g,e-g),l=m.data,g=g+m.size;break;default:f.log("Skipping unsupported AMF value type("+h+")."),g+=e}}catch(r){f.log("AMF.parseValue() failed. Error: "+r)}return{data:l,size:g,ended:A}}})(playease);
(function(c){var f=function(a){function c(){var a=g-b;if(0>=a)throw"Data not enough while filling current word.";var a=Math.min(4,a),d=new Uint8Array(4);d.set(e.subarray(b,b+a));n=(new DataView(d.buffer)).getUint32(0,!1);b+=a;l=8*a}function f(){var a;for(a=0;a<l;a++)if(0!==(n&2147483648>>>a))return n<<=a,l-=a,a;c();return a+f()}var d=this,e,b,g,n,l;d.readBits=function(a){if(32<a)throw"Data not enough while reading bits of ExpGolomb.";if(a<=l){var b=n>>>32-a;n<<=a;l-=a;return b}b=l?n:0;b>>>=32-l;a-=
l;c();a=Math.min(a,l);var d=n>>>32-a;n<<=a;l-=a;return b<<a|d};d.readBool=function(){return 1===d.readBits(1)};d.readByte=function(){return d.readBits(8)};d.readUEG=function(){var a=f();return d.readBits(a+1)-1};d.readSEG=function(){var a=d.readUEG();return a&1?a+1>>>1:-1*(a>>>1)};d.destroy=function(){e=null};e=a;b=0;g=a.byteLength;l=n=0};(c.muxer.SPS={}).parse=function(a){for(var c=a.byteLength,h=new Uint8Array(c),d=0,e=0;e<c;e++)2<=e&&3===a[e]&&0===a[e-1]&&0===a[e-2]||(h[d]=a[e],d++);a=new Uint8Array(h.buffer,
0,d);a=new f(a);a.readByte();var b=a.readByte();a.readByte();h=a.readByte();a.readUEG();switch(b){case 66:c="Baseline";break;case 77:c="Main";break;case 88:c="Extended";break;case 100:c="High";break;case 110:c="High10";break;case 122:c="High422";break;case 244:c="High444";break;default:c="Unknown"}var h=(h/10).toFixed(1),g=1,d=420,n=[0,420,422,444],e=8;if(100===b||110===b||122===b||244===b||44===b||83===b||86===b||118===b||128===b||138===b||144===b)if(g=a.readUEG(),3===g&&a.readBits(1),3>=g&&(d=n[g]),
e=a.readUEG()+8,a.readUEG(),a.readBits(1),a.readBool())for(b=3!==g?8:12,n=0;n<b;n++)if(a.readBool())for(var l=a,A=6>n?16:64,v=8,z=8,F=0;F<A;F++)0!==z&&(z=l.readSEG(),z=(v+z+256)%256),v=0===z?v:z;a.readUEG();b=a.readUEG();if(0===b)a.readUEG();else if(1===b)for(a.readBits(1),a.readSEG(),a.readSEG(),b=a.readUEG(),n=0;n<b;n++)a.readSEG();a.readUEG();a.readBits(1);var D=a.readUEG(),z=a.readUEG(),H=a.readBits(1);0===H&&a.readBits(1);a.readBits(1);var k=0,m=0,r=0,G=0;a.readBool()&&(k=a.readUEG(),m=a.readUEG(),
r=a.readUEG(),G=a.readUEG());n=b=1;v=0;l=!0;F=A=0;if(a.readBool()){if(a.readBool()){var w=a.readByte(),C=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],x=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];0<w&&16>w?(b=C[w-1],n=x[w-1]):255===w&&(b=a.readByte()<<8|a.readByte(),n=a.readByte()<<8|a.readByte())}a.readBool()&&a.readBool();a.readBool()&&(a.readBits(4),a.readBool()&&a.readBits(24));a.readBool()&&(a.readUEG(),a.readUEG());a.readBool()&&(v=a.readBits(32),A=a.readBits(32),l=a.readBool(),F=2*v,v=
A/F)}w=1;if(1!==b||1!==n)w=b/n;0===g?(C=1,g=2-H):(C=3===g?1:2,g=(1===g?2:1)*(2-H));D=16*(D+1)-(k+m)*C;g=16*(2-H)*(z+1)-(r+G)*g;z=Math.ceil(D*w);a.destroy();switch(d){case 420:a="4:2:0";break;case 422:a="4:2:2";break;case 444:a="4:4:4";break;default:a="Unknown"}return{profile_string:c,level_string:h,bit_depth:e,chroma_format:d,chroma_format_string:a,frame_rate:{fixed:l,fps:v,fps_den:F,fps_num:A},sar_ratio:{width:b,height:n},codec_size:{width:D,height:g},present_size:{width:z,height:g}}}})(playease);
(function(c){var f=c.utils,a=c.events;c=c.muxer;var p=c.SPS,h={AUDIO:8,VIDEO:9,SCRIPT:18},d={KEYFRAME:1,INTER_FRAME:2,DISPOSABLE_INTER_FRAME:3,GENERATED_KEYFRAME:4,INFO_OR_COMMAND_FRAME:5},e={types:{SEQUENCE_HEADER:0,NALU:1,END_OF_SEQUENCE:2}},b={types:{SPECIFIC_CONFIG:0,RAW_FRAME_DATA:1},audioObjectTypes:{NULL:0,AAC_MAIN:1,AAC_LC:2,AAC_SSR:3,AAC_LTP:4,AAC_HE_OR_SBR:5,AAC_SCALABLE:6},samplingRates:[96E3,88200,64E3,48E3,44100,32E3,24E3,22050,16E3,12E3,11025,8E3,7350]},g=[5500,11025,22050,44100],n=
function(){var a=this;a.isComplete=function(){var b=!1===a.hasAudio||!0===a.hasAudio&&null!=a.audioCodec&&null!=a.audioSampleRate&&null!=a.audioChannelCount,d=!1===a.hasVideo||!0===a.hasVideo&&null!=a.videoCodec&&null!=a.width&&null!=a.height&&null!=a.fps&&null!=a.profile&&null!=a.level&&null!=a.chromaFormat&&null!=a.sarNum&&null!=a.sarDen;return null!=a.mimeType&&null!=a.duration&&null!=a.metadata&&null!=a.hasKeyframesIndex&&b&&d};a.isSeekable=function(){return!0===a.hasKeyframesIndex};a.getNearestKeyframe=
function(b){if(null==a.keyframesIndex)return null;var d=a.keyframesIndex,c=d.times,e=0,f=c.length-1,g,k=0,h=f;b<c[0]&&(e=0,k=h+1);for(;k<=h;)if(g=k+Math.floor((h-k)/2),g===f||b>=c[g]&&b<c[g+1]){e=g;break}else c[g]<b?k=g+1:h=g-1;b=e;return{index:b,milliseconds:d.times[b],fileposition:d.filepositions[b]}}};c.flv=function(c){var l=f.extend(this,new a.eventdispatcher("muxer.flv")),v,z,F,D,H,k,m,r,G,w,C,x,y,J,t,q,u,L;l.parse=function(b){var d=new Uint8Array(b),u=0;if(1==F){if(13>b.byteLength)return 0;
u=l.probe(b);F=4;var c=f.getUint32(d,u);c&&f.log("First tag size "+c);u+=4;F=2}for(;u<b.byteLength;)switch(F){case 2:r[k.position++]=d[u++];11==k.position&&(w=r[1]<<16|r[2]<<8|r[3],F=3);break;case 3:var e=r[0],q=r[1]<<16|r[2]<<8|r[3],B=r[4]<<16|r[5]<<8|r[6]|r[7]<<24,c=r[8]<<16|r[9]<<8|r[10];0!=c&&f.log("Unknown stream ID "+c);c={tag:e,data:b,offset:u,size:q};switch(e){case h.AUDIO:c.timestamp=B;w==q&&(c.format=d[u]>>>4,c.rate=g[(d[u]&12)>>>2],c.samplesize=(d[u]&2)>>>1,c.sampletype=d[u]&1);break;case h.VIDEO:c.timestamp=
B;w==q&&(c.frametype=d[u]>>>4,c.codec=d[u]&15);break;case h.SCRIPT:c.hasAudio=D,c.hasVideo=H}e=Math.min(b.byteLength-u,w);w-=e;u+=e;if(w){C.push(c);break}if(C.length){c=C[0];q=new Uint8Array(q);for(q.position=0;C.length;)B=C.shift(),e=new Uint8Array(B.data.slice(B.offset)),q.set(e,q.position),q.position+=B.data.byteLength-B.offset;e=new Uint8Array(b.slice(0,u));q.set(e,q.position);c.data=q.buffer;c.offset=0}F=4;m.position=0;l.dispatchEvent(a.PLAYEASE_FLV_TAG,c);break;case 4:G[m.position++]=d[u++];
4==m.position&&(q=r[1]<<16|r[2]<<8|r[3],c=f.getUint32(G),c!=11+q&&f.log("prevTagSize("+c+") is not equals to "+(11+q)+"."),F=2,k.position=0);break;default:f.log("Unknown parsing state "+F);return}};l.parseAVCVideoPacket=function(b,c,q,g,h){if(5>q)l.dispatchEvent(a.ERROR,{message:"Data not enough while parsing AVC video packet."});else{var k=new DataView(b,c,q),B=1,n=k.getUint8(B++),k=k.getUint8(B++)<<16|k.getUint8(B++)<<8|k.getUint8(B++);switch(n){case e.types.SEQUENCE_HEADER:k=c+B;c=q-B;if(7>c)l.dispatchEvent(a.ERROR,
{message:"Data not enough while parsing AVC decoder configuration record."});else if(q=t,q={type:q.type,id:q.id,timescale:1E3,duration:1E3*y.duration||0},B=new DataView(b,k,c),n=0,h=B.getUint8(n++),g=B.getUint8(n++),B.getUint8(n++),B.getUint8(n++),1!=h||0==g)l.dispatchEvent(a.ERROR,{message:"Invalid AVCDecoderConfigurationRecord."});else if(u=1+(B.getUint8(n++)&3),3!=u&&4!=u)l.dispatchEvent(a.ERROR,{message:"Invalid lengthSizeMinusOne "+u+"."});else{g=B.getUint8(n++)&31;for(h=0;h<g;h++){var m=B.getUint16(n),
n=n+2;if(0!=m){var r=new Uint8Array(b,k+n,m),n=n+m,m=p.parse(r),E=q,I=m;E.codecWidth=I.codec_size.width;E.codecHeight=I.codec_size.height;E.presentWidth=I.present_size.width;E.presentHeight=I.present_size.height;E.profile=I.profile_string;E.level=I.level_string;E.bitDepth=I.bit_depth;E.chromaFormat=I.chroma_format;E.sarRatio=I.sar_ratio;E.frameRate=I.frame_rate;if(!1===I.frame_rate.fixed||0===I.frame_rate.fps_num||0===I.frame_rate.fps_den)E.frameRate=J;E.refSampleDuration=Math.floor(E.frameRate.fps_den/
E.frameRate.fps_num*E.timescale);for(var r=r.subarray(1,4),I="avc1.",K=0;3>K;K++){var G=r[K].toString(16);2>G.length&&(G="0"+G);I+=G}E.codec=I;E=q;x.hasAudio=D;x.hasVideo=H;x.duration=1E3*y.duration;x.metadata=y;x.width=E.codecWidth;x.height=E.codecHeight;x.fps=E.frameRate.fps;x.profile=E.profile;x.level=E.level;x.chromaFormat=m.chroma_format_string;x.sarNum=E.sarRatio.width;x.sarDen=E.sarRatio.height;x.videoCodec=E.codec;x.mimeType='video/mp4; codecs="'+x.videoCodec+(x.hasAudio&&x.audioCodec?","+
x.audioCodec:"")+'"';l.dispatchEvent(a.PLAYEASE_MEDIA_INFO,{info:x})}}g=B.getUint8(n++);for(h=0;h<g;h++)m=B.getUint16(n),n+=2,0!=m&&(new Uint8Array(b,k+n,m),n+=m);q.avcc=new Uint8Array(c);q.avcc.set(new Uint8Array(b,k,c),0);l.dispatchEvent(a.PLAYEASE_AVC_CONFIG_RECORD,{data:q})}break;case e.types.NALU:a:{c+=B;q-=B;B=new DataView(b,c,q);n=[];g=L+g;h=h==d.KEYFRAME;for(E=m=0;m<q;){if(m+4>=q){l.dispatchEvent(a.ERROR,{message:"Data not enough for next NALU."});break a}r=B.getUint32(m);3==r&&(r>>>=8);if(r>
q-u){f.log("Malformed Nalus near timestamp "+g+".");break a}I=B.getUint8(m+u)&31;I==d.INFO_OR_COMMAND_FRAME&&(h=!0);K=new Uint8Array(b,c+m,u+r);E+=K.byteLength;n.push({type:I,data:K});m+=u+r}0!=n.length&&(t.samples.push({units:n,length:E,isKeyframe:h,cts:k,dts:g,pts:k+g}),t.length+=E,l.dispatchEvent(a.PLAYEASE_AVC_SAMPLE,{data:t}))}break;case e.types.END_OF_SEQUENCE:l.dispatchEvent(a.PLAYEASE_END_OF_STREAM);break;default:l.dispatchEvent(a.ERROR,{message:"Unknown AVC video packet type "+n+"."})}}};
l.parseAACAudioPacket=function(d,c,u,e,g,f,h){if(2>u)l.dispatchEvent(a.ERROR,{message:"Data not enough while parsing AAC audio packet."});else{f=1;var k=(new DataView(d,c,u)).getUint8(f++);switch(k){case b.types.SPECIFIC_CONFIG:e=c+f;c=u-f;3>c?l.dispatchEvent(a.ERROR,{message:"Data not enough while parsing AAC audio specific config."}):(u=q,u={type:u.type,id:u.id,timescale:1E3,duration:1E3*y.duration||0},u.audioSampleRate=g,u.channelCount=0===h?1:2,u.refSampleDuration=Math.floor(1024/u.audioSampleRate*
u.timescale),u.codec="mp4a.40.5",e=new DataView(d,e,c),c=0,h=e.getUint8(c)>>>3,d=(e.getUint8(c++)&7)<<1|e.getUint8(c)>>>7,0>d||d>=b.samplingRates.length?l.dispatchEvent(a.ERROR,{message:"Invalid AAC sampling frequency index.",index:d}):(g=(e.getUint8(c)&120)>>>3,0>g||8<=g?l.dispatchEvent(a.ERROR,{message:"Invalid AAC channel configuration.",config:g}):(h===b.audioObjectTypes.AAC_HE_OR_SBR&&(e.getUint8(c++),e.getUint8(c),e.getUint8(c)),h=self.navigator.userAgent.toLowerCase(),-1!==h.indexOf("firefox")?
d>=b.audioObjectTypes.AAC_SCALABLE?(h=b.audioObjectTypes.AAC_HE_OR_SBR,e=d-3,c=Array(4)):(h=b.audioObjectTypes.AAC_LC,e=d,c=Array(2)):-1!==h.indexOf("android")?(h=b.audioObjectTypes.AAC_LC,e=d,c=Array(2)):(h=b.audioObjectTypes.AAC_HE_OR_SBR,e=d,c=Array(4),d>=b.audioObjectTypes.AAC_SCALABLE?e=d-3:1===g&&(h=2,e=d,c=Array(2))),c[0]=h<<3,c[0]|=(d&15)>>>1,c[1]=(d&15)<<7,c[1]|=(g&15)<<3,h===b.audioObjectTypes.AAC_HE_OR_SBR&&(c[1]|=(e&15)>>>1,c[2]=(e&1)<<7,c[2]|=8,c[3]=0),u.codec="mp4a.40."+h,u.config=c,
x.audioCodec=u.codec,x.audioSampleRate=u.audioSampleRate,x.audioChannelCount=u.channelCount,x.mimeType='video/mp4; codecs="'+x.videoCodec+(x.hasAudio&&x.audioCodec?","+x.audioCodec:"")+'"',l.dispatchEvent(a.PLAYEASE_MEDIA_INFO,{info:x}),l.dispatchEvent(a.PLAYEASE_AAC_SPECIFIC_CONFIG,{data:u}))));break;case b.types.RAW_FRAME_DATA:u=new Uint8Array(d,c+f,u-f);d=L+e;q.samples.push({unit:u,dts:d,pts:d});q.length+=u.length;l.dispatchEvent(a.PLAYEASE_AAC_SAMPLE,{data:q});break;default:l.dispatchEvent(a.ERROR,
{message:"Unknown AAC audio packet type "+k+"."})}}};l.probe=function(a){a=new Uint8Array(a);if(70!==a[0]||76!==a[1]||86!==a[2]||1!==a[3])return 0;D=0!==(a[4]&4)>>>2;H=0!==(a[4]&1);if(!D&&!H)return 0;a=f.getUint32(a,5);return 9>a?0:a};l.setMetaData=function(a){y=a;if("number"===typeof y.framerate&&(a=Math.floor(1E3*y.framerate),0<a)){var b=a/1E3;J.fixed=!0;J.fps=b;J.fps_num=a;J.fps_den=1E3;x.fps=b}x.hasKeyframesIndex="object"===typeof y.keyframes?!0:!1};l.getMetaData=function(){return y};l.offset=
function(){return v};l.length=function(){return z};l.destroy=function(){};l.config=f.extend({},{},c);z=v=0;F=1;k=new ArrayBuffer(11);k.position=0;r=new Uint8Array(k);m=new ArrayBuffer(4);m.position=0;G=new Uint8Array(m);w=0;C=[];x=new n;J={fixed:!0,fps:23.976,fps_num:23976,fps_den:1E3};t={type:"video",id:1,sequenceNumber:0,samples:[],length:0};q={type:"audio",id:2,sequenceNumber:0,samples:[],length:0};L=u=0};c.flv.TAG=h;c.flv.FORMATS={LINEAR_PCM_PLATFORM_ENDIAN:0,ADPCM:1,MP3:2,LINEAR_PCM_LITTLE_ENDIAN:3,
NELLYMOSER_16_kHz_MONO:4,NELLYMOSER_8_kHz_MONO:5,NELLYMOSER:6,G_711_A_LAW_LOGARITHMIC_PCM:7,G_711_MU_LAW_LOGARITHMIC_PCM:8,RESERVED:9,AAC:10,SPEEX:11,MP3_8_kHz:14,DEVICE_SPECIFIC_SOUND:15};c.flv.FRAMES=d;c.flv.CODECS={JPEG:1,H263:2,SCREEN_VIDEO:3,VP6:4,VP6_ALPHA:5,SCREEN_VIDEO_2:6,AVC:7};c.flv.AVC=e;c.flv.AAC=b})(playease);
(function(c){var f=c.utils,a=c.events;c=c.muxer;var p=c.flv.AAC,h,d,e,b,g,n,l,A,v;h=new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]);d=new Uint8Array([0,0,0,0,0,0,0,1]);e=new Uint8Array([0,0,0,0,0,0,0,0]);b=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]);g=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]);n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,
108,101,114,0]);l=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]);A=new Uint8Array([0,0,0,0,0,0,0,0]);v=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]);p.getSilentFrame=function(a){return 1===a?new Uint8Array([0,200,0,128,35,128]):2===a?new Uint8Array([33,0,73,144,2,25,0,35,128]):3===a?new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]):4===a?new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]):5===a?new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,
0,33,144,2,56]):6===a?new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]):null};var z=function(a,b,c,d,e){this.dts=a;this.pts=b;this.duration=c;this.originalDts=d;this.isSyncPoint=e;this.fileposition=null},F=function(){var a=[];this.appendSyncPoint=function(b){b.isSyncPoint=!0;a.push(b)}},D=function(a){var b=this,c=[],d=-1;b.searchNearestSegmentBefore=function(a){if(0===c.length)return-2;var b=c.length-1,d,e=0,g=b,f=0;if(a<c[0].originalBeginDts)return-1;for(;e<=
g;){d=e+Math.floor((g-e)/2);if(d===b||a>c[d].lastSample.originalDts&&a<c[d+1].originalBeginDts){f=d;break}c[d].originalBeginDts<a?e=d+1:g=d-1}return f};b.searchNearestSegmentAfter=function(a){return b.searchNearestSegmentBefore(a)+1};b.append=function(a){var e=d,g=0;-1!==e&&e<c.length&&a.originalBeginDts>=c[e].lastSample.originalDts&&(e===c.length-1||e<c.length-1&&a.originalBeginDts<c[e+1].originalBeginDts)?g=e+1:0<c.length&&(g=b.searchNearestSegmentBefore(a.originalBeginDts)+1);d=g;c.splice(g,0,
a)};b.getLastSegmentBefore=function(a){a=b.searchNearestSegmentBefore(a);return 0>a?null:c[a]};b.getLastSampleBefore=function(a){a=b.getLastSegmentBefore(a);return null==a?null:a.lastSample};b.getLastSyncPointBefore=function(a){a=b.searchNearestSegmentBefore(a);for(var d=c[a].syncPoints;0===d.length&&a--;)d=c[a].syncPoints;return 0>=d.length?null:d[d.length-1]};b.isEmpty=function(){return 0===c.length};b.clear=function(){c=[];d=-1}};c.mp4=function(c){var k=f.extend(this,new a.eventdispatcher("muxer.mp4")),
m={islive:!1},r,G,w,C,x,y,H,t={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};k.getInitSegment=function(b){var c=k.box(t.ftyp,h),d=k.moov(b),e=new Uint8Array(c.byteLength+d.byteLength);e.set(c,0);e.set(d,c.byteLength);k.dispatchEvent(a.PLAYEASE_MP4_INIT_SEGMENT,{tp:b.type,data:e})};
k.getVideoSegment=function(b){var c=b.samples,d=void 0,e=-1,g=-1,q;if(c&&0!==c.length){q=0;var f=8+b.length,h=new Uint8Array(f);h[q++]=f>>>24&255;h[q++]=f>>>16&255;h[q++]=f>>>8&255;h[q++]=f&255;h.set(t.mdat,q);q+=4;for(var f=[],n=new F;c.length;){var l=c.shift(),m=l.isKeyframe,p=l.dts- -1;if(void 0==d)if(void 0==r)if(x.isEmpty())d=0;else if(d=x.getLastSampleBefore(p),null!=d){var y=p-(d.originalDts+d.duration);3>=y&&(y=0);d=p-(d.dts+d.duration+y)}else d=0;else d=p-r;var y=p-d,v=l.cts,G=y+v;-1===e&&
(e=y,g=G);for(var C=0;l.units.length;){var A=l.units.shift().data;h.set(A,q);q+=A.byteLength;C+=A.byteLength}A=1<=c.length?c[0].dts- -1-d-y:1<=f.length?f[f.length-1].duration:w.refSampleDuration;if(m){var D=new z(y,G,A,l.dts,!0);D.fileposition=l.fileposition;n.appendSyncPoint(D)}f.push({dts:y,pts:G,cts:v,size:C,isKeyframe:m,duration:A,originalDts:p,flags:{isLeading:0,dependsOn:m?2:1,isDependedOn:m?1:0,hasRedundancy:0,isNonSync:m?0:1}})}l=f[f.length-1];c=l.dts+l.duration;q=l.pts+l.duration;r=c;n.beginDts=
e;n.endDts=c;n.beginPts=g;n.endPts=q;n.originalBeginDts=f[0].originalDts;n.originalEndDts=l.originalDts+l.duration;n.firstSample=new z(f[0].dts,f[0].pts,f[0].duration,f[0].originalDts,f[0].isKeyframe);n.lastSample=new z(l.dts,l.pts,l.duration,l.originalDts,l.isKeyframe);k.config.islive||x.append(n);b.samples=f;b.sequenceNumber++;e=k.moof(b,e);b.samples=[];b.length=0;k.dispatchEvent(a.PLAYEASE_MP4_SEGMENT,{tp:"video",data:_mergeBoxes(e,h),sampleCount:f.length,info:n})}};k.getAudioSegment=function(b){var c=
b.samples,d=void 0,e=-1,g;g=!1;var q=-1;if(c&&0!==c.length){var h=0,n=8+b.length,l=new Uint8Array(n);l[h++]=n>>>24&255;l[h++]=n>>>16&255;l[h++]=n>>>8&255;l[h++]=n&255;l.set(t.mdat,h);for(var h=h+4,m=[];c.length;){var r=c.shift(),w=r.unit,v=r.dts- -1;if(void 0==d)if(void 0==G)if(y.isEmpty())d=0,H&&!x.isEmpty()&&(g=!0);else if(d=y.getLastSampleBefore(v),null!=d){var A=v-(d.originalDts+d.duration);3>=A&&(A=0);d=v-(d.dts+d.duration+A)}else d=0;else d=v-G;A=v-d;if(g){var D=x.getLastSegmentBefore(v);null!=
D&&D.beginDts<A?(q=A-D.beginDts,A=D.beginDts):g=!1}-1===e&&(e=A);g?(g=!1,c.unshift(r),r=A,w=q,v=p.getSilentFrame(C.channelCount),null==v?(f.log("Cannot generate silent aac frame, channelCount: "+C.channelCount+"."),r=null):r={unit:v,mp4Sample:{dts:r,pts:r,cts:0,size:v.byteLength,duration:w,originalDts:r,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}},null!=r&&(w=r.unit,m.push(r.mp4Sample),h=0,n+=w.byteLength,l=new Uint8Array(n),l[h++]=n>>>24&255,l[h++]=n>>>16&255,l[h++]=n>>>8&255,
l[h++]=n&255,l.set(t.mdat,h),h+=4,l.set(w,h),h+=w.byteLength)):(m.push({dts:A,pts:A,cts:0,size:w.byteLength,duration:1<=c.length?c[0].dts- -1-d-A:1<=m.length?m[m.length-1].duration:C.refSampleDuration,originalDts:v,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}),l.set(w,h),h+=w.byteLength)}q=m[m.length-1];G=g=q.dts+q.duration;c=new F;c.beginDts=e;c.endDts=g;c.beginPts=e;c.endPts=g;c.originalBeginDts=m[0].originalDts;c.originalEndDts=q.originalDts+q.duration;c.firstSample=new z(m[0].dts,
m[0].pts,m[0].duration,m[0].originalDts,!1);c.lastSample=new z(q.dts,q.pts,q.duration,q.originalDts,!1);k.config.islive||y.append(c);b.samples=m;b.sequenceNumber++;e=k.moof(b,e);b.samples=[];b.length=0;k.dispatchEvent(a.PLAYEASE_MP4_SEGMENT,{tp:"audio",data:_mergeBoxes(e,l),sampleCount:m.length,info:c})}};_mergeBoxes=function(a,b){var c=new Uint8Array(a.byteLength+b.byteLength);c.set(a,0);c.set(b,a.byteLength);return c};k.setVideoMeta=function(a){w=a};k.setAudioMeta=function(a){C=a};k.box=function(a){for(var b=
8,c=Array.prototype.slice.call(arguments,1),d=0;d<c.length;d++)b+=c[d].byteLength;var e=new Uint8Array(b),g=0;e[g++]=b>>>24&255;e[g++]=b>>>16&255;e[g++]=b>>>8&255;e[g++]=b&255;e.set(a,g);g+=4;for(d=0;d<c.length;d++)e.set(c[d],g),g+=c[d].byteLength;return e};k.moov=function(a){var b=k.mvhd(a.timescale,a.duration),c=k.trak(a);a=k.mvex(a);return k.box(t.moov,b,c,a)};k.mvhd=function(a,b){return k.box(t.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,a>>>24&255,a>>>16&255,a>>>8&255,a&255,b>>>24&255,b>>>16&
255,b>>>8&255,b&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))};k.trak=function(a){return k.box(t.trak,k.tkhd(a),k.mdia(a))};k.tkhd=function(a){var b=a.id,c=a.duration,d=a.presentWidth;a=a.presentHeight;return k.box(t.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,b>>>24&255,b>>>16&255,b>>>8&255,b&255,0,0,0,0,c>>>24&255,c>>>16&255,c>>>8&255,c&255,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,d>>>8&255,d&255,0,0,a>>>8&255,a&255,0,0]))};k.mdia=function(a){return k.box(t.mdia,k.mdhd(a),k.hdlr(a),k.minf(a))};k.mdhd=function(a){var b=a.timescale;a=a.duration;return k.box(t.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,b>>>24&255,b>>>16&255,b>>>8&255,b&255,a>>>24&255,a>>>16&255,a>>>8&255,a&255,85,196,0,0]))};k.hdlr=function(a){return k.box(t.hdlr,"audio"===a.type?n:g)};k.minf=function(a){var b;b="audio"===a.type?
k.box(t.smhd,A):k.box(t.vmhd,v);return k.box(t.minf,b,k.dinf(),k.stbl(a))};k.dinf=function(){return k.box(t.dinf,k.box(t.dref,l))};k.stbl=function(a){return k.box(t.stbl,k.stsd(a),k.box(t.stts,e),k.box(t.stsc,e),k.box(t.stsz,b),k.box(t.stco,e))};k.stsd=function(a){return"audio"===a.type?k.box(t.stsd,d,k.mp4a(a)):k.box(t.stsd,d,k.avc1(a))};k.mp4a=function(a){var b=a.audioSampleRate,b=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,a.channelCount,0,16,0,0,0,0,b>>>8&255,b&255,0,0]);return k.box(t.mp4a,
b,k.esds(a))};k.esds=function(a){a=a.config;var b=a.length;a=new Uint8Array([0,0,0,0,3,23+b,0,1,0,4,15+b,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([b]).concat(a).concat([6,1,2]));return k.box(t.esds,a)};k.avc1=function(a){var b=a.avcc,c=a.codecWidth;a=a.codecHeight;c=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,c>>>8&255,c&255,a>>>8&255,a&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return k.box(t.avc1,
c,k.box(t.avcC,b))};k.mvex=function(a){return k.box(t.mvex,k.trex(a))};k.trex=function(a){a=a.id;a=new Uint8Array([0,0,0,0,a>>>24&255,a>>>16&255,a>>>8&255,a&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return k.box(t.trex,a)};k.moof=function(a,b){return k.box(t.moof,k.mfhd(a.sequenceNumber),k.traf(a,b))};k.mfhd=function(a){a=new Uint8Array([0,0,0,0,a>>>24&255,a>>>16&255,a>>>8&255,a&255]);return k.box(t.mfhd,a)};k.traf=function(a,b){var c=a.id,c=k.box(t.tfhd,new Uint8Array([0,0,0,0,c>>>24&255,c>>>16&255,
c>>>8&255,c&255]));b=k.box(t.tfdt,new Uint8Array([0,0,0,0,b>>>24&255,b>>>16&255,b>>>8&255,b&255]));var d=k.sdtp(a);a=k.trun(a,d.byteLength+16+16+8+16+8+8);return k.box(t.traf,c,b,a,d)};k.sdtp=function(a){a=a.samples||[];for(var b=a.length,c=new Uint8Array(4+b),d=0;d<b;d++){var e=a[d].flags;c[d+4]=e.isLeading<<6|e.dependsOn<<4|e.isDependedOn<<2|e.hasRedundancy}return k.box(t.sdtp,c)};k.trun=function(a,b){a=a.samples||[];var c=a.length,d=12+16*c,e=new Uint8Array(d);b+=8+d;e.set([0,0,15,1,c>>>24&255,
c>>>16&255,c>>>8&255,c&255,b>>>24&255,b>>>16&255,b>>>8&255,b&255],0);for(b=0;b<c;b++){var d=a[b].duration,g=a[b].size,h=a[b].flags,f=a[b].cts;e.set([d>>>24&255,d>>>16&255,d>>>8&255,d&255,g>>>24&255,g>>>16&255,g>>>8&255,g&255,h.isLeading<<2|h.dependsOn,h.isDependedOn<<6|h.hasRedundancy<<4|h.isNonSync,0,0,f>>>24&255,f>>>16&255,f>>>8&255,f&255],12+16*b)}return k.box(t.trun,e)};k.mdat=function(a){return k.box(t.mdat,a)};k.destroy=function(){};(function(){k.config=f.extend({},m,c);for(var a in t)t[a]=
[a.charCodeAt(0),a.charCodeAt(1),a.charCodeAt(2),a.charCodeAt(3)];x=new D("video");y=new D("audio");H=!1})()}})(playease);(function(c){c.core={}})(playease);(function(c){c.core.states={BUFFERING:"buffering",PLAYING:"playing",SEEKING:"seeking",PAUSED:"paused",STOPPED:"stopped",ERROR:"error"}})(playease);(function(c){c.core.skins={}})(playease);(function(c){c.core.skins.modes={DEFAULT:"def"}})(playease);
(function(c){var f=c.utils,a=c.events;c=c.core.skins;var p=c.modes,h=f.css,d="pla-skin";c.def=function(c){var b=f.extend(this,new a.eventdispatcher("skins.def")),e=c.height;b.resize=function(a,b){f.log("Resizing to "+a+", "+b);parseInt(a);e=parseInt(b)};b.name=p.DEFAULT;d+="-"+b.name;h(".pla-wrapper",{width:c.width+"px",height:e+"px","box-shadow":"0 1px 1px rgba(0, 0, 0, 0.05)"});h(".pla-wrapper *",{margin:"0",padding:"0","font-family":"\u5fae\u8f6f\u96c5\u9ed1,arial,sans-serif","font-size":"14px",
"font-weight":"normal","box-sizing":"content-box"});h("."+d+" .pla-render",{width:"100%",height:"100%",position:"relative"});h("."+d+" .pla-render video",{})}})(playease);(function(c){c.core.renders={}})(playease);(function(c){c.core.renders.modes={DEFAULT:"def",FLV:"flv"}})(playease);
(function(c){var f=c.utils,a=c.events;c=c.core.renders;var p=c.modes;c.def=function(c,d){function e(c){g.removeEventListener("play",e);b.dispatchEvent(a.PLAYEASE_VIEW_PLAY)}var b=f.extend(this,new a.eventdispatcher("renders.def")),g;b.setup=function(){b.dispatchEvent(a.PLAYEASE_READY,{id:b.config.id})};b.play=function(){g.src=d.url};b.pause=function(){};b.seek=function(a){};b.stop=function(){};b.volume=function(a){};b.mute=function(a){};b.fullscreen=function(a){};b.element=function(){return g};b.resize=
function(a,b){};b.destroy=function(){};b.name=p.DEFAULT;b.config=f.extend({},{},d);g=f.createElement("video");g.width=b.config.width;g.height=b.config.height;g.controls=b.config.controls;g.autoplay=b.config.autoplay;g.poster=b.config.poster;b.config.autoplay||g.addEventListener("play",e)}})(playease);
(function(c){var f=c.utils,a=c.events,p=c.muxer;c=c.core.renders;var h=c.modes,d=p.AMF,e=p.flv.TAG,b=p.flv.FORMATS,g=p.flv.CODECS;c.flv=function(c,l){function n(b){r.removeEventListener("play",n);m.dispatchEvent(a.PLAYEASE_VIEW_PLAY)}function v(b){f.log("source open");m.dispatchEvent(a.PLAYEASE_READY,{id:m.config.id})}function z(a){var b=a.target.type;if(q){if(!y||"open"!==y.readyState)return;if(!t.audio.length&&!t.video.length){y.endOfStream();return}}if(0!=t[b].length&&(a=J[b],!a.updating)){b=t[b].shift();
try{a.appendBuffer(b)}catch(B){f.log(B)}}}function F(a){f.log("source buffer error")}function D(a){f.log("source ended")}function H(a){f.log("source close")}function k(a){f.log("media source error")}var m=f.extend(this,new a.eventdispatcher("renders.def")),r,G,w,C,x,y,J,t,q=!1;m.setup=function(){r.src=window.URL.createObjectURL(y)};m.play=function(){G.load(l.url)};m.pause=function(){};m.seek=function(a){};m.stop=function(){};m.volume=function(a){};m.mute=function(a){};m.fullscreen=function(a){};m.appendInitSegment=
function(b,c){var d=b+'/mp4; codecs="'+x[b+"Codec"]+'"';f.log("Mime type: "+d+".");MediaSource.isTypeSupported(d)?"closed"==y.readyState?m.dispatchEvent(a.PLAYEASE_RENDER_ERROR,{message:"MediaSource is closed while appending init segment."}):(d=J[b]=y.addSourceBuffer(d),d.type=b,d.addEventListener("updateend",z),d.addEventListener("error",F),d.appendBuffer(c)):m.dispatchEvent(a.PLAYEASE_RENDER_ERROR,{message:"Mime type is not surpported: "+d+"."})};m.appendSegment=function(a,b){t[a].push(b);var c=
J[a];c.updating||(b=t[a].shift(),c.appendBuffer(b))};m.element=function(){return r};m.resize=function(a,b){};m.destroy=function(){};m.name=h.DEFAULT;m.config=f.extend({},{},l);J={audio:null,video:null};t={audio:[],video:[]};r=f.createElement("video");r.width=m.config.width;r.height=m.config.height;r.controls=m.config.controls;r.autoplay=m.config.autoplay;r.poster=m.config.poster;m.config.autoplay||r.addEventListener("play",n);G=new f.loader(l.loader);G.addEventListener(a.PLAYEASE_CONTENT_LENGTH,function(a){f.log("onContenLength: "+
a.length)});G.addEventListener(a.PLAYEASE_PROGRESS,function(a){w.parse(a.data)});G.addEventListener(a.PLAYEASE_COMPLETE,function(a){f.log("onLoaderComplete")});G.addEventListener(a.ERROR,function(a){f.log(a.message)});w=new p.flv;w.addEventListener(a.PLAYEASE_FLV_TAG,function(a){switch(a.tag){case e.AUDIO:if(a.format&&a.format!=b.AAC){f.log("Unsupported audio format("+a.format+").");break}w.parseAACAudioPacket(a.data,a.offset,a.size,a.timestamp,a.rate,a.samplesize,a.sampletype);break;case e.VIDEO:if(a.codec&&
a.codec!=g.AVC){f.log("Unsupported video codec("+a.codec+").");break}w.parseAVCVideoPacket(a.data,a.offset,a.size,a.timestamp,a.frametype);break;case e.SCRIPT:a=d.parse(a.data,a.offset,a.size);f.log(a.key+": "+JSON.stringify(a.value));"onMetaData"==a.key&&w.setMetaData(a.value);break;default:f.log("Skipping unknown tag type "+a.tag)}});w.addEventListener(a.PLAYEASE_MEDIA_INFO,function(a){x=a.info});w.addEventListener(a.PLAYEASE_AVC_CONFIG_RECORD,function(a){C.setVideoMeta(a.data);C.getInitSegment(a.data)});
w.addEventListener(a.PLAYEASE_AVC_SAMPLE,function(a){C.getVideoSegment(a.data)});w.addEventListener(a.PLAYEASE_AAC_SPECIFIC_CONFIG,function(a){C.setAudioMeta(a.data);C.getInitSegment(a.data)});w.addEventListener(a.PLAYEASE_AAC_SAMPLE,function(a){C.getAudioSegment(a.data)});w.addEventListener(a.PLAYEASE_END_OF_STREAM,function(a){q=!0});w.addEventListener(a.ERROR,function(a){f.log(a.message)});C=new p.mp4;C.addEventListener(a.PLAYEASE_MP4_INIT_SEGMENT,function(a){m.appendInitSegment(a.tp,a.data)});
C.addEventListener(a.PLAYEASE_MP4_SEGMENT,function(a){m.appendSegment(a.tp,a.data)});C.addEventListener(a.ERROR,function(a){f.log(a.message)});window.MediaSource=window.MediaSource||window.WebKitMediaSource;y=new MediaSource;y.addEventListener("sourceopen",v);y.addEventListener("sourceended",D);y.addEventListener("sourceclose",H);y.addEventListener("error",k);y.addEventListener("webkitsourceopen",v);y.addEventListener("webkitsourceended",D);y.addEventListener("webkitsourceclose",H);y.addEventListener("webkiterror",
k)}})(playease);
(function(c){var f=c.utils,a=c.events,p=c.core;p.entity=function(c){var d=f.extend(this,new a.eventdispatcher("core.entity")),e,b,g;d.setup=function(){setTimeout(function(){b.setup()},0)};d.destroy=function(){g&&g.stop();b&&b.destroy();e&&e.destroy()};d.id=c.id;d.model=e=new p.model(c);d.view=b=new p.view(d,e);d.controller=g=new p.controller(e,b);g.addGlobalListener(function(a){d.dispatchEvent(a.type,a)});d.play=g.play;d.pause=g.pause;d.seek=g.seek;d.stop=g.stop;d.volume=g.volume;d.mute=g.mute;d.fullscreen=
g.fullscreen;d.getState=e.getState;d.resize=b.resize}})(playease);
(function(c){var f=c.utils,a=c.events;c=c.core;var p=c.states;c.model=function(c){var d=f.extend(this,new a.eventdispatcher("core.model")),e=p.STOPPED,b;d.setState=function(b){b!==e&&(e=b,d.dispatchEvent(a.PLAYEASE_STATE,{state:b}))};d.getState=function(){return e};d.setProperty=function(c,e){1==b.hasOwnProperty(c)&&(b[c]=e,d.dispatchEvent(a.PLAYEASE_PROPERTY,{key:c,value:e}))};d.getProperty=function(a){return b[a]};d.getConfig=function(a){return d.config[a]||{}};d.destroy=function(){};d.config=f.extend({},
{},c);b={}}})(playease);
(function(c){var f=c.utils,a=c.events;c=c.core;var p=c.renders,h=c.skins;c.view=function(c,e){function b(){var b=f.extend({},e.getConfig("render"),{id:c.id,url:e.config.url,width:e.config.width,height:e.config.height,controls:e.config.controls,autoplay:e.config.autoplay,poster:e.config.poster,loader:{mode:e.config.cors}});try{m=v.render=new p[b.name](v,b),m.addEventListener(a.PLAYEASE_READY,A),m.addEventListener(a.PLAYEASE_VIEW_PLAY,A),m.addEventListener(a.PLAYEASE_RENDER_ERROR,l)}catch(G){f.log("Failed to init render "+
b.name+"!")}m&&F.appendChild(m.element())}function d(){var a=f.extend({},e.getConfig("skin"),{id:c.id,width:e.config.width,height:e.config.height});try{new h[a.name](a)}catch(G){f.log("Failed to init skin "+a.name+"!")}}function n(a){if(a.ctrlKey||a.metaKey)return!0;if(/13|32/.test(a.keyCode))return a.preventDefault?a.preventDefault():a.returnValue=!1,!1}function l(a){A(a)}function A(a){v.dispatchEvent(a.type,a)}var v=f.extend(this,new a.eventdispatcher("core.view")),z,F,D,H,k,m;v.setup=function(){if(m){m.setup();
try{z.addEventListener("keydown",n)}catch(r){z.attachEvent("onkeydown",n)}}else v.dispatchEvent(a.PLAYEASE_SETUP_ERROR,{message:"Render not available!",name:e.config.render.name})};v.display=function(a,b){};v.resize=function(a,b){m&&m.resize(a,b)};v.destroy=function(){if(z)try{z.removeEventListener("keydown",n)}catch(r){z.detachEvent("onkeydown",n)}m&&m.destroy()};(function(){z=f.createElement("div","pla-wrapper pla-skin-"+e.config.skin.name);z.id=c.id;z.tabIndex=0;F=f.createElement("div","pla-render");
D=f.createElement("div","pla-poster");H=f.createElement("div","pla-controls");k=f.createElement("div","pla-contextmenu");z.appendChild(F);z.appendChild(D);z.appendChild(H);z.appendChild(k);b();d();var a=document.getElementById(c.id);a.parentNode.replaceChild(z,a);window.onresize=function(){"function"==f.typeOf(e.config.onresize)&&e.config.onresize.call(null)}})()}})(playease);
(function(c){var f=c.utils,a=c.events;c=c.core;var p=c.states;c.controller=function(c,d){function e(a){b.dispatchEvent(a.type,a)}var b=f.extend(this,new a.eventdispatcher("core.controller")),g=!1;c.addEventListener(a.PLAYEASE_STATE,function(c){switch(c.state){case p.BUFFERING:b.dispatchEvent(a.PLAYEASE_BUFFER);break;case p.PLAYING:b.dispatchEvent(a.PLAYEASE_PLAY);break;case p.PAUSED:b.dispatchEvent(a.PLAYEASE_PAUSE);break;case p.SEEKING:b.dispatchEvent(a.PLAYEASE_SEEK);break;case p.STOPPED:b.dispatchEvent(a.PLAYEASE_STOP);
break;case p.ERROR:break;default:b.dispatchEvent(a.ERROR,{message:"Unknown model state!",state:c.state})}});d.addEventListener(a.PLAYEASE_READY,function(a){g||(f.log("Player ready!"),g=!0,e(a),c.config.autoplay&&b.play(),window.onbeforeunload=function(a){})});d.addEventListener(a.PLAYEASE_SETUP_ERROR,function(a){c.setState(p.ERROR);e(a)});d.addEventListener(a.PLAYEASE_VIEW_PLAY,function(a){var d=c.getState();if(d==p.PAUSED||d==p.STOPPED||d==p.ERROR)b.play(),e(a)});d.addEventListener(a.PLAYEASE_VIEW_PAUSE,
function(a){var d=c.getState();if(d==p.BUFFERING||d==p.PLAYING||d==p.ERROR)b.pause(),e(a)});d.addEventListener(a.PLAYEASE_VIEW_SEEK,function(a){c.getState()!=p.SEEKING&&(b.seek(a.time),e(a))});d.addEventListener(a.PLAYEASE_VIEW_STOP,function(a){b.stop();e(a)});d.addEventListener(a.PLAYEASE_VIEW_VOLUNE,function(a){b.volume(a.vol);e(a)});d.addEventListener(a.PLAYEASE_VIEW_FULLSCREEN,function(a){b.fullscreen(a.esc);e(a)});d.addEventListener(a.PLAYEASE_RENDER_ERROR,function(a){c.setState(p.ERROR);e(a)});
b.play=d.render.play;b.pause=d.render.pause;b.seek=d.render.seek;b.stop=d.render.stop;b.volume=d.render.volume;b.mute=d.render.mute;b.fullscreen=d.render.fullscreen}})(playease);
(function(c){var f=c.utils,a=c.events,p=c.embed=function(h){function d(b){switch(b.type){case a.ERROR:case a.PLAYEASE_SETUP_ERROR:case a.PLAYEASE_RENDER_ERROR:case a.PLAYEASE_ERROR:e.errorScreen(b.message);e.dispatchEvent(a.ERROR,b);break;default:e.dispatchEvent(b.type,b)}}var e=f.extend(this,new a.eventdispatcher("embed")),b={},g=!1,n=null;e.embed=function(){try{b=new p.config(h.config),n=new p.embedder(h,b)}catch(l){f.log("Failed to init embedder!");e.dispatchEvent(a.PLAYEASE_SETUP_ERROR,{message:"Failed to init embedder!",
render:b.render.name});return}n.addGlobalListener(d);n.embed()};e.errorScreen=function(a){g||(g=!0,c.api.displayError(a,b))};(function(){f.foreach(h.config.events,function(a,b){a=h[a];"function"===f.typeOf(a)&&a.call(h,b)})})()}})(playease);
(function(c){var f=c.utils,a=c.embed,p=c.core.renders.modes,h=c.core.skins.modes;a.config=function(a){return f.extend({},{url:"http://"+window.location.host+"/vod/sample.flv",width:640,height:360,cors:"no-cors",bufferTime:.1,controls:!0,autoplay:!0,poster:null,render:{name:p.DEFAULT},skin:{name:h.DEFAULT}},a)};a.config.addConfig=function(a,c){return f.extend(a,c)}})(playease);
(function(c){var f=c.utils,a=c.events,p=c.core;c.embed.embedder=function(c,d){function e(a){b.dispatchEvent(a.type,a)}var b=f.extend(this,new a.eventdispatcher("embed.embedder"));b.embed=function(){var a=new p.entity(d);a.addGlobalListener(e);a.setup();c.setEntity(a,d.render.name)}}})(playease);