playease=function(){if(playease.api)return playease.api.getInstance.apply(this,arguments)};playease.version="0.0.06";
(function(c){function h(a){return null!==navigator.userAgent.toLowerCase().match(a)}var a=c.utils={};a.exists=function(f){switch(a.typeOf(f)){case "string":return 0<f.length;case "object":return null!==f;case "null":return!1}return!0};a.extend=function(){var f=Array.prototype.slice.call(arguments,0),b=f[0];if(1<f.length)for(var e=1;e<f.length;e++)a.foreach(f[e],function(a,f){void 0!==f&&null!==f&&(b[a]=f)});return b};a.foreach=function(f,b){for(var e in f)f.hasOwnProperty&&"function"===a.typeOf(f.hasOwnProperty)?
f.hasOwnProperty(e)&&b(e,f[e]):b(e,f[e])};a.getCookie=function(a){var b;return(b=document.cookie.match(new RegExp("(^| )"+a+"=([^;]*)(;|$)")))?unescape(b[2]):null};a.formatTime=function(f){var b=f.getHours()+1,e=f.getMinutes(),d=f.getSeconds();return f.toLocaleDateString()+" "+a.pad(b,2)+":"+a.pad(e,2)+":"+a.pad(d,2)};a.pad=function(a,b){for(var e=a+"";e.length<b;)e="0"+e;return e};a.createElement=function(a,b){var e=document.createElement(a);b&&(e.className=b);return e};a.addClass=function(f,b){var e=
"string"===a.typeOf(f.className)?f.className.split(" "):[],d="array"===a.typeOf(b)?b:b.split(" ");a.foreach(d,function(d,f){-1===a.indexOf(e,f)&&e.push(f)});f.className=a.trim(e.join(" "))};a.removeClass=function(f,b){var e="string"===a.typeOf(f.className)?f.className.split(" "):[],d="array"===a.typeOf(b)?b:b.split(" ");a.foreach(d,function(d,f){var b=a.indexOf(e,f);0<=b&&e.splice(b,1)});f.className=a.trim(e.join(" "))};a.emptyElement=function(a){for(;a.firstChild;)a.removeChild(a.firstChild)};a.typeOf=
function(a){if(null===a||void 0===a)return"null";var b=typeof a;if("object"===b)try{if("[object Array]"===toString.call(a))return"array"}catch(e){}return b};a.trim=function(a){return a.replace(/^\s+|\s+$/g,"")};a.indexOf=function(a,b){if(null==a)return-1;for(var e=0;e<a.length;e++)if(a[e]===b)return e;return-1};a.isMSIE=function(a){return a?(a=parseFloat(a).toFixed(1),h(new RegExp("msie\\s*"+a,"i"))):h(/msie/i)};var p=window.console=window.console||{log:function(){}};a.log=function(){var f=Array.prototype.slice.call(arguments,
0);"object"===a.typeOf(p.log)?p.log(f):p.log.apply(p,f)}})(playease);(function(c){c=c.utils;c.littleEndian=function(){var c=new ArrayBuffer(2);(new DataView(c)).setInt16(0,256,!0);return 256===(new Int16Array(c))[0]}();c.getUint32=function(c,a,p){void 0==a&&(a=0);return p?c[a+0]|c[a+1]>>>8|c[a+2]>>>16|c[a+3]>>>24:c[a+0]<<24|c[a+1]<<16|c[a+2]<<8|c[a+3]}})(playease);
(function(c){function h(){var a=document.createElement("style");a.type="text/css";document.getElementsByTagName("head")[0].appendChild(a);return a.sheet||a.styleSheet}var a=c.utils,p;(a.css=function(f,b){p||(p=h());var e="";a.foreach(b,function(a,b){e+=a+": "+b+"; "});try{p.insertRule?p.insertRule(f+" { "+e+"}",p.cssRules.length):p.addRule(f,e,p.rules.length)}catch(d){a.log("Failed to insert css rule: "+f)}}).style=function(f,b,e){if(void 0!==f&&null!==f)for(void 0===f.length&&(f=[f]),b=a.extend({},
b),e=0;e<f.length;e++){var d=f[e];void 0!==d&&null!==d&&a.foreach(b,function(a,e){var b;b=a.split("-");for(var f=1;f<b.length;f++)b[f]=b[f].charAt(0).toUpperCase()+b[f].slice(1);b=b.join("");d.style[b]!==e&&(d.style[b]=e)})}}})(playease);
(function(c){c.events={ERROR:"error",PLAYEASE_READY:"playeaseReady",PLAYEASE_SETUP_ERROR:"playeaseSetupError",PLAYEASE_RENDER_ERROR:"playeaseRenderError",PLAYEASE_STATE:"playeaseState",PLAYEASE_METADATA:"playeaseMetaData",PLAYEASE_BUFFER:"playeaseBuffer",PLAYEASE_PLAY:"playeasePlay",PLAYEASE_PAUSE:"playeasePause",PLAYEASE_SEEK:"playeaseSeek",PLAYEASE_STOP:"playeaseStop",PLAYEASE_VIEW_PLAY:"playeaseViewPlay",PLAYEASE_VIEW_PAUSE:"playeaseViewPause",PLAYEASE_VIEW_SEEK:"playeaseViewSeek",PLAYEASE_VIEW_STOP:"playeaseViewStop",
PLAYEASE_VIEW_VOLUME:"playeaseViewVolume",PLAYEASE_VIEW_MUTE:"playeaseViewMute",PLAYEASE_VIEW_FULLSCREEN:"playeaseViewFullscreen",PLAYEASE_CONTENT_LENGTH:"playeaseContentLength",PLAYEASE_PROGRESS:"playeaseProgress",PLAYEASE_COMPLETE:"playeaseComplete",PLAYEASE_FLV_TAG:"playeaseFlvTag",PLAYEASE_AVC_CONFIG_RECORD:"playeaseAVCConfigRecord",PLAYEASE_AVC_SAMPLE:"playeaseAVCSample",PLAYEASE_AAC_SPECIFIC_CONFIG:"playeaseAACSpecificConfig",PLAYEASE_AAC_SAMPLE:"playeaseAACSample",PLAYEASE_MP4_INIT_SEGMENT:"playeaseMp4InitSegment",
PLAYEASE_MP4_SEGMENT:"playeaseMp4Segment",PLAYEASE_END_OF_STREAM:"playeaseEndOfStream"}})(playease);
(function(c){var h=c.utils;c.events.eventdispatcher=function(a){function p(a,d,b){if(a)for(var f=0;f<a.length;f++){var c=a[f];if(c){null!==c.count&&0===--c.count&&delete a[f];try{c.listener(d)}catch(m){h.log('Error handling "'+b+'" event listener ['+f+"]: "+m.toString(),c.listener,d)}}}}var f={},b=[];this.addEventListener=function(a,d,b){try{h.exists(f[a])||(f[a]=[]),"string"===h.typeOf(d)&&(d=(new Function("return "+d))()),f[a].push({listener:d,count:b||null})}catch(c){h.log("error",c)}return!1};
this.removeEventListener=function(a,d){if(f[a]){try{if(void 0===d){f[a]=[];return}var b;for(b=0;b<f[a].length;b++)if(f[a][b].listener.toString()===d.toString()){f[a].splice(b,1);break}}catch(c){h.log("error",c)}return!1}};this.addGlobalListener=function(a,d){try{"string"===h.typeOf(a)&&(a=(new Function("return "+a))()),b.push({listener:a,count:d||null})}catch(f){h.log("error",f)}return!1};this.removeGlobalListener=function(a){if(a){try{var d;for(d=b.length-1;0<=d;d--)b[d].listener.toString()===a.toString()&&
b.splice(d,1)}catch(f){h.log("error",f)}return!1}};this.dispatchEvent=function(e,d){d||(d={});h.extend(d,{id:a,version:c.version,type:e});c.debug&&h.log(e,d);p(f[e],d,e);p(b,d,e)}}})(playease);
(function(c){var h=c.utils,a=c.events;h.loader=function(c){var f=h.extend(this,new a.eventdispatcher("utils.loader")),b={method:"GET",headers:{},mode:"cors",cache:"default"},e,d;f.load=function(b){e=b;fetch?fetch(e,f.config).then(function(b){if(d)d=!1;else{if(b.ok&&200<=b.status&&299>=b.status){var e=b.headers.get("Content-Length");e&&(e=parseInt(e),f.dispatchEvent(a.PLAYEASE_CONTENT_LENGTH,{length:e}));return f.pump(b.body.getReader())}f.dispatchEvent(a.ERROR,{message:"Loader error: Invalid http status("+
b.status+" "+b.statusText+")."})}}).catch(function(b){f.dispatchEvent(a.ERROR,{message:"Loader error: "+b.message})}):f.dispatchEvent(a.ERROR,{message:"Loader error: Fetch is not supported."})};f.pump=function(b){return b.read().then(function(e){if(e.done)f.dispatchEvent(a.PLAYEASE_COMPLETE);else{if(d)return d=!1,b.cancel();f.dispatchEvent(a.PLAYEASE_PROGRESS,{data:e.value.buffer});return f.pump(b)}}).catch(function(b){f.dispatchEvent(a.ERROR,{message:"Loader error: Failed to read response data."})})};
f.abort=function(){d=!0};(function(){f.config=h.extend({},b,c);var a=new Headers,e;for(e in f.config.headers)a.append(e,f.config.headers[e]);f.config.headers=a;d=!1})()}})(playease);
(function(c){var h=c.utils,a=c.events,p={},f={onError:a.ERROR,onReady:a.PLAYEASE_READY,onMetaData:a.PLAYEASE_METADATA,onBuffer:a.PLAYEASE_BUFFER,onPlay:a.PLAYEASE_PLAY,onPause:a.PLAYEASE_PAUSE,onSeek:a.PLAYEASE_SEEK,onStop:a.PLAYEASE_STOP,onVolume:a.PLAYEASE_VIEW_VOLUME,onMute:a.PLAYEASE_VIEW_MUTE,onFullscreen:a.PLAYEASE_VIEW_FULLSCREEN};c.api=function(b){function e(a){d.dispatchEvent(a.type,a)}var d=h.extend(this,new a.eventdispatcher("api")),k;d.container=b;d.id=b.id;d.setup=function(a){h.emptyElement(d.container);
c.debug=!!a.debug;d.config=a;d.config.id=d.id;d.embedder=new c.embed(d);d.embedder.addGlobalListener(e);d.embedder.embed();return d};d.setEntity=function(a,b){k=a;d.renderName=b;d.play=k.play;d.pause=k.pause;d.seek=k.seek;d.stop=k.stop;d.volume=k.volume;d.mute=k.mute;d.fullscreen=k.fullscreen;d.resize=k.resize};(function(){h.foreach(f,function(a,b){d[a]=function(a){d.addEventListener(b,a)}})})()};c.api.getInstance=function(a){var f;null==a?a=0:a.nodeType?f=a:"string"===h.typeOf(a)&&(f=document.getElementById(a));
if(f){var d=p[f.id];d||(p[a]=d=new c.api(f));return d}return"number"===h.typeOf(a)?p[a]:null};c.api.displayError=function(a,f){}})(playease);(function(c){c.muxer={}})(playease);
(function(c){var h=c.utils,a=c.muxer.AMF={},p=a.types={DOUBLE:0,BOOLEAN:1,STRING:2,OBJECT:3,MOVIE_CLIP:4,NULL:5,UNDEFINED:6,REFERENCE:7,MIXED_ARRAY:8,END_OF_OBJECT:9,ARRAY:10,DATE:11,LONG_STRING:12,UNSUPPORTED:13,RECORD_SET:14,XML:15,TYPED_OBJECT:16,AMF3_DATA:17};a.parse=function(f,b,e){var d={};try{var c=a.parseValue(f,b,e),p=a.parseValue(f,b+c.size,e-c.size);d.key=c.data;d.value=p.data}catch(l){h.log("AMF.parse() failed. Error: "+l)}return d};a.parseObject=function(f,b,e){if(3>e)throw"Data not enough while parsing AMF object.";
for(var d={},c=0,h,l={ended:!1};!l.ended&&c<e;)h=a.parseString(f,b+c,e-c),c+=h.size,l=a.parseValue(f,b+c,e-c),c+=l.size,h.data&&l.data&&(d[h.data]=l.data);return{data:d,size:c,ended:l.ended}};a.parseString=function(a,b,e){if(2>e)throw"Data not enough while parsing AMF string.";var d=0;e=(new DataView(a,b,e)).getUint16(d);var d=d+2,c=void 0,c=0<e?String.fromCharCode.apply(String,new Uint8Array(a,b+d,e)):"";return{data:c,size:d+e}};a.parseLongString=function(a,b,e){if(4>e)throw"Data not enough while parsing AMF long string.";
var d=0;e=(new DataView(a,b,e)).getUint32(d);var d=d+4,c=void 0,c=0<e?String.fromCharCode.apply(String,new Uint8Array(a,b+d,e)):"";return{data:c,size:d+e}};a.parseDate=function(a,b,e){if(10>e)throw"Data not enough while parsing AMF date.";e=new DataView(a,b,e);a=0;b=e.getFloat64(a);a+=8;e=e.getInt16(a);return{data:new Date(b+6E4*e),size:a+2}};a.parseValue=function(f,b,e){if(1>e)throw"Data not enough while parsing AMF value.";var d=new DataView(f,b,e),c=0,n=d.getUint8(c),c=c+1,l=void 0,m=!1;try{switch(n){case p.DOUBLE:l=
d.getFloat64(c);c+=8;break;case p.BOOLEAN:l=d.getUint8(c)?!0:!1;c+=1;break;case p.STRING:var x=a.parseString(f,b+c,e-c),l=x.data,c=c+x.size;break;case p.OBJECT:var D=a.parseObject(f,b+c,e-c),l=D.data,c=c+D.size;break;case p.MIXED_ARRAY:var y=d.getUint32(c),c=c+4,w=a.parseObject(f,b+c,e-c),l=w.data,c=c+w.size;break;case p.END_OF_OBJECT:l=void 0;m=!0;break;case p.ARRAY:y=d.getUint32(c);c+=4;l=[];for(d=0;d<y;d++){var H=a.parseValue(f,b+c,e-c);l.push(H.data);c+=H.size}break;case p.DATE:var g=a.parseDate(f,
b+c,e-c),l=g.data,c=c+g.size;break;case p.LONG_STRING:var I=a.parseString(f,b+c,e-c),l=I.data,c=c+I.size;break;default:h.log("Skipping unsupported AMF value type("+n+")."),c+=e}}catch(q){h.log("AMF.parseValue() failed. Error: "+q)}return{data:l,size:c,ended:m}}})(playease);
(function(c){var h=function(a){function c(){var a=h-d;if(0>=a)throw"Data not enough while filling current word.";var a=Math.min(4,a),b=new Uint8Array(4);b.set(e.subarray(d,d+a));n=(new DataView(b.buffer)).getUint32(0,!1);d+=a;l=8*a}function f(){var a;for(a=0;a<l;a++)if(0!==(n&2147483648>>>a))return n<<=a,l-=a,a;c();return a+f()}var b=this,e,d,h,n,l;b.readBits=function(a){if(32<a)throw"Data not enough while reading bits of ExpGolomb.";if(a<=l){var b=n>>>32-a;n<<=a;l-=a;return b}b=l?n:0;b>>>=32-l;a-=
l;c();a=Math.min(a,l);var d=n>>>32-a;n<<=a;l-=a;return b<<a|d};b.readBool=function(){return 1===b.readBits(1)};b.readByte=function(){return b.readBits(8)};b.readUEG=function(){var a=f();return b.readBits(a+1)-1};b.readSEG=function(){var a=b.readUEG();return a&1?a+1>>>1:-1*(a>>>1)};b.destroy=function(){e=null};e=a;d=0;h=a.byteLength;l=n=0};(c.muxer.SPS={}).parse=function(a){for(var c=a.byteLength,f=new Uint8Array(c),b=0,e=0;e<c;e++)2<=e&&3===a[e]&&0===a[e-1]&&0===a[e-2]||(f[b]=a[e],b++);a=new Uint8Array(f.buffer,
0,b);a=new h(a);a.readByte();var d=a.readByte();a.readByte();f=a.readByte();a.readUEG();switch(d){case 66:c="Baseline";break;case 77:c="Main";break;case 88:c="Extended";break;case 100:c="High";break;case 110:c="High10";break;case 122:c="High422";break;case 244:c="High444";break;default:c="Unknown"}var f=(f/10).toFixed(1),k=1,b=420,n=[0,420,422,444],e=8;if(100===d||110===d||122===d||244===d||44===d||83===d||86===d||118===d||128===d||138===d||144===d)if(k=a.readUEG(),3===k&&a.readBits(1),3>=k&&(b=n[k]),
e=a.readUEG()+8,a.readUEG(),a.readBits(1),a.readBool())for(d=3!==k?8:12,n=0;n<d;n++)if(a.readBool())for(var l=a,m=6>n?16:64,x=8,D=8,y=0,w=0;w<m;w++)0!==D&&(y=l.readSEG(),D=(x+y+256)%256),x=0===D?x:D;a.readUEG();d=a.readUEG();if(0===d)a.readUEG();else if(1===d)for(a.readBits(1),a.readSEG(),a.readSEG(),d=a.readUEG(),n=0;n<d;n++)a.readSEG();a.readUEG();a.readBits(1);var H=a.readUEG(),y=a.readUEG(),w=a.readBits(1);0===w&&a.readBits(1);a.readBits(1);var g=0,I=0,q=0,E=0;a.readBool()&&(g=a.readUEG(),I=a.readUEG(),
q=a.readUEG(),E=a.readUEG());n=d=1;x=0;l=!0;D=m=0;if(a.readBool()){if(a.readBool()){var z=a.readByte(),G=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],t=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];0<z&&16>z?(d=G[z-1],n=t[z-1]):255===z&&(d=a.readByte()<<8|a.readByte(),n=a.readByte()<<8|a.readByte())}a.readBool()&&a.readBool();a.readBool()&&(a.readBits(4),a.readBool()&&a.readBits(24));a.readBool()&&(a.readUEG(),a.readUEG());a.readBool()&&(x=a.readBits(32),m=a.readBits(32),l=a.readBool(),D=2*x,x=
m/D)}z=1;if(1!==d||1!==n)z=d/n;G=t=0;0===k?(t=1,G=2-w):(t=3===k?1:2,G=(1===k?2:1)*(2-w));k=16*(H+1)-(g+I)*t;y=16*(2-w)*(y+1)-(q+E)*G;w=Math.ceil(k*z);a.destroy();switch(b){case 420:a="4:2:0";break;case 422:a="4:2:2";break;case 444:a="4:4:4";break;default:a="Unknown"}return{profile_string:c,level_string:f,bit_depth:e,chroma_format:b,chroma_format_string:a,frame_rate:{fixed:l,fps:x,fps_den:D,fps_num:m},sar_ratio:{width:d,height:n},codec_size:{width:k,height:y},present_size:{width:w,height:y}}}})(playease);
(function(c){var h=c.utils,a=c.events;c=c.muxer;var p=c.SPS,f={AUDIO:8,VIDEO:9,SCRIPT:18},b={KEYFRAME:1,INTER_FRAME:2,DISPOSABLE_INTER_FRAME:3,GENERATED_KEYFRAME:4,INFO_OR_COMMAND_FRAME:5},e={types:{SEQUENCE_HEADER:0,NALU:1,END_OF_SEQUENCE:2}},d={types:{SPECIFIC_CONFIG:0,RAW_FRAME_DATA:1},audioObjectTypes:{NULL:0,AAC_MAIN:1,AAC_LC:2,AAC_SSR:3,AAC_LTP:4,AAC_HE_OR_SBR:5,AAC_SCALABLE:6},samplingRates:[96E3,88200,64E3,48E3,44100,32E3,24E3,22050,16E3,12E3,11025,8E3,7350]},k=[5500,11025,22050,44100],n=
function(){var a=this;a.isComplete=function(){var b=!1===a.hasAudio||!0===a.hasAudio&&null!=a.audioCodec&&null!=a.audioSampleRate&&null!=a.audioChannelCount,c=!1===a.hasVideo||!0===a.hasVideo&&null!=a.videoCodec&&null!=a.width&&null!=a.height&&null!=a.fps&&null!=a.profile&&null!=a.level&&null!=a.chromaFormat&&null!=a.sarNum&&null!=a.sarDen;return null!=a.mimeType&&null!=a.duration&&null!=a.metadata&&null!=a.hasKeyframesIndex&&b&&c};a.isSeekable=function(){return!0===a.hasKeyframesIndex};a.getNearestKeyframe=
function(b){if(null==a.keyframesIndex)return null;var c=a.keyframesIndex,d=c.times,f=0,e=d.length-1,h=0,g=0,p=e;b<d[0]&&(f=0,g=p+1);for(;g<=p;)if(h=g+Math.floor((p-g)/2),h===e||b>=d[h]&&b<d[h+1]){f=h;break}else d[h]<b?g=h+1:p=h-1;b=f;return{index:b,milliseconds:c.times[b],fileposition:c.filepositions[b]}}};c.flv=function(c){var m=h.extend(this,new a.eventdispatcher("muxer.flv")),x,D,y,w,H,g,I,q,E,z,G,t,C,J,v,B,A,O;m.parse=function(b){var c=new Uint8Array(b),d=0;if(1==y){if(13>b.byteLength)return 0;
d=m.probe(b);y=4;var e=h.getUint32(c,d);e&&h.log("First tag size "+e);d+=4;y=2}for(;d<b.byteLength;)switch(y){case 2:q[g.position++]=c[d++];11==g.position&&(z=q[1]<<16|q[2]<<8|q[3],y=3);break;case 3:var B=q[0],A=q[1]<<16|q[2]<<8|q[3],t=q[4]<<16|q[5]<<8|q[6]|q[7]<<24,e=q[8]<<16|q[9]<<8|q[10];0!=e&&h.log("Unknown stream ID "+e);e={tag:B,data:b,offset:d,size:A};switch(B){case f.AUDIO:e.timestamp=t;z==A&&(e.format=c[d]>>>4,e.rate=k[(c[d]&12)>>>2],e.samplesize=(c[d]&2)>>>1,e.sampletype=c[d]&1);break;case f.VIDEO:e.timestamp=
t;z==A&&(e.frametype=c[d]>>>4,e.codec=c[d]&15);break;case f.SCRIPT:e.hasAudio=w,e.hasVideo=H}B=Math.min(b.byteLength-d,z);z-=B;d+=B;if(z){G.push(e);break}if(G.length){e=G[0];A=new Uint8Array(A);for(A.position=0;G.length;)t=G.shift(),B=new Uint8Array(t.data.slice(t.offset)),A.set(B,A.position),A.position+=t.data.byteLength-t.offset;B=new Uint8Array(b.slice(0,d));A.set(B,A.position);e.data=A.buffer;e.offset=0}y=4;I.position=0;m.dispatchEvent(a.PLAYEASE_FLV_TAG,e);break;case 4:E[I.position++]=c[d++];
4==I.position&&(A=q[1]<<16|q[2]<<8|q[3],e=h.getUint32(E),e!=11+A&&h.log("prevTagSize("+e+") is not equals to "+(11+A)+"."),y=2,g.position=0);break;default:h.log("Unknown parsing state "+y);return}};m.parseAVCVideoPacket=function(c,d,f,B,g){if(5>f)m.dispatchEvent(a.ERROR,{message:"Data not enough while parsing AVC video packet."});else{var l=new DataView(c,d,f),F=1,k=l.getUint8(F++),l=l.getUint8(F++)<<16|l.getUint8(F++)<<8|l.getUint8(F++);switch(k){case e.types.SEQUENCE_HEADER:l=d+F;d=f-F;if(7>d)m.dispatchEvent(a.ERROR,
{message:"Data not enough while parsing AVC decoder configuration record."});else if(f=v,f={type:f.type,id:f.id,timescale:1E3,duration:1E3*C.duration||0},F=new DataView(c,l,d),k=0,g=F.getUint8(k++),B=F.getUint8(k++),F.getUint8(k++),F.getUint8(k++),1!=g||0==B)m.dispatchEvent(a.ERROR,{message:"Invalid AVCDecoderConfigurationRecord."});else if(A=1+(F.getUint8(k++)&3),3!=A&&4!=A)m.dispatchEvent(a.ERROR,{message:"Invalid lengthSizeMinusOne "+A+"."});else{B=F.getUint8(k++)&31;for(g=0;g<B;g++){var r=F.getUint16(k),
k=k+2;if(0!=r){var n=new Uint8Array(c,l+k,r),k=k+r,r=p.parse(n),u=f,q=r;u.codecWidth=q.codec_size.width;u.codecHeight=q.codec_size.height;u.presentWidth=q.present_size.width;u.presentHeight=q.present_size.height;u.profile=q.profile_string;u.level=q.level_string;u.bitDepth=q.bit_depth;u.chromaFormat=q.chroma_format;u.sarRatio=q.sar_ratio;u.frameRate=q.frame_rate;if(!1===q.frame_rate.fixed||0===q.frame_rate.fps_num||0===q.frame_rate.fps_den)u.frameRate=J;u.refSampleDuration=Math.floor(u.frameRate.fps_den/
u.frameRate.fps_num*u.timescale);for(var n=n.subarray(1,4),q="avc1.",E=0;3>E;E++){var L=n[E].toString(16);2>L.length&&(L="0"+L);q+=L}u.codec=q;u=f;t.hasAudio=w;t.hasVideo=H;t.duration=1E3*C.duration;t.metadata=C;t.width=u.codecWidth;t.height=u.codecHeight;t.fps=u.frameRate.fps;t.profile=u.profile;t.level=u.level;t.chromaFormat=r.chroma_format_string;t.sarNum=u.sarRatio.width;t.sarDen=u.sarRatio.height;t.videoCodec=u.codec;t.mimeType='video/mp4; codecs="'+t.videoCodec+(t.hasAudio&&t.audioCodec?","+
t.audioCodec:"")+'"';m.dispatchEvent(a.PLAYEASE_MEDIA_INFO,{info:t})}}B=F.getUint8(k++);for(g=0;g<B;g++)r=F.getUint16(k),k+=2,0!=r&&(new Uint8Array(c,l+k,r),k+=r);f.avcc=new Uint8Array(d);f.avcc.set(new Uint8Array(c,l,d),0);m.dispatchEvent(a.PLAYEASE_AVC_CONFIG_RECORD,{data:f})}break;case e.types.NALU:a:{d+=F;f-=F;F=new DataView(c,d,f);k=[];B=O+B;g=g==b.KEYFRAME;for(u=r=0;r<f;){if(r+4>=f){m.dispatchEvent(a.ERROR,{message:"Data not enough for next NALU."});break a}n=F.getUint32(r);3==n&&(n>>>=8);if(n>
f-A){h.log("Malformed Nalus near timestamp "+B+".");break a}q=F.getUint8(r+A)&31;q==b.INFO_OR_COMMAND_FRAME&&(g=!0);E=new Uint8Array(c,d+r,A+n);u+=E.byteLength;k.push({type:q,data:E});r+=A+n}0!=k.length&&(v.samples.push({units:k,length:u,isKeyframe:g,cts:l,dts:B,pts:l+B}),v.length+=u,m.dispatchEvent(a.PLAYEASE_AVC_SAMPLE,{data:v}))}break;case e.types.END_OF_SEQUENCE:m.dispatchEvent(a.PLAYEASE_END_OF_STREAM);break;default:m.dispatchEvent(a.ERROR,{message:"Unknown AVC video packet type "+k+"."})}}};
m.parseAACAudioPacket=function(c,b,f,e,g,A,h){if(2>f)m.dispatchEvent(a.ERROR,{message:"Data not enough while parsing AAC audio packet."});else{A=1;var l=(new DataView(c,b,f)).getUint8(A++);switch(l){case d.types.SPECIFIC_CONFIG:e=b+A;b=f-A;3>b?m.dispatchEvent(a.ERROR,{message:"Data not enough while parsing AAC audio specific config."}):(f=B,f={type:f.type,id:f.id,timescale:1E3,duration:1E3*C.duration||0},f.audioSampleRate=g,f.channelCount=0===h?1:2,f.refSampleDuration=Math.floor(1024/f.audioSampleRate*
f.timescale),f.codec="mp4a.40.5",e=new DataView(c,e,b),b=0,h=e.getUint8(b)>>>3,c=(e.getUint8(b++)&7)<<1|e.getUint8(b)>>>7,0>c||c>=d.samplingRates.length?m.dispatchEvent(a.ERROR,{message:"Invalid AAC sampling frequency index.",index:c}):(g=(e.getUint8(b)&120)>>>3,0>g||8<=g?m.dispatchEvent(a.ERROR,{message:"Invalid AAC channel configuration.",config:g}):(h===d.audioObjectTypes.AAC_HE_OR_SBR&&(e.getUint8(b++),e.getUint8(b),e.getUint8(b)),h=self.navigator.userAgent.toLowerCase(),-1!==h.indexOf("firefox")?
c>=d.audioObjectTypes.AAC_SCALABLE?(h=d.audioObjectTypes.AAC_HE_OR_SBR,e=c-3,b=Array(4)):(h=d.audioObjectTypes.AAC_LC,e=c,b=Array(2)):-1!==h.indexOf("android")?(h=d.audioObjectTypes.AAC_LC,e=c,b=Array(2)):(h=d.audioObjectTypes.AAC_HE_OR_SBR,e=c,b=Array(4),c>=d.audioObjectTypes.AAC_SCALABLE?e=c-3:1===g&&(h=2,e=c,b=Array(2))),b[0]=h<<3,b[0]|=(c&15)>>>1,b[1]=(c&15)<<7,b[1]|=(g&15)<<3,h===d.audioObjectTypes.AAC_HE_OR_SBR&&(b[1]|=(e&15)>>>1,b[2]=(e&1)<<7,b[2]|=8,b[3]=0),f.codec="mp4a.40."+h,f.config=b,
t.audioCodec=f.codec,t.audioSampleRate=f.audioSampleRate,t.audioChannelCount=f.channelCount,t.mimeType='video/mp4; codecs="'+t.videoCodec+(t.hasAudio&&t.audioCodec?","+t.audioCodec:"")+'"',m.dispatchEvent(a.PLAYEASE_MEDIA_INFO,{info:t}),m.dispatchEvent(a.PLAYEASE_AAC_SPECIFIC_CONFIG,{data:f}))));break;case d.types.RAW_FRAME_DATA:f=new Uint8Array(c,b+A,f-A);c=O+e;B.samples.push({unit:f,dts:c,pts:c});B.length+=f.length;m.dispatchEvent(a.PLAYEASE_AAC_SAMPLE,{data:B});break;default:m.dispatchEvent(a.ERROR,
{message:"Unknown AAC audio packet type "+l+"."})}}};m.probe=function(a){a=new Uint8Array(a);if(70!==a[0]||76!==a[1]||86!==a[2]||1!==a[3])return 0;w=0!==(a[4]&4)>>>2;H=0!==(a[4]&1);if(!w&&!H)return 0;a=h.getUint32(a,5);return 9>a?0:a};m.setMetaData=function(a){C=a;if("number"===typeof C.framerate&&(a=Math.floor(1E3*C.framerate),0<a)){var b=a/1E3;J.fixed=!0;J.fps=b;J.fps_num=a;J.fps_den=1E3;t.fps=b}t.hasKeyframesIndex="object"===typeof C.keyframes?!0:!1};m.getMetaData=function(){return C};m.offset=
function(){return x};m.length=function(){return D};m.destroy=function(){};m.config=h.extend({},{},c);D=x=0;y=1;g=new ArrayBuffer(11);g.position=0;q=new Uint8Array(g);I=new ArrayBuffer(4);I.position=0;E=new Uint8Array(I);z=0;G=[];t=new n;J={fixed:!0,fps:23.976,fps_num:23976,fps_den:1E3};v={type:"video",id:1,sequenceNumber:0,samples:[],length:0};B={type:"audio",id:2,sequenceNumber:0,samples:[],length:0};O=A=0};c.flv.TAG=f;c.flv.FORMATS={LINEAR_PCM_PLATFORM_ENDIAN:0,ADPCM:1,MP3:2,LINEAR_PCM_LITTLE_ENDIAN:3,
NELLYMOSER_16_kHz_MONO:4,NELLYMOSER_8_kHz_MONO:5,NELLYMOSER:6,G_711_A_LAW_LOGARITHMIC_PCM:7,G_711_MU_LAW_LOGARITHMIC_PCM:8,RESERVED:9,AAC:10,SPEEX:11,MP3_8_kHz:14,DEVICE_SPECIFIC_SOUND:15};c.flv.FRAMES=b;c.flv.CODECS={JPEG:1,H263:2,SCREEN_VIDEO:3,VP6:4,VP6_ALPHA:5,SCREEN_VIDEO_2:6,AVC:7};c.flv.AVC=e;c.flv.AAC=d})(playease);
(function(c){var h=c.utils,a=c.events;c=c.muxer;var p=c.flv.AAC,f,b,e,d,k,n,l,m,x;f=new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]);b=new Uint8Array([0,0,0,0,0,0,0,1]);e=new Uint8Array([0,0,0,0,0,0,0,0]);d=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]);k=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]);n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,
108,101,114,0]);l=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]);m=new Uint8Array([0,0,0,0,0,0,0,0]);x=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]);p.getSilentFrame=function(a){return 1===a?new Uint8Array([0,200,0,128,35,128]):2===a?new Uint8Array([33,0,73,144,2,25,0,35,128]):3===a?new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]):4===a?new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]):5===a?new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,
0,33,144,2,56]):6===a?new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]):null};var D=function(a,b,c,d,f){this.dts=a;this.pts=b;this.duration=c;this.originalDts=d;this.isSyncPoint=f;this.fileposition=null},y=function(){var a=[];this.appendSyncPoint=function(b){b.isSyncPoint=!0;a.push(b)}},w=function(a){var b=this,c=[],d=-1;b.searchNearestSegmentBefore=function(a){if(0===c.length)return-2;var b=c.length-1,d=0,f=0,e=b,g=0;if(a<c[0].originalBeginDts)return-1;
for(;f<=e;){d=f+Math.floor((e-f)/2);if(d===b||a>c[d].lastSample.originalDts&&a<c[d+1].originalBeginDts){g=d;break}c[d].originalBeginDts<a?f=d+1:e=d-1}return g};b.searchNearestSegmentAfter=function(a){return b.searchNearestSegmentBefore(a)+1};b.append=function(a){var f=d,e=0;-1!==f&&f<c.length&&a.originalBeginDts>=c[f].lastSample.originalDts&&(f===c.length-1||f<c.length-1&&a.originalBeginDts<c[f+1].originalBeginDts)?e=f+1:0<c.length&&(e=b.searchNearestSegmentBefore(a.originalBeginDts)+1);d=e;c.splice(e,
0,a)};b.getLastSegmentBefore=function(a){a=b.searchNearestSegmentBefore(a);return 0>a?null:c[a]};b.getLastSampleBefore=function(a){a=b.getLastSegmentBefore(a);return null==a?null:a.lastSample};b.getLastSyncPointBefore=function(a){a=b.searchNearestSegmentBefore(a);for(var d=c[a].syncPoints;0===d.length&&a--;)d=c[a].syncPoints;return 0>=d.length?null:d[d.length-1]};b.isEmpty=function(){return 0===c.length};b.clear=function(){c=[];d=-1}};c.mp4=function(c){var g=h.extend(this,new a.eventdispatcher("muxer.mp4")),
I={islive:!1},q,E,z,G,t,C,J,v={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};g.getInitSegment=function(b){var c=g.box(v.ftyp,f),d=g.moov(b),e=new Uint8Array(c.byteLength+d.byteLength);e.set(c,0);e.set(d,c.byteLength);g.dispatchEvent(a.PLAYEASE_MP4_INIT_SEGMENT,{tp:b.type,data:e})};
g.getVideoSegment=function(b){var c=b.samples,d=void 0,f=-1,e=-1,h=-1,l=-1;if(c&&0!==c.length){var e=0,k=8+b.length,p=new Uint8Array(k);p[e++]=k>>>24&255;p[e++]=k>>>16&255;p[e++]=k>>>8&255;p[e++]=k&255;p.set(v.mdat,e);for(var e=e+4,k=[],m=new y;c.length;){var l=c.shift(),n=l.isKeyframe,r=l.dts- -1;if(void 0==d)if(void 0==q)if(t.isEmpty())d=0;else if(d=t.getLastSampleBefore(r),null!=d){var C=r-(d.originalDts+d.duration);3>=C&&(C=0);d=r-(d.dts+d.duration+C)}else d=0;else d=r-q;var C=r-d,u=l.cts,w=C+
u;-1===f&&(f=C,h=w);for(var x=0;l.units.length;){var L=l.units.shift().data;p.set(L,e);e+=L.byteLength;x+=L.byteLength}L=0;L=1<=c.length?c[0].dts- -1-d-C:1<=k.length?k[k.length-1].duration:z.refSampleDuration;if(n){var J=new D(C,w,L,l.dts,!0);J.fileposition=l.fileposition;m.appendSyncPoint(J)}k.push({dts:C,pts:w,cts:u,size:x,isKeyframe:n,duration:L,originalDts:r,flags:{isLeading:0,dependsOn:n?2:1,isDependedOn:n?1:0,hasRedundancy:0,isNonSync:n?0:1}})}c=k[k.length-1];e=c.dts+c.duration;l=c.pts+c.duration;
q=e;m.beginDts=f;m.endDts=e;m.beginPts=h;m.endPts=l;m.originalBeginDts=k[0].originalDts;m.originalEndDts=c.originalDts+c.duration;m.firstSample=new D(k[0].dts,k[0].pts,k[0].duration,k[0].originalDts,k[0].isKeyframe);m.lastSample=new D(c.dts,c.pts,c.duration,c.originalDts,c.isKeyframe);g.config.islive||t.append(m);b.samples=k;b.sequenceNumber++;f=g.moof(b,f);b.samples=[];b.length=0;g.dispatchEvent(a.PLAYEASE_MP4_SEGMENT,{tp:"video",data:_mergeBoxes(f,p),sampleCount:k.length,info:m})}};g.getAudioSegment=
function(c){var b=c.samples,d=void 0,f=-1,e=-1,e=!1,k=-1;if(b&&0!==b.length){var l=0,m=8+c.length,n=new Uint8Array(m);n[l++]=m>>>24&255;n[l++]=m>>>16&255;n[l++]=m>>>8&255;n[l++]=m&255;n.set(v.mdat,l);for(var l=l+4,q=[];b.length;){var w=b.shift(),r=w.unit,x=w.dts- -1;if(void 0==d)if(void 0==E)if(C.isEmpty())d=0,J&&!t.isEmpty()&&(e=!0);else if(d=C.getLastSampleBefore(x),null!=d){var u=x-(d.originalDts+d.duration);3>=u&&(u=0);d=x-(d.dts+d.duration+u)}else d=0;else d=x-E;u=x-d;if(e){var z=t.getLastSegmentBefore(x);
null!=z&&z.beginDts<u?(k=u-z.beginDts,u=z.beginDts):e=!1}-1===f&&(f=u);e?(e=!1,b.unshift(w),r=u,x=k,w=p.getSilentFrame(G.channelCount),null==w?(h.log("Cannot generate silent aac frame, channelCount: "+G.channelCount+"."),r=null):r={unit:w,mp4Sample:{dts:r,pts:r,cts:0,size:w.byteLength,duration:x,originalDts:r,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}},null!=r&&(x=r.unit,q.push(r.mp4Sample),l=0,m+=x.byteLength,n=new Uint8Array(m),n[l++]=m>>>24&255,n[l++]=m>>>16&255,n[l++]=m>>>
8&255,n[l++]=m&255,n.set(v.mdat,l),l+=4,n.set(x,l),l+=x.byteLength)):(w=0,w=1<=b.length?b[0].dts- -1-d-u:1<=q.length?q[q.length-1].duration:G.refSampleDuration,q.push({dts:u,pts:u,cts:0,size:r.byteLength,duration:w,originalDts:x,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}),n.set(r,l),l+=r.byteLength)}k=q[q.length-1];E=e=k.dts+k.duration;b=new y;b.beginDts=f;b.endDts=e;b.beginPts=f;b.endPts=e;b.originalBeginDts=q[0].originalDts;b.originalEndDts=k.originalDts+k.duration;b.firstSample=
new D(q[0].dts,q[0].pts,q[0].duration,q[0].originalDts,!1);b.lastSample=new D(k.dts,k.pts,k.duration,k.originalDts,!1);g.config.islive||C.append(b);c.samples=q;c.sequenceNumber++;f=g.moof(c,f);c.samples=[];c.length=0;g.dispatchEvent(a.PLAYEASE_MP4_SEGMENT,{tp:"audio",data:_mergeBoxes(f,n),sampleCount:q.length,info:b})}};_mergeBoxes=function(a,b){var c=new Uint8Array(a.byteLength+b.byteLength);c.set(a,0);c.set(b,a.byteLength);return c};g.setVideoMeta=function(a){z=a};g.setAudioMeta=function(a){G=a};
g.box=function(a){for(var b=8,c=Array.prototype.slice.call(arguments,1),d=0;d<c.length;d++)b+=c[d].byteLength;var f=new Uint8Array(b),e=0;f[e++]=b>>>24&255;f[e++]=b>>>16&255;f[e++]=b>>>8&255;f[e++]=b&255;f.set(a,e);e+=4;for(d=0;d<c.length;d++)f.set(c[d],e),e+=c[d].byteLength;return f};g.moov=function(a){var b=g.mvhd(a.timescale,a.duration),c=g.trak(a);a=g.mvex(a);return g.box(v.moov,b,c,a)};g.mvhd=function(a,b){return g.box(v.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,a>>>24&255,a>>>16&255,a>>>
8&255,a&255,b>>>24&255,b>>>16&255,b>>>8&255,b&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))};g.trak=function(a){return g.box(v.trak,g.tkhd(a),g.mdia(a))};g.tkhd=function(a){var b=a.id,c=a.duration,d=a.presentWidth;a=a.presentHeight;return g.box(v.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,b>>>24&255,b>>>16&255,b>>>8&255,b&255,0,0,0,0,c>>>24&255,c>>>16&255,c>>>8&255,c&
255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,d>>>8&255,d&255,0,0,a>>>8&255,a&255,0,0]))};g.mdia=function(a){return g.box(v.mdia,g.mdhd(a),g.hdlr(a),g.minf(a))};g.mdhd=function(a){var b=a.timescale;a=a.duration;return g.box(v.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,b>>>24&255,b>>>16&255,b>>>8&255,b&255,a>>>24&255,a>>>16&255,a>>>8&255,a&255,85,196,0,0]))};g.hdlr=function(a){var b=null,b="audio"===a.type?n:k;return g.box(v.hdlr,b)};
g.minf=function(a){var b=null,b="audio"===a.type?g.box(v.smhd,m):g.box(v.vmhd,x);return g.box(v.minf,b,g.dinf(),g.stbl(a))};g.dinf=function(){return g.box(v.dinf,g.box(v.dref,l))};g.stbl=function(a){return g.box(v.stbl,g.stsd(a),g.box(v.stts,e),g.box(v.stsc,e),g.box(v.stsz,d),g.box(v.stco,e))};g.stsd=function(a){return"audio"===a.type?g.box(v.stsd,b,g.mp4a(a)):g.box(v.stsd,b,g.avc1(a))};g.mp4a=function(a){var b=a.audioSampleRate,b=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,a.channelCount,0,
16,0,0,0,0,b>>>8&255,b&255,0,0]);return g.box(v.mp4a,b,g.esds(a))};g.esds=function(a){a=a.config;var b=a.length;a=new Uint8Array([0,0,0,0,3,23+b,0,1,0,4,15+b,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([b]).concat(a).concat([6,1,2]));return g.box(v.esds,a)};g.avc1=function(a){var b=a.avcc,c=a.codecWidth;a=a.codecHeight;c=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,c>>>8&255,c&255,a>>>8&255,a&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return g.box(v.avc1,c,g.box(v.avcC,b))};g.mvex=function(a){return g.box(v.mvex,g.trex(a))};g.trex=function(a){a=a.id;a=new Uint8Array([0,0,0,0,a>>>24&255,a>>>16&255,a>>>8&255,a&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return g.box(v.trex,a)};g.moof=function(a,b){return g.box(v.moof,g.mfhd(a.sequenceNumber),g.traf(a,b))};g.mfhd=function(a){a=new Uint8Array([0,0,0,0,a>>>24&255,a>>>16&255,a>>>8&255,a&255]);return g.box(v.mfhd,a)};g.traf=function(a,b){var c=a.id,c=
g.box(v.tfhd,new Uint8Array([0,0,0,0,c>>>24&255,c>>>16&255,c>>>8&255,c&255])),d=g.box(v.tfdt,new Uint8Array([0,0,0,0,b>>>24&255,b>>>16&255,b>>>8&255,b&255])),e=g.sdtp(a),f=g.trun(a,e.byteLength+16+16+8+16+8+8);return g.box(v.traf,c,d,f,e)};g.sdtp=function(a){a=a.samples||[];for(var b=a.length,c=new Uint8Array(4+b),d=0;d<b;d++){var e=a[d].flags;c[d+4]=e.isLeading<<6|e.dependsOn<<4|e.isDependedOn<<2|e.hasRedundancy}return g.box(v.sdtp,c)};g.trun=function(a,b){var c=a.samples||[],d=c.length,e=12+16*
d,f=new Uint8Array(e);b+=8+e;f.set([0,0,15,1,d>>>24&255,d>>>16&255,d>>>8&255,d&255,b>>>24&255,b>>>16&255,b>>>8&255,b&255],0);for(e=0;e<d;e++){var h=c[e].duration,l=c[e].size,k=c[e].flags,m=c[e].cts;f.set([h>>>24&255,h>>>16&255,h>>>8&255,h&255,l>>>24&255,l>>>16&255,l>>>8&255,l&255,k.isLeading<<2|k.dependsOn,k.isDependedOn<<6|k.hasRedundancy<<4|k.isNonSync,0,0,m>>>24&255,m>>>16&255,m>>>8&255,m&255],12+16*e)}return g.box(v.trun,f)};g.mdat=function(a){return g.box(v.mdat,a)};g.destroy=function(){};(function(){g.config=
h.extend({},I,c);for(var a in v)v[a]=[a.charCodeAt(0),a.charCodeAt(1),a.charCodeAt(2),a.charCodeAt(3)];t=new w("video");C=new w("audio");J=!1})()}})(playease);(function(c){c.core={}})(playease);(function(c){c.core.states={BUFFERING:"buffering",PLAYING:"playing",SEEKING:"seeking",PAUSED:"paused",STOPPED:"stopped",ERROR:"error"}})(playease);(function(c){c.core.renders={}})(playease);(function(c){c.core.renders.modes={DEFAULT:"def"}})(playease);(function(c){c.core.renders.skins={}})(playease);
(function(c){c.core.renders.skins.modes={DEFAULT:"def"}})(playease);
(function(c){var h=c.utils,a=c.events,p=h.css;c.core.renders.skins.def=function(c){var b=h.extend(this,new a.eventdispatcher("skins.def"));b.name="def";p(".playerwrap",{width:c.width+"px",height:c.height+"px","box-shadow":"0 1px 1px rgba(0, 0, 0, 0.05)"});p(".playerwrap *",{margin:"0",padding:"0","font-family":"\u5fae\u8f6f\u96c5\u9ed1,arial,sans-serif","font-size":"14px","font-weight":"normal","box-sizing":"content-box"});p(".render",{width:c.width-2+"px",height:c.height-2+"px",border:"1px solid #1184ce",
"border-radius":"4px",position:"relative"});b.resize=function(a,d){h.log("Resizing to "+a+", "+d);c.width=parseInt(a);c.height=parseInt(d);var k=document.getElementById(c.id),n=document.getElementById(b.name+"render");p.style(k,{width:c.width+"px",height:c.height+"px"});p.style(n,{width:c.width-2+"px",height:c.height-2+"px"})}}})(playease);
(function(c){var h=c.utils,a=c.events;c=c.core.renders;var p=c.skins,f=p.modes;c.def=function(b,c){var d=h.extend(this,new a.eventdispatcher("renders.def")),k={minWidth:320,minHeight:180,skin:{name:f.DEFAULT}},n,l;d.display=function(a,b){};d.element=function(){return l};d.resize=function(a,b){a=a||l.offsetWidth||c.width;b=b||l.offsetHeight||c.height;n&&n.resize(Math.max(a,d.config.minWidth),Math.max(b,d.config.minHeight))};d.destroy=function(){};d.config=h.extend({},k,c);d.config.width=Math.max(d.config.width,
d.config.minWidth);d.config.height=Math.max(d.config.height,d.config.minHeight);l=h.createElement("div","render");try{n=new p[d.config.skin.name](d.config)}catch(m){h.log("Failed to init skin["+d.config.skin.name+"].")}n||d.dispatchEvent(a.PLAYEASE_RENDER_ERROR,{message:"Skin not found!",name:d.config.skin.name})}})(playease);
(function(c){var h=c.utils,a=c.events,p=c.core;p.entity=function(c){var b=h.extend(this,new a.eventdispatcher("core.entity")),e,d,k;b.setup=function(){d.setup()};b.destroy=function(){k&&k.stop();d&&d.destroy();e&&e.destroy()};b.id=c.id;b.model=e=new p.model(c);b.view=d=new p.view(b,e);b.controller=k=new p.controller(e,d);k.addGlobalListener(function(a){b.dispatchEvent(a.type,a)});b.play=k.play;b.pause=k.pause;b.seek=k.seek;b.stop=k.stop;b.volume=k.volume;b.mute=k.mute;b.fullscreen=k.fullscreen;b.resize=
d.resize}})(playease);(function(c){var h=c.utils,a=c.events;c=c.core;var p=c.states;c.model=function(c){var b=h.extend(this,new a.eventdispatcher("core.model"));b.setState=function(c){c!==b.state&&(b.state=c,b.dispatchEvent(a.PLAYEASE_STATE,{state:c}))};b.getState=function(){return b.state};b.getConfig=function(a){return b.config[a]||{}};b.destroy=function(){};b.config=h.extend({},{},c);h.extend(b,{id:c.id,state:p.STOPPED},b.config)}})(playease);
(function(c){var h=c.utils,a=c.events;c=c.core;var p=c.states;c.view=function(c,b){function e(b){g.removeEventListener("play",e);y.dispatchEvent(a.PLAYEASE_VIEW_PLAY)}function d(b){h.log("source open");y.dispatchEvent(a.PLAYEASE_READY,{id:c.id})}function k(a){h.log("update end");var b=a.target.type;if(G){if(!q||"open"!==q.readyState)return;if(!z.audio.length&&!z.video.length){q.endOfStream();return}}if(0!=z[b].length&&(a=E[b],!a.updating)){b=z[b].shift();try{a.appendBuffer(b)}catch(c){h.log(c)}}}
function n(a){h.log("source buffer error")}function l(a){h.log("source ended")}function m(a){h.log("source close")}function x(a){h.log("media source error")}function D(a){if(a.ctrlKey||a.metaKey)return!0;switch(a.keyCode){case 13:H.send()}if(/13/.test(a.keyCode))return a.preventDefault?a.preventDefault():a.returnValue=!1,!1}var y=h.extend(this,new a.eventdispatcher("core.view")),w,H,g,I,q,E,z,G=!1;y.setup=function(){g=h.createElement("video");g.width=b.width;g.height=b.height;b.controls&&(g.controls=
"controls");b.autoplay?g.autoplay="autoplay":g.addEventListener("play",e);w.appendChild(g);q=new MediaSource;q.addEventListener("sourceopen",d);q.addEventListener("sourceended",l);q.addEventListener("sourceclose",m);q.addEventListener("error",x);q.addEventListener("webkitsourceopen",d);q.addEventListener("webkitsourceended",l);q.addEventListener("webkitsourceclose",m);q.addEventListener("webkiterror",x);g.src=window.URL.createObjectURL(q)};y.appendInitSegment=function(a,c){var d=a+'/mp4; codecs="'+
I[a+"Codec"]+'"';MediaSource.isTypeSupported(d)?(h.log("Mime type: "+d+"."),"closed"==q.readyState?b.state=p.ERROR:(d=E[a]=q.addSourceBuffer(d),d.type=a,d.addEventListener("updateend",k),d.addEventListener("error",n),d.appendBuffer(c))):(h.log("Mime type is not surpported: "+d+"."),b.state=p.ERROR)};y.appendSegment=function(a,b){z[a].push(b);var c=E[a];c.updating||(b=z[a].shift(),c.appendBuffer(b))};y.setMediaInfo=function(a){I=a};y.endOfStream=function(){G=!0};y.display=function(a,b){H&&H.display(a,
b)};y.resize=function(a,b){H&&H.resize(a,b)};y.destroy=function(){if(w)try{w.removeEventListener("keydown",D)}catch(a){w.detachEvent("onkeydown",D)}H&&H.destroy()};(function(){w=h.createElement("div","playerwrap");w.id=c.id;w.tabIndex=0;var a=document.getElementById(c.id);a.parentNode.replaceChild(w,a);window.onresize=function(){"function"==h.typeOf(b.onresize)?b.onresize.call(null):y.resize()};window.MediaSource=window.MediaSource||window.WebKitMediaSource;E={audio:null,video:null};z={audio:[],video:[]}})()}})(playease);
(function(c){var h=c.utils,a=c.events,p=c.core,f=c.muxer,b=p.states,e=f.AMF,d=f.flv.TAG,k=f.flv.FORMATS,n=f.flv.CODECS;p.controller=function(c,m){function p(a){h.log("onContenLength "+a.length)}function D(a){h.log("onLoaderProgress "+a.data.byteLength);K.parse(a.data)}function y(a){h.log("onLoaderComplete")}function w(a){h.log(a.message)}function H(a){h.log("onFlvTag { tag: "+a.tag+", offset: "+a.offset+", size: "+a.size+" }");switch(a.tag){case d.AUDIO:if(a.format&&a.format!=k.AAC){h.log("Unsupported audio format("+
a.format+").");break}K.parseAACAudioPacket(a.data,a.offset,a.size,a.timestamp,a.rate,a.samplesize,a.sampletype);break;case d.VIDEO:if(a.codec&&a.codec!=n.AVC){h.log("Unsupported video codec("+a.codec+").");break}K.parseAVCVideoPacket(a.data,a.offset,a.size,a.timestamp,a.frametype);break;case d.SCRIPT:a=e.parse(a.data,a.offset,a.size);h.log(a.key+": "+JSON.stringify(a.value));"onMetaData"==a.key&&K.setMetaData(a.value);break;default:h.log("Skipping unknown tag type "+a.tag)}}function g(a){m.setMediaInfo(a.info)}
function I(a){M.setVideoMeta(a.data);M.getInitSegment(a.data)}function q(a){M.getVideoSegment(a.data)}function E(a){M.setAudioMeta(a.data);M.getInitSegment(a.data)}function z(a){M.getAudioSegment(a.data)}function G(a){m.endOfStream()}function t(a){h.log(a.message)}function C(a){m.appendInitSegment(a.tp,a.data)}function J(a){m.appendSegment(a.tp,a.data)}function v(a){h.log(a.message)}function B(c){switch(c.state){case b.BUFFERING:r.dispatchEvent(a.PLAYEASE_BUFFER);break;case b.PLAYING:r.dispatchEvent(a.PLAYEASE_PLAY);
break;case b.PAUSED:r.dispatchEvent(a.PLAYEASE_PAUSE);break;case b.SEEKING:r.dispatchEvent(a.PLAYEASE_SEEK);break;case b.STOPPED:r.dispatchEvent(a.PLAYEASE_STOP);break;case b.ERROR:break;default:r.dispatchEvent(a.ERROR,{message:"Unknown model state!",state:c.state})}}function A(a){P||(P=!0,N(a),c.autoplay&&r.play(),window.onbeforeunload=function(a){})}function O(a){var d=c.getState();if(d==b.PAUSED||d==b.STOPPED||d==b.ERROR)r.play(),N(a)}function Q(a){var d=c.getState();if(d==b.BUFFERING||d==b.PLAYING||
d==b.ERROR)r.pause(),N(a)}function R(a){c.getState()!=b.SEEKING&&(r.seek(a.time),N(a))}function S(a){r.stop();N(a)}function T(a){r.volume(a.vol);N(a)}function U(a){r.fullscreen(a.esc);N(a)}function V(a){c.setState(b.ERROR);N(a)}function F(a){c.setState(b.ERROR);N(a)}function N(a){r.dispatchEvent(a.type,a)}var r=h.extend(this,new a.eventdispatcher("core.controller")),P=!1,u,K,M;r.play=function(){u.load(c.url)};r.pause=function(){};r.seek=function(a){};r.stop=function(){};r.volume=function(a){};r.mute=
function(a){};r.fullscreen=function(a){};(function(){c.addEventListener(a.PLAYEASE_STATE,B);m.addEventListener(a.PLAYEASE_READY,A);m.addEventListener(a.PLAYEASE_VIEW_PLAY,O);m.addEventListener(a.PLAYEASE_VIEW_PAUSE,Q);m.addEventListener(a.PLAYEASE_VIEW_SEEK,R);m.addEventListener(a.PLAYEASE_VIEW_STOP,S);m.addEventListener(a.PLAYEASE_VIEW_VOLUNE,T);m.addEventListener(a.PLAYEASE_VIEW_FULLSCREEN,U);m.addEventListener(a.PLAYEASE_SETUP_ERROR,V);m.addEventListener(a.PLAYEASE_RENDER_ERROR,F);var b={};c.config.cors&&
(b.mode=c.config.cors);u=new h.loader(b);u.addEventListener(a.PLAYEASE_CONTENT_LENGTH,p);u.addEventListener(a.PLAYEASE_PROGRESS,D);u.addEventListener(a.PLAYEASE_COMPLETE,y);u.addEventListener(a.ERROR,w);K=new f.flv;K.addEventListener(a.PLAYEASE_FLV_TAG,H);K.addEventListener(a.PLAYEASE_MEDIA_INFO,g);K.addEventListener(a.PLAYEASE_AVC_CONFIG_RECORD,I);K.addEventListener(a.PLAYEASE_AVC_SAMPLE,q);K.addEventListener(a.PLAYEASE_AAC_SPECIFIC_CONFIG,E);K.addEventListener(a.PLAYEASE_AAC_SAMPLE,z);K.addEventListener(a.PLAYEASE_END_OF_STREAM,
G);K.addEventListener(a.ERROR,t);M=new f.mp4;M.addEventListener(a.PLAYEASE_MP4_INIT_SEGMENT,C);M.addEventListener(a.PLAYEASE_MP4_SEGMENT,J);M.addEventListener(a.ERROR,v)})()}})(playease);
(function(c){var h=c.utils,a=c.events,p=c.embed=function(f){function b(b){switch(b.type){case a.ERROR:case a.PLAYEASE_SETUP_ERROR:case a.PLAYEASE_RENDER_ERROR:case a.PLAYEASE_ERROR:e.errorScreen(b.message);e.dispatchEvent(a.ERROR,b);break;default:e.dispatchEvent(b.type,b)}}var e=h.extend(this,new a.eventdispatcher("embed")),d={},k=!1,n=null;e.embed=function(){try{d=new p.config(f.config),n=new p.embedder(f,d)}catch(c){h.log("Failed to init embedder!");e.dispatchEvent(a.PLAYEASE_SETUP_ERROR,{message:"Failed to init embedder!",
render:d.render.name});return}n.addGlobalListener(b);n.embed()};e.errorScreen=function(a){k||(k=!0,c.api.displayError(a,d))};(function(){h.foreach(f.config.events,function(a,b){var c=f[a];"function"===h.typeOf(c)&&c.call(f,b)})})()}})(playease);
(function(c){var h=c.utils,a=c.embed,p=c.core.renders.modes,f=c.core.renders.skins.modes;a.config=function(a){return h.extend({},{url:"http://"+window.location.host+"/vod/sample.flv",width:640,height:360,cors:"no-cors",bufferTime:.1,controls:!0,autoplay:!0,render:{name:p.DEFAULT,skin:{name:f.DEFAULT}}},a)};a.config.addConfig=function(a,c){return h.extend(a,c)}})(playease);
(function(c){var h=c.utils,a=c.events,p=c.core;c.embed.embedder=function(c,b){function e(a){d.dispatchEvent(a.type,a)}var d=h.extend(this,new a.eventdispatcher("embed.embedder"));d.embed=function(){var a=new p.entity(b);a.addGlobalListener(e);a.setup();c.setEntity(a,b.render.name)}}})(playease);