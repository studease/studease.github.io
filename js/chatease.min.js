chatease=function(){if(chatease.api)return chatease.api.getInstance.apply(this,arguments)};chatease.version="1.0.23";
(function(c){function f(a){return null!==navigator.userAgent.toLowerCase().match(a)}var e=c.utils={};e.exists=function(a){switch(e.typeOf(a)){case "string":return 0<a.length;case "object":return null!==a;case "null":return!1}return!0};e.extend=function(){var a=Array.prototype.slice.call(arguments,0),b=a[0];if(1<a.length)for(var d=1;d<a.length;d++)e.foreach(a[d],function(a,d){void 0!==d&&null!==d&&(b[a]=d)});return b};e.foreach=function(a,b){for(var d in a)a.hasOwnProperty&&"function"===e.typeOf(a.hasOwnProperty)?
a.hasOwnProperty(d)&&b(d,a[d]):b(d,a[d])};e.getCookie=function(a){var b;return(b=document.cookie.match(new RegExp("(^| )"+a+"=([^;]*)(;|$)")))?unescape(b[2]):null};e.formatTime=function(a){var b=a.getHours()+1,d=a.getMinutes(),f=a.getSeconds();return a.toLocaleDateString()+" "+e.pad(b,2)+":"+e.pad(d,2)+":"+e.pad(f,2)};e.pad=function(a,b){for(a+="";a.length<b;)a="0"+a;return a};e.typeOf=function(a){if(null===a||void 0===a)return"null";var b=typeof a;if("object"===b)try{var d=a.toString().match(/^\[object ([a-z]+)\]$/i);
if(d&&1<d.length&&d[1])return d[1].toLowerCase()}catch(k){}return b};e.isInt=function(a){return 0===parseFloat(a)%1};e.trim=function(a){return a.replace(/^\s+|\s+$/g,"")};e.indexOf=function(a,b){if(null==a)return-1;for(var d=0;d<a.length;d++)if(a[d]===b)return d;return-1};e.createElement=function(a,b){a=document.createElement(a);b&&(a.className=b);return a};e.addClass=function(a,b){var d="string"===e.typeOf(a.className)?a.className.split(" "):[];b="array"===e.typeOf(b)?b:b.split(" ");e.foreach(b,
function(a,b){-1===e.indexOf(d,b)&&d.push(b)});a.className=e.trim(d.join(" "))};e.removeClass=function(a,b){var d="string"===e.typeOf(a.className)?a.className.split(" "):[];b="array"===e.typeOf(b)?b:b.split(" ");e.foreach(b,function(a,b){a=e.indexOf(d,b);0<=a&&d.splice(a,1)});a.className=e.trim(d.join(" "))};e.emptyElement=function(a){for(;a.firstChild;)a.removeChild(a.firstChild)};e.isMSIE=function(a){return a?(a=parseFloat(a).toFixed(1),f(new RegExp("msie\\s*"+a,"i"))):f(/msie/i)};e.isSafari=function(){return f(/safari/i)&&
!f(/chrome/i)&&!f(/chromium/i)&&!f(/android/i)};e.isIOS=function(a){return a?f(new RegExp("iP(hone|ad|od).+\\sOS\\s"+a,"i")):f(/iP(hone|ad|od)/i)};e.isAndroid=function(a,b){return b&&f(/chrome\/[123456789]/i)&&!f(/chrome\/18/)?!1:a?(e.isInt(a)&&!/\./.test(a)&&(a=""+a+"."),f(new RegExp("Android\\s*"+a,"i"))):f(/Android/i)};e.isMobile=function(){return e.isIOS()||e.isAndroid()};e.getProtocol=function(a){var b="http";(a=a.match(/^([a-z]+)\:\/\//i))&&1<a.length&&(b=a[1]);return b};e.getFileName=function(a){var b=
"";(a=a.match(/\/([a-z0-9\(\)\[\]\{\}\s\-_%]*(\.[a-z0-9]+)?)$/i))&&1<a.length&&(b=a[1]);return b};e.getExtension=function(a){var b="";(a=a.match(/\/?([a-z0-9\(\)\[\]\{\}\s\-_%]*(\.([a-z0-9]+))*)\??([a-z0-9\-_%&=]*)$/i))&&3<a.length&&(b=a[3]);return b};var g=window.console=window.console||{log:function(){}};e.log=function(){var a=Array.prototype.slice.call(arguments,0);"object"===e.typeOf(g.log)?g.log(a):g.log.apply(g,a)}})(chatease);
(function(c){var f=c.utils;c=f.crypt={};c.stringToByteArray=function(e){for(var f=[],a=0,b=0;b<e.length;b++){for(var d=e.charCodeAt(b);255<d;)f[a++]=d&255,d>>=8;f[a++]=d}return f};c.byteArrayToString=function(e){if(8192>=e.length)return String.fromCharCode.apply(null,e);for(var f="",a=0;a<e.length;a+=8192)var b=Array.slice(e,a,a+8192),f=f+String.fromCharCode.apply(null,b);return f};c.byteArrayToHex=function(e){return Array.map(e,function(e){e=e.toString(16);return 1<e.length?e:"0"+e}).join("")};c.hexToByteArray=
function(e){if(0!==e.length%2)return f.log("Key string length must be multiple of 2."),null;for(var c=[],a=0;a<e.length;a+=2)c.push(parseInt(e.substring(a,a+2),16));return c};c.stringToUTF8ByteArray=function(e){for(var f=[],a=0,b=0;b<e.length;b++){var d=e.charCodeAt(b);128>d?f[a++]=d:(2048>d?f[a++]=d>>6|192:(55296==(d&64512)&&b+1<e.length&&56320==(e.charCodeAt(b+1)&64512)?(d=65536+((d&1023)<<10)+(e.charCodeAt(++b)&1023),f[a++]=d>>18|240,f[a++]=d>>12&63|128):f[a++]=d>>12|224,f[a++]=d>>6&63|128),f[a++]=
d&63|128)}return f};c.UTF8ByteArrayToString=function(e){for(var f=[],a=0,b=0;a<e.length;){var d=e[a++];if(128>d)f[b++]=String.fromCharCode(d);else if(191<d&&224>d){var c=e[a++];f[b++]=String.fromCharCode((d&31)<<6|c&63)}else if(239<d&&365>d){var c=e[a++],l=e[a++],t=e[a++],d=((d&7)<<18|(c&63)<<12|(l&63)<<6|t&63)-65536;f[b++]=String.fromCharCode(55296+(d>>10));f[b++]=String.fromCharCode(56320+(d&1023))}else c=e[a++],l=e[a++],f[b++]=String.fromCharCode((d&15)<<12|(c&63)<<6|l&63)}return f.join("")};c.XORByteArray=
function(e,c){if(e.length!==c.length)f.log("XOR array lengths must match.");else{for(var a=[],b=0;b<e.length;b++)a.push(e[b]^c[b]);return a}}})(chatease);
(function(c){function f(){var a=document.createElement("style");a.type="text/css";document.getElementsByTagName("head")[0].appendChild(a);return a.sheet||a.styleSheet}var e=c.utils,g;(e.css=function(a,b){g||(g=f());var d="";e.foreach(b,function(a,b){d+=a+": "+b+"; "});try{g.insertRule?g.insertRule(a+" { "+d+"}",g.cssRules.length):g.addRule(a,d,g.rules.length)}catch(k){e.log("Failed to insert css rule: "+a)}}).style=function(a,b,d){if(void 0!==a&&null!==a)for(void 0===a.length&&(a=[a]),b=e.extend({},
b),d=0;d<a.length;d++){var f=a[d];void 0!==f&&null!==f&&e.foreach(b,function(a,b){a=a.split("-");for(var d=1;d<a.length;d++)a[d]=a[d].charAt(0).toUpperCase()+a[d].slice(1);a=a.join("");f.style[a]!==b&&(f.style[a]=b)})}}})(chatease);(function(c){var f=c.utils;f.filter=function(e){var c,a="";this.replace=function(b){return a&&c?b.replace(c,"**"):b};"string"==f.typeOf(e)&&e&&(a=e,c=new RegExp(a,"ig"))}})(chatease);
(function(c){c.events={ERROR:"error",CHATEASE_READY:"chateaseReady",CHATEASE_SETUP_ERROR:"chateaseSetupError",CHATEASE_RENDER_ERROR:"chateaseRenderError",CHATEASE_STATE:"chateaseState",CHATEASE_PROPERTY:"chateaseProperty",CHATEASE_CONNECT:"chateaseConnect",CHATEASE_INDENT:"chateaseIdent",CHATEASE_MESSAGE:"chateaseMessage",CHATEASE_JOIN:"chateaseJoin",CHATEASE_LEFT:"chateaseLeft",CHATEASE_USERS:"chateaseUsers",CHATEASE_CLOSE:"chateaseClose",CHATEASE_VIEW_SEND:"chateaseViewSend",CHATEASE_VIEW_PROPERTY:"chateaseViewProperty",
CHATEASE_VIEW_CLEARSCREEN:"chateaseViewClearScreen",CHATEASE_VIEW_NICKCLICK:"chateaseViewNickClick",CHATEASE_TIMER:"chateaseTimer",CHATEASE_TIMER_COMPLETE:"chateaseTimerComplete"}})(chatease);
(function(c){var f=c.utils;c.events.eventdispatcher=function(e){function g(a,b,e){if(a)for(var d=0;d<a.length;d++){var c=a[d];if(c){null!==c.count&&0===--c.count&&delete a[d];try{c.listener(b)}catch(q){f.log('Error handling "'+e+'" event listener ['+d+"]: "+q.toString(),c.listener,b)}}}}var a={},b=[];this.addEventListener=function(b,e,c){try{f.exists(a[b])||(a[b]=[]),"string"===f.typeOf(e)&&(e=(new Function("return "+e))()),a[b].push({listener:e,count:c||null})}catch(t){f.log("error",t)}return!1};
this.removeEventListener=function(b,e){if(a[b]){try{if(void 0===e){a[b]=[];return}var d;for(d=0;d<a[b].length;d++)if(a[b][d].listener.toString()===e.toString()){a[b].splice(d,1);break}}catch(t){f.log("error",t)}return!1}};this.addGlobalListener=function(a,e){try{"string"===f.typeOf(a)&&(a=(new Function("return "+a))()),b.push({listener:a,count:e||null})}catch(l){f.log("error",l)}return!1};this.removeGlobalListener=function(a){if(a){try{var d;for(d=b.length-1;0<=d;d--)b[d].listener.toString()===a.toString()&&
b.splice(d,1)}catch(l){f.log("error",l)}return!1}};this.dispatchEvent=function(d,k){k||(k={});f.extend(k,{id:e,version:c.version,type:d});c.debug&&f.log(d,k);g(a[d],k,d);g(b,k,d)}}})(chatease);
(function(c){var f=c.utils,e=c.events;f.timer=function(c,a){function b(){l++;d.dispatchEvent(e.CHATEASE_TIMER);0<d.repeatCount&&l>=d.repeatCount&&(d.stop(),d.dispatchEvent(e.CHATEASE_TIMER_COMPLETE))}var d=f.extend(this,new e.eventdispatcher("utils.timer")),k,l=0,g=!1;d.start=function(){!1===g&&(k=setInterval(b,d.delay),g=!0)};d.stop=function(){g&&(clearInterval(k),k=0,g=!1)};d.reset=function(){d.stop();l=0};d.currentCount=function(){return l};d.running=function(){return g};d.delay=c||50;d.repeatCount=
a||0}})(chatease);
(function(c){var f=c.utils,e=c.events,g={},a={onError:e.ERROR,onReady:e.CHATEASE_READY,onConnect:e.CHATEASE_CONNECT,onIdent:e.CHATEASE_INDENT,onMessage:e.CHATEASE_MESSAGE,onJoin:e.CHATEASE_JOIN,onLeft:e.CHATEASE_LEFT,onUsers:e.CHATEASE_USERS,onNickClick:e.CHATEASE_VIEW_NICKCLICK,onClose:e.CHATEASE_CLOSE};c.api=function(b){function d(a){k.dispatchEvent(a.type,a)}var k=f.extend(this,new e.eventdispatcher("api")),g;k.container=b;k.id=b.id;k.setup=function(a){f.emptyElement(k.container);c.debug=!!a.debug;
k.config=a;k.config.id=k.id;k.embedder=new c.embed(k);k.embedder.addGlobalListener(d);k.embedder.embed();return k};k.setEntity=function(a,b){g=a;k.onSWFLoaded=g.setup;k.onSWFOpen=g.onSWFOpen;k.onSWFMessage=g.onSWFMessage;k.onSWFError=g.onSWFError;k.onSWFClose=g.onSWFClose;k.send=g.send;k.resize=g.resize};(function(){f.foreach(a,function(a,b){k[a]=function(a){k.addEventListener(b,a)}})})()};c.api.getInstance=function(a){var b;null==a?a=0:a.nodeType?b=a:"string"===f.typeOf(a)&&(b=document.getElementById(a));
if(b){var e=g[b.id];e||(g[a]=e=new c.api(b));return e}return"number"===f.typeOf(a)?g[a]:null};c.api.displayError=function(a,e){}})(chatease);(function(c){c.core={}})(chatease);(function(c){c.core.states={CONNECTED:"connected",CLOSED:"closed",ERROR:"error"}})(chatease);
(function(c){c.core.protocol={};c=c.core.protocol;c.cmds={TEXT:"text",MUTE:"mute",KICKOUT:"kickout",PING:"ping"};c.raws={IDENT:"ident",TEXT:"text",JOIN:"join",LEFT:"left",USERS:"users",MUTE:"mute",KICKOUT:"kickout",ERROR:"error",PONG:"pong"};c.roles={VISITOR:0,NORMAL:1,VIP:14,ASSISTANT:16,SECRETARY:32,ANCHOR:48,ADMIN:64,SU_ADMIN:128,SYSTEM:192};c.channelStates={NORMAL:0,MUTED:1,LOCKED:3};c.punishments={MUTED:1,KICKED_OUT:3};c.errors={BAD_REQUEST:400,UNAUTHORIZED:401,FORBIDDEN:403,NOT_FOUND:404,NOT_ACCEPTABLE:406,
REQUEST_TIMEOUT:408,CONFLICT:409,EXPECTATION_FAILED:417,INTERNAL_SERVER_ERROR:500,NOT_IMPLEMENTED:501,BAD_GATEWAY:502,SERVICE_UNAVAILABLE:503,GATEWAY_TIMEOUT:504}})(chatease);(function(c){c.core.skins={}})(chatease);(function(c){c.core.skins.modes={DEFAULT:"def"}})(chatease);
(function(c){var f=c.utils,e=c.events;c=c.core.skins;var g=c.modes,a=f.css,b="cha-skin";c.def=function(d){var c=f.extend(this,new e.eventdispatcher("skins.def"));c.resize=function(b,e){b=document.getElementById(c.config.id);e=document.getElementById(c.config.id+"-console");var d=document.getElementById(c.config.id+"-input");a.style(e,{height:b.clientHeight-140+"px"});a.style(d,{width:b.clientWidth-96+"px"})};c.name=g.DEFAULT;c.config=f.extend({},d);b+="-"+c.name;a(".cha-wrapper",{width:"100%",height:"100%",
"background-color":"#171717"});a(".cha-wrapper *",{margin:"0",padding:"0","font-family":"Microsoft YaHei,arial,sans-serif","font-size":"14px","font-weight":"normal","box-sizing":"content-box"});a("."+b+" .cha-checkbox",{padding:"6px 0 6px 18px",color:"#E6E6E6","background-repeat":"no-repeat","background-position":"left center","background-image":"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOAgMAAABiJsVCAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAJUExURUxpcebm5ubm5kbBEu0AAAACdFJOUwCgoEVu0AAAABpJREFUCNdjYAABqVWrHBi0Vq1qII0AawMBACnPF0kf/g8sAAAAAElFTkSuQmCC)",
cursor:"pointer",overflow:"hidden"});a("."+b+" .cha-checkbox.checked",{"background-image":"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAYAAAAfSC3RAAAA40lEQVQ4T52SvXHCQBCF3wuUKDHp7QXYFZgOrBKgAqADOsDuRK7ALoEOGDqwk1UoSHSBZrTMMWhGY358w0YbvG9/3i7xYDByqloCmKfUMLPSe7/sQUuADmfNk4gwCTSzXZZli7ZtS5KvSWCE8jwvmqZZkVzHrv+CPRRCKAB89etcA38BjM+CA8lJzLuu25Ic3QJ/RORl4PBMRL5VdQPgbWjeRUcz+/Dev1dVVTjnNqo6HY54b1SQXDrnyrquRyGELYDnv6e6Z87MzCa9i8mgme2jeGjIrR2TXw7Ap4gsTp/zSBwBq1l6D5ci9L8AAAAASUVORK5CYII=)"});
a("."+b+" .cha-button",{padding:"6px 14px","font-style":"normal","font-weight":"normal","text-align":"center","text-transform":"uppercase","white-space":"nowrap","word-spacing":"normal",border:"none","border-radius":"2px",cursor:"pointer",display:"inline-block","-webkit-font-smoothing":"subpixel-antialiased","-moz-osx-font-smoothing":"grayscale",transition:"150ms ease-in-out","transition-property":"background-color, color"});a("."+b+" .cha-button.red",{color:"#FFFFFF","background-color":"#FF0046"});
a("."+b+" .cha-button.red:hover",{"background-color":"#97052D"});a("."+b+" .cha-render",{width:"100%",height:"100%"});a("."+b+" .cha-render object",{width:"0",height:"0",position:"absolute"});a("."+b+" .cha-render .cha-title",{width:"100%",height:"40px","font-family":"inherit","font-weight":"normal","text-align":"center","line-height":"40px",color:"#E6E6E6","background-color":"inherit",cursor:"default","pointer-events":"none"});a("."+b+" .cha-render .cha-console",{height:c.config.height-140+"px",
color:"#242424","background-color":"#F8F8F8","overflow-x":"hidden","overflow-y":"scroll"});a("."+b+" .cha-render .cha-console > div",{margin:"6px"});a("."+b+" .cha-render .cha-console > div.cha-system, ."+b+" .cha-render .cha-console > div.cha-system > a",{"font-style":"normal","font-weight":"normal",color:"#33CC00",cursor:"default","pointer-events":"none"});a("."+b+" .cha-render .cha-console > div .icon",{"margin-right":"2px",padding:"0 2px",font:"normal 12px Microsoft YaHei,arial,sans-serif","white-space":"nowrap",
"word-spacing":"normal",border:"1px solid #3CAFAB","border-radius":"2px","vertical-align":"middle"});a("."+b+" .cha-render .cha-console > div .icon.ico-visitor, ."+b+" .cha-render .cha-console > div .icon.ico-normal, ."+b+" .cha-render .cha-console > div .icon.ico-system",{display:"none"});a("."+b+" .cha-render .cha-console > div .icon.ico-vip1, ."+b+" .cha-render .cha-console > div .icon.ico-vip2, ."+b+" .cha-render .cha-console > div .icon.ico-vip3",{color:"#3CAFAB","border-color":"#3CAFAB"});a("."+
b+" .cha-render .cha-console > div .icon.ico-vip4, ."+b+" .cha-render .cha-console > div .icon.ico-vip5, ."+b+" .cha-render .cha-console > div .icon.ico-vip6, ."+b+" .cha-render .cha-console > div .icon.ico-vip7",{color:"#77C773","border-color":"#77C773"});a("."+b+" .cha-render .cha-console > div .icon.ico-assistant, ."+b+" .cha-render .cha-console > div .icon.ico-secretary, ."+b+" .cha-render .cha-console > div .icon.ico-anchor",{color:"#5382E2","border-color":"#5382E2"});a("."+b+" .cha-render .cha-console > div .icon.ico-admin, ."+
b+" .cha-render .cha-console > div .icon.ico-suadmin",{color:"#F76767","border-color":"#F76767"});a("."+b+" .cha-render .cha-console > div > a",{color:"#5382E2","text-decoration":"none",cursor:"pointer"});a("."+b+" .cha-render .cha-console > div .context",{"word-break":"break-all","word-wrap":"break-word"});a("."+b+" .cha-render .cha-controls",{width:"100%",height:"40px","line-height":"100%","background-color":"inherit",overflow:"hidden"});a("."+b+" .cha-render .cha-controls > *",{margin:"6px 0",
"text-align":"center",display:"block"});a("."+b+" .cha-render .cha-controls .shieldtext",{"float":"left"});a("."+b+" .cha-render .cha-controls .clearscreen",{"float":"right",width:"42px"});a("."+b+" .cha-render .cha-dialog",{width:"100%",height:"60px",overflow:"hidden"});a("."+b+" .cha-render .cha-dialog textarea",{padding:"6px 10px",width:c.config.width-124+"px",height:"48px",resize:"none",border:"0 none","background-color":"#E6E6E6"});a("."+b+" .cha-render .cha-dialog button",{"float":"right",width:"42px",
height:"48px"})}})(chatease);(function(c){c.core.renders={}})(chatease);(function(c){c.core.renders.modes={DEFAULT:"def"}})(chatease);
(function(c){var f=c.utils,e=c.events;c=c.core;var g=c.protocol.roles;c=c.renders;var a=c.modes;c.def=function(b,d){function c(a,b,e,d,c){var g=f.createElement("div",b);g.setAttribute("value",!!c);g.innerHTML=a;a=function(a,b){return function(e){e="true"==g.getAttribute("value")?!1:!0;g.setAttribute("value",e);e?f.addClass(g,"checked"):f.removeClass(g,"checked");h.dispatchEvent(a,f.extend({value:e},b))}}(e,d);try{g.addEventListener("click",a)}catch(A){g.attachEvent("onclick",a)}return g}function l(a,
b,e,d){b=f.createElement("div",b);b.innerHTML=a;a=function(a,b){return function(e){h.dispatchEvent(a,b)}}(e,d);try{b.addEventListener("click",a)}catch(r){b.attachEvent("onclick",a)}return b}function t(a){var b,e="icon ";if("number"!=f.typeOf(a)&&(a=parseInt(a),NaN==a||0>a))return null;a&g.SYSTEM?(a&g.SYSTEM)!=g.SYSTEM&&(a&g.SU_ADMIN?(b=f.createElement("span",e+"ico-suadmin"),b.innerText="\u8d85\u7ba1"):(b=f.createElement("span",e+"ico-admin"),b.innerText="\u7ba1\u7406\u5458")):a&g.ANCHOR?(a&g.ANCHOR)==
g.ANCHOR?(b=f.createElement("span",e+"ico-anchor"),b.innerText="\u4e3b\u64ad"):a&g.SECRETARY?(b=f.createElement("span",e+"ico-secretary"),b.innerText="\u79d8\u4e66"):(b=f.createElement("span",e+"ico-assistant"),b.innerText="\u52a9\u7406"):a&g.VIP&&(a=(a&g.VIP)>>>1,b=f.createElement("span",e+("ico-vip"+a)),b.innerText="VIP"+a);return b}var h=f.extend(this,new e.eventdispatcher("renders.def")),q,n,w,x,m,v;h.setup=function(){f.isMSIE(8)||f.isMSIE(9)?_object.setup&&(h.config.debug=!0,_object.setup(h.config),
h.dispatchEvent(e.CHATEASE_READY,{id:h.config.id})):h.dispatchEvent(e.CHATEASE_READY,{id:h.config.id})};h.show=function(a,b,d){"object"!=f.typeOf(b)&&(b={id:0,name:"\u7cfb\u7edf",role:g.SYSTEM});"uni"!=d&&(d="multi");var c=f.createElement("div");(b.role&g.SYSTEM)==g.SYSTEM&&(c.className="cha-system");"uni"==d&&(d=f.createElement("span"),d.innerHTML="[\u5bc6\u8bed]",c.appendChild(d));(d=t(b.role))&&c.appendChild(d);d=f.createElement("a");d.innerHTML=b.name+": ";b=function(a){return function(b){h.dispatchEvent(e.CHATEASE_VIEW_NICKCLICK,
{user:a})}}(b);try{d.addEventListener("click",b)}catch(r){d.attachEvent("onclick",b)}c.appendChild(d);d=f.createElement("span","context");d.innerHTML=a;c.appendChild(d);n.childNodes.length>=h.config.maxrecords&&n.removeChild(n.childNodes[0]);n.appendChild(c);n.scrollTop=n.scrollHeight};h.send=function(){h.dispatchEvent(e.CHATEASE_VIEW_SEND,{data:{data:m.value,type:"multi"}});h.clearInput()};h.clearInput=function(){m.value=""};h.clearScreen=function(){f.emptyElement(n)};h.element=function(){return _object};
h.resize=function(a,b){};h.destroy=function(){};h.name=a.DEFAULT;h.config=f.extend({},{},d);if(f.isMSIE(8)||f.isMSIE(9))b.innerHTML='<object id="cha-swf" name="cha-swf" align="middle" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"><param name="movie" value="'+h.config.swf+'"><param name="quality" value="high"><param name="bgcolor" value="#ffffff"><param name="allowscriptaccess" value="sameDomain"><param name="allowfullscreen" value="true"><param name="wmode" value="transparent"><param name="FlashVars" value="id='+
h.config.id+'"></object>',_object=h.WebSocket=b.firstChild;(function(){q=f.createElement("div","cha-title");b.appendChild(q);q.innerHTML="\u804a\u5929\u5ba4";n=f.createElement("div","cha-console");n.id=h.config.id+"-console";b.appendChild(n);w=f.createElement("div","cha-controls");b.appendChild(w);var a=c("\u5c4f\u853d\u6d88\u606f","cha-checkbox shieldtext",e.CHATEASE_VIEW_PROPERTY,{key:"shield"},!1);w.appendChild(a);a=l("\u6e05\u5c4f","cha-button red clearscreen",e.CHATEASE_VIEW_CLEARSCREEN,null);
w.appendChild(a);x=f.createElement("div","cha-dialog");b.appendChild(x);m=f.createElement("textarea");m.id=h.config.id+"-input";x.appendChild(m);v=f.createElement("button","cha-button red");x.appendChild(v);m.setAttribute("placeholder","\u8f93\u5165\u804a\u5929\u5185\u5bb9");h.config.maxlength&&m.setAttribute("maxlength",h.config.maxlength);a=function(){return function(a){a=window.event||a;13==a.keyCode&&(a.ctrlKey?m.value+="\r\n":(h.send(),window.event?a.returnValue=!1:a.preventDefault()))}}();try{m.addEventListener("keypress",
a)}catch(u){m.attachEvent("onkeypress",a)}v.innerHTML="\u53d1\u9001";a=function(){return function(){h.send()}}();try{v.addEventListener("click",a)}catch(u){v.attachEvent("onclick",a)}})()}})(chatease);
(function(c){var f=c.utils,e=c.events,g=c.core;g.entity=function(a){var b=f.extend(this,new e.eventdispatcher("core.entity")),d,c,l;b.setup=function(){setTimeout(function(){l.setup()},0)};b.destroy=function(){l&&l.stop();c&&c.destroy();d&&d.destroy()};b.id=a.id;b.model=d=new g.model(a);b.view=c=new g.view(d);b.controller=l=new g.controller(d,c);l.addGlobalListener(function(a){b.dispatchEvent(a.type,a)});b.onSWFOpen=l.onOpen;b.onSWFMessage=l.onMessage;b.onSWFError=l.onError;b.onSWFClose=l.onClose;
b.send=l.send;b.getState=d.getState;b.resize=c.resize}})(chatease);
(function(c){var f=c.utils,e=c.events;c=c.core;var g=c.states,a=c.protocol,b=a.roles,d=a.punishments,k=function(){var a=this;_interval=-1;_active=0;a.set=function(e){f.extend(a,e);1==e.hasOwnProperty("role")&&(e=e.role,_interval=0>e?-1:e>=b.ASSISTANT?0:e&b.VIP?500:e==b.NORMAL?1E3:2E3)};a.isMuted=function(){return a.role<a.state||!!(a.punishment.code&d.MUTED)};a.isActive=function(){if(0>_interval)return!1;var a=(new Date).getTime();if(_active&&a-_active<_interval)return!1;_active=a;return!0};f.extend(a,
{channel:null,role:-1,state:0,punishment:{code:0,time:0}})};c.model=function(a){var b=f.extend(this,new e.eventdispatcher("core.model")),d=g.CLOSED,c;b.setState=function(a){a!==d&&(d=a,b.dispatchEvent(e.CHATEASE_STATE,{state:a}))};b.getState=function(){return d};b.setProperty=function(a,d){1==c.hasOwnProperty(a)&&(c[a]=d,b.dispatchEvent(e.CHATEASE_PROPERTY,{key:a,value:d}))};b.getProperty=function(a){return c[a]};b.getConfig=function(a){return b.config[a]};b.destroy=function(){};b.config=f.extend({},
{},a);c={userinfo:new k,shield:!1}}})(chatease);
(function(c){var f=c.utils,e=c.events;c=c.core;var g=c.protocol.roles,a=c.renders,b=c.skins;c.view=function(d){function c(a){if(a.ctrlKey||a.metaKey)return!0;switch(a.keyCode){case 13:m&&m.send()}if(/13/.test(a.keyCode))return a.preventDefault?a.preventDefault():a.returnValue=!1,!1}function l(a){q.resize()}function t(a){h(a)}function h(a){q.dispatchEvent(a.type,a)}var q=f.extend(this,new e.eventdispatcher("core.view")),n,w,x,m,v;q.setup=function(){m?(m.setup(),q.resize()):q.dispatchEvent(e.CHATEASE_SETUP_ERROR,
{message:"Render not available!",name:d.config.render.name})};q.show=function(a,b,e){(!b||b.role&g.SYSTEM||!d.getProperty("shield"))&&m&&m.show(a,b,e)};q.resize=function(a,b){setTimeout(function(){m&&m.resize(a,b);v&&v.resize(a,b)},0)};q.destroy=function(){n&&n.removeEventListener("keydown",c);m&&m.destroy()};(function(){n=f.createElement("div","cha-wrapper cha-skin-"+d.getConfig("skin").name);n.id=d.getConfig("id");n.tabIndex=0;w=f.createElement("div","cha-render");x=f.createElement("div","cha-contextmenu");
n.appendChild(w);n.appendChild(x);var g=f.extend({},d.getConfig("render"),{id:d.getConfig("id"),url:d.getConfig("url"),width:d.getConfig("width"),height:d.getConfig("height"),maxlength:d.getConfig("maxlength"),maxrecords:d.getConfig("maxrecords")});try{m=q.render=new a[g.name](w,g),m.addEventListener(e.CHATEASE_READY,h),m.addEventListener(e.CHATEASE_VIEW_SEND,h),m.addEventListener(e.CHATEASE_VIEW_PROPERTY,h),m.addEventListener(e.CHATEASE_VIEW_CLEARSCREEN,h),m.addEventListener(e.CHATEASE_VIEW_NICKCLICK,
h),m.addEventListener(e.CHATEASE_RENDER_ERROR,t)}catch(u){f.log("Failed to init render "+g.name+"!")}g=f.extend({},d.getConfig("skin"),{id:d.getConfig("id"),width:d.config.width,height:d.config.height});try{v=new b[g.name](g)}catch(u){f.log("Failed to init skin "+g.name+"!")}g=document.getElementById(d.getConfig("id"));g.parentNode.replaceChild(n,g);try{n.addEventListener("keydown",c),window.addEventListener("resize",l)}catch(u){n.attachEvent("onkeydown",c),window.attachEvent("onresize",l)}})()}})(chatease);
(function(c){var f=c.utils,e=f.crypt,g=c.events;c=c.core;var a=c.states,b=c.protocol,d=b.cmds,k=b.raws,l=b.roles,t=b.punishments,h=b.errors;c.controller=function(b,c){function n(){if(r&&b.getState()==a.CONNECTED)f.log("Websocket had connected already.");else{c.show("\u804a\u5929\u5ba4\u8fde\u63a5\u4e2d\u2026");try{window.WebSocket=window.WebSocket||window.MozWebSocket,window.WebSocket?(r=new WebSocket(b.config.url,"binary"),r.binaryType="arraybuffer",r.onopen=p.onOpen,r.onmessage=p.onMessage,r.onerror=
p.onError,r.onclose=p.onClose):(r=c.render.WebSocket,r.connect())}catch(G){f.log("Failed to initialize websocket: "+G),m(h.NOT_ACCEPTABLE,null)}}}function q(a){var b="";if("number"!=f.typeOf(a)&&(a=parseInt(a),NaN==a||0>a))return"";a&l.SYSTEM?b=(a&l.SYSTEM)==l.SYSTEM?b+"[\u7cfb\u7edf]":a&l.SU_ADMIN?b+"[\u8d85\u7ba1]":b+"[\u7ba1\u7406\u5458]":a&l.ANCHOR?b=(a&l.ANCHOR)==l.ANCHOR?b+"[\u4e3b\u64ad]":a&l.SECRETARY?b+"[\u52a9\u7406]":b+"[\u623f\u7ba1]":a&l.VIP?b+="[VIP"+((a&l.VIP)-1)+"]":(a&l.NORMAL)!=
l.NORMAL&&(b+="[\u6e38\u5ba2]");return b}function m(a,b){var e=v(a);e&&c.show(e);var d={raw:"error",error:{code:a,explain:e}};f.foreach(b,function(a,b){"cmd"!=a&&"raw"!=a&&"error"!=a&&(d[a]=b)});p.dispatchEvent(g.ERROR,d)}function v(a){var b="";switch(a){case h.BAD_REQUEST:b="\u9519\u8bef\u8bf7\u6c42\uff01";break;case h.UNAUTHORIZED:b="\u8bf7\u5148\u767b\u5f55\uff01";break;case h.FORBIDDEN:b="\u6743\u9650\u9519\u8bef\uff01";break;case h.NOT_FOUND:b="\u672a\u77e5\u8bf7\u6c42\uff01";break;case h.NOT_ACCEPTABLE:b=
"\u65e0\u6cd5\u8bc6\u522b\uff01";break;case h.REQUEST_TIMEOUT:b="\u8bf7\u6c42\u8d85\u65f6\uff01";break;case h.CONFLICT:b="\u64cd\u4f5c\u9891\u7e41\uff01";break;case h.EXPECTATION_FAILED:b="\u64cd\u4f5c\u5931\u8d25\uff01";break;case h.INTERNAL_SERVER_ERROR:b="\u5185\u90e8\u9519\u8bef\uff01";break;case h.NOT_IMPLEMENTED:b="\u65e0\u6cd5\u8bc6\u522b\uff01";break;case h.BAD_GATEWAY:b="\u54cd\u5e94\u65e0\u6548\uff01";break;case h.SERVICE_UNAVAILABLE:b="\u670d\u52a1\u8fc7\u8f7d\uff01";break;case h.GATEWAY_TIMEOUT:b=
"\u7f51\u5173\u8d85\u65f6\uff01"}return b}function F(a){y||(y=new f.timer(a,1),y.addEventListener(g.CHATEASE_TIMER,function(a){n()}));y.delay=a;y.reset();y.start()}function u(a){p.dispatchEvent(a.type,a)}var p=f.extend(this,new g.eventdispatcher("core.controller")),B=!1,r,y,A,z,D,C=0;p.setup=function(a){B||c.setup()};p.send=function(c,d){if(r&&b.getState()==a.CONNECTED)if("object"!=f.typeOf(c)||0==c.hasOwnProperty("cmd"))m(h.BAD_REQUEST,c);else{var g=b.getProperty("userinfo");if(0==g.isActive())m(h.CONFLICT,
c);else if(1==g.isMuted())m(h.EXPECTATION_FAILED,c);else{d&&(g=D++,z[g]=d,c.req=g);c=JSON.stringify(c);try{var k=e.stringToUTF8ByteArray(c),l=new Uint8Array(k);r.send(l.buffer);return}catch(H){}try{r.send(c)}catch(H){}}}else n()};p.onOpen=function(c){b.setState(a.CONNECTED)};p.onMessage=function(a){var d=a.data;"arraybuffer"===f.typeOf(a.data)&&(d=new Uint8Array(a.data),d=e.UTF8ByteArrayToString(d));var h;try{h=eval("("+d+")")}catch(E){f.log("Failed to parse JSON. \nError: "+E+"\ndata: "+a.data);
return}h.hasOwnProperty("req")&&z.hasOwnProperty(h.req)&&(a=z[h.req],d=a.result,h.raw==k.ERROR&&(d=a.status),d&&d.call(null,h),delete z[h.req]);switch(h.raw){case k.IDENT:a=b.getProperty("userinfo");a.set(f.extend({},h.user,{channel:h.channel.id,state:h.channel.state}));c.show("\u5df2\u52a0\u5165\u623f\u95f4\uff08"+a.channel+"\uff09\u3002");a.role<a.state&&c.show("\u60a8\u6240\u5728\u7684\u7528\u6237\u7ec4\u4e0d\u80fd\u53d1\u8a00\uff01");a.punishment.code&t.MUTED&&(d=new Date,d.setTime(a.punishment.time),
c.show("\u60a8\u5df2\u88ab\u7981\u8a00\u81f3\uff08"+f.formatTime(d)+"\uff09\uff01"));p.dispatchEvent(g.CHATEASE_INDENT,h);break;case k.TEXT:try{A||(A=new f.filter(b.keywords)),h.data=A.replace(h.data)}catch(E){f.log("Failed to execute filter.")}c.show(h.data,h.user,h.type);p.dispatchEvent(g.CHATEASE_MESSAGE,h);break;case k.JOIN:a=q(h.user.role);c.show((a?a+" ":"")+h.user.name+" \u8fdb\u5165\u623f\u95f4\u3002");p.dispatchEvent(g.CHATEASE_JOIN,h);break;case k.LEFT:a=q(h.user.role);c.show((a?a+" ":"")+
h.user.name+" \u5df2\u79bb\u5f00\u3002");p.dispatchEvent(g.CHATEASE_LEFT,h);break;case k.USERS:p.dispatchEvent(g.CHATEASE_USERS,h);break;case k.ERROR:m(h.error.code,h);break;default:f.log("Unknown data type: "+h.raw+", ignored.")}};p.onError=function(c){b.setState(a.ERROR)};p.onClose=function(c){b.setState(a.CLOSED)};p.close=function(){r&&r.close()};z={};D=0;b.addEventListener(g.CHATEASE_STATE,function(d){switch(d.state){case a.CONNECTED:c.show("\u804a\u5929\u5ba4\u5df2\u8fde\u63a5\u2026");C=0;p.dispatchEvent(g.CHATEASE_CONNECT);
break;case a.CLOSED:c.show("\u804a\u5929\u5ba4\u8fde\u63a5\u5df2\u65ad\u5f00\uff01");p.dispatchEvent(g.CHATEASE_CLOSE,{channel:{id:b.channel}});if(0>b.config.maxretries||C<b.config.maxretries)d=Math.ceil(b.config.retrydelay+5E3*Math.random()),c.show("\u6b63\u5728\u51c6\u5907\u91cd\u8fde\uff0c"+d/1E3+"\u79d2..."),C++,F(d);break;case a.ERROR:c.show("\u804a\u5929\u5ba4\u5f02\u5e38\uff01");p.dispatchEvent(g.ERROR,{message:"Chat room error!",channel:{id:b.channel}});break;default:p.dispatchEvent(g.ERROR,
{message:"Unknown model state!",state:d.state})}});b.addEventListener(g.CHATEASE_PROPERTY,function(a){u(a)});c.addEventListener(g.CHATEASE_READY,function(a){B||(f.log("Chat ready!"),B=!0,u(a),n(),window.onbeforeunload=function(a){r&&b.getState()})});c.addEventListener(g.CHATEASE_SETUP_ERROR,function(c){b.setState(a.ERROR);u(c)});c.addEventListener(g.CHATEASE_VIEW_SEND,function(a){var e=a.data.data;if(e){0<=b.config.maxlength&&(e=e.substr(0,b.config.maxlength));var e=f.trim(e),g=b.getProperty("userinfo");
p.send({cmd:d.TEXT,data:e,type:a.data.type,channel:{id:g.channel}})}else c.show("\u8bf7\u8f93\u5165\u5185\u5bb9\uff01")});c.addEventListener(g.CHATEASE_VIEW_PROPERTY,function(a){b.setProperty(a.key,a.value)});c.addEventListener(g.CHATEASE_VIEW_CLEARSCREEN,function(a){c.render.clearScreen();u(a)});c.addEventListener(g.CHATEASE_VIEW_NICKCLICK,function(a){var c=b.getProperty("userinfo");a.channel={id:c.channel,state:c.state};u(a)});c.addEventListener(g.CHATEASE_RENDER_ERROR,function(c){b.setState(a.ERROR);
u(c)})}})(chatease);
(function(c){var f=c.utils,e=c.events,g=c.embed=function(a){function b(a){switch(a.type){case e.ERROR:case e.CHATEASE_SETUP_ERROR:case e.CHATEASE_RENDER_ERROR:d.errorScreen(a.message);d.dispatchEvent(e.ERROR,a);break;default:d.dispatchEvent(a.type,a)}}var d=f.extend(this,new e.eventdispatcher("embed")),k={},l=null,t=!1;d.embed=function(){try{k=new g.config(a.config),l=new g.embedder(a,k)}catch(h){f.log("Failed to init embedder!");d.dispatchEvent(e.CHATEASE_SETUP_ERROR,{message:"Failed to init embedder!",render:k.render.name});
return}l.addGlobalListener(b);l.embed()};d.errorScreen=function(a){t||(t=!0,c.api.displayError(a,k))};(function(){f.foreach(a.config.events,function(b,c){b=a[b];"function"===f.typeOf(b)&&b.call(a,c)})})()}})(chatease);
(function(c){var f=c.utils,e=c.embed,g=c.core.renders.modes,a=c.core.skins.modes;e.config=function(b){return f.extend({},{url:"ws://"+window.location.host+"/ch1?token=123456",width:640,height:400,keywords:"",maxlength:30,maxrecords:50,maxretries:-1,retrydelay:3E3,render:{name:g.DEFAULT,swf:"swf/chatease.swf"},skin:{name:a.DEFAULT}},b)};e.config.addConfig=function(a,c){return f.extend(a,c)}})(chatease);
(function(c){var f=c.utils,e=c.events,g=c.core;c.embed.embedder=function(a,b){function c(a){k.dispatchEvent(a.type,a)}var k=f.extend(this,new e.eventdispatcher("embed.embedder"));k.embed=function(){var d=new g.entity(b);d.addGlobalListener(c);d.setup();a.setEntity(d,b.render.name)}}})(chatease);